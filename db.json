{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/3-hexo/source/css/gitalk.css","path":"css/gitalk.css","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/mobile.styl","path":"css/mobile.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/avatar.jpg","path":"img/avatar.jpg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/brown-papersq.png","path":"img/brown-papersq.png","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/weixin.jpg","path":"img/weixin.jpg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/school-book.png","path":"img/school-book.png","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/iconfont.js","path":"js/iconfont.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/jquery.autocomplete.min.js","path":"js/jquery.autocomplete.min.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/jquery.pjax.js","path":"js/jquery.pjax.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/script.js","path":"js/script.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/search.js","path":"js/search.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.eot","path":"css/fonts/icomoon.eot","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.svg","path":"css/fonts/icomoon.svg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.ttf","path":"css/fonts/icomoon.ttf","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/icomoon.woff","path":"css/fonts/icomoon.woff","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.eot","path":"css/fonts/iconfont.eot","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.svg","path":"css/fonts/iconfont.svg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.ttf","path":"css/fonts/iconfont.ttf","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/iconfont.woff","path":"css/fonts/iconfont.woff","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/fonts/selection.json","path":"css/fonts/selection.json","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/atom-dark.styl","path":"css/hl_theme/atom-dark.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/atom-light.styl","path":"css/hl_theme/atom-light.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/brown-paper.styl","path":"css/hl_theme/brown-paper.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/darcula.styl","path":"css/hl_theme/darcula.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/github-gist.styl","path":"css/hl_theme/github-gist.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/github.styl","path":"css/hl_theme/github.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-dark.styl","path":"css/hl_theme/gruvbox-dark.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-light.styl","path":"css/hl_theme/gruvbox-light.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-dark.styl","path":"css/hl_theme/kimbie-dark.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-light.styl","path":"css/hl_theme/kimbie-light.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/railscasts.styl","path":"css/hl_theme/railscasts.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/rainbow.styl","path":"css/hl_theme/rainbow.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/school-book.styl","path":"css/hl_theme/school-book.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/sublime.styl","path":"css/hl_theme/sublime.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/sunburst.styl","path":"css/hl_theme/sunburst.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/css/hl_theme/zenbum.styl","path":"css/hl_theme/zenbum.styl","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/article/dead_lock01.png","path":"img/article/dead_lock01.png","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/article/helloworld_sp2.png","path":"img/article/helloworld_sp2.png","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/article/helloworld_sp2_gatew.png","path":"img/article/helloworld_sp2_gatew.png","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/article/springcloudhelloworld01.png","path":"img/article/springcloudhelloworld01.png","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/article/springcloudeureka01.png","path":"img/article/springcloudeureka01.png","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/article/springcloudhelloworld02.png","path":"img/article/springcloudhelloworld02.png","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/article/springcloudzuul01.png","path":"img/article/springcloudzuul01.png","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/gitment.js","path":"js/gitment.js","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/img/article-list-background.jpeg","path":"img/article-list-background.jpeg","modified":0,"renderable":1},{"_id":"themes/3-hexo/source/js/gitalk.js","path":"js/gitalk.js","modified":0,"renderable":1}],"Cache":[{"_id":"themes/3-hexo/.DS_Store","hash":"0770f9d42bfdd8d420de48fed463015e001cf579","modified":1581519578522},{"_id":"themes/3-hexo/README.md","hash":"08c51fcae61d2e7e2af089712ce147324e4b6873","modified":1581519578522},{"_id":"themes/3-hexo/.gitignore","hash":"560a43fddfe4559ed1a17e7362874454519f189b","modified":1581519578522},{"_id":"themes/3-hexo/_config.yml","hash":"f75137109ee422e153bb6c9e09d06c1bc00197d3","modified":1581519578522},{"_id":"source/_posts/JSP转HTML中EL表达式替换方式.md","hash":"301d5927c6e58abac4f12d49f9028112829becbd","modified":1581320140255},{"_id":"source/_posts/Java学习-内存区域.md","hash":"7d7111d1939e7e06253df4c9e943e3f98c9c4c1c","modified":1581320140255},{"_id":"source/_posts/Mysql常用配置.md","hash":"497646d04fd958ea77b5788ec8c673b049f8fdd1","modified":1581320140255},{"_id":"source/_posts/Java学习-内存模型.md","hash":"0cfa5001b4e81cfa2fce2aa91486b494c59b5db6","modified":1581320140255},{"_id":"source/_posts/Shell脚本编写常用语法及注意点.md","hash":"c8d1048b2b0f5f918abb610dd8b0afc1ad73936e","modified":1581320140256},{"_id":"source/_posts/Spring-Cloud基础微服务搭建-springboot2.md","hash":"557ec015fa98638ad45c709514452e4def8514ac","modified":1581320140256},{"_id":"source/_posts/Spring-Cloud基础微服务搭建.md","hash":"ecb99bc4aca1b95ffdead62f5eeb130a0f6c2fe2","modified":1581320140256},{"_id":"source/_posts/jdk8并发编程神器CompletableFuture初探.md","hash":"fdb8e11e0f7d38b4957287125cc042a7f7f6ae57","modified":1581320140256},{"_id":"source/_posts/一次mysql死锁记录.md","hash":"8d82f47e8c34429e25bf38b8758c183835661d41","modified":1581320140256},{"_id":"source/_posts/临时学习记录.md","hash":"bf70a92787c6663fcfa1e5ce81fc6dcd0c99c337","modified":1581518823918},{"_id":"source/_posts/回蓉番茄钟记录.md","hash":"3e11e9115a59f9880df2bd4bda4fecc841217e16","modified":1581517827212},{"_id":"source/_posts/大文本文件处理-Tar命令压缩-解压缩.md","hash":"5fcb149330c813e0f53bf15aeec1ae5f07bc59bb","modified":1581320140269},{"_id":"source/_posts/小组分享记录.md","hash":"ba2ef0aed3bd7f0d4ffe387ea06a6416d8480f52","modified":1581320140269},{"_id":"source/_posts/搭建自己的linux工作环境.md","hash":"b675a0b585569a0552211f45b1a49246f9ebf72c","modified":1581320140270},{"_id":"source/_posts/面试记录.md","hash":"b6a18d2f779a005c5602d67cd2adbbd9ff8f3e26","modified":1581324145649},{"_id":"source/about/index.md","hash":"d4f07f7b2a462d44a006ebc64e14f2e260f9ddaa","modified":1581320140270},{"_id":"themes/3-hexo/.git/FETCH_HEAD","hash":"d12787ab27eb79f933de8afefa5e20c404b0afa2","modified":1581519601000},{"_id":"themes/3-hexo/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1581519578512},{"_id":"themes/3-hexo/.git/ORIG_HEAD","hash":"bff5711ff5f7757626a7b889c628c5a09563a678","modified":1581519601020},{"_id":"themes/3-hexo/.git/config","hash":"2b1c1b0533b7602145a20706284996f4c9598006","modified":1581519578512},{"_id":"themes/3-hexo/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1581519526040},{"_id":"themes/3-hexo/.git/index","hash":"1d89e37f4380d7282583c059fc46395a334129c1","modified":1581519594721},{"_id":"themes/3-hexo/.git/packed-refs","hash":"5573334d542f799014476cc1b96873f50a7206c6","modified":1581519578512},{"_id":"themes/3-hexo/layout/index.ejs","hash":"a5c464897e7dc9d45d03d8b61e742b1ac4173a95","modified":1581519578522},{"_id":"themes/3-hexo/layout/post.ejs","hash":"aeda285031ba8d4e94225e82b364bcf5f79fce1d","modified":1581519578522},{"_id":"themes/3-hexo/source/.DS_Store","hash":"fdcc907c46e093a14b153c5dc8c038461997ed3c","modified":1581519578522},{"_id":"themes/3-hexo/layout/indexs.md","hash":"3c22bf350f41c46e86c206d488b5643e3aef52c3","modified":1581519578522},{"_id":"themes/3-hexo/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1581519526040},{"_id":"themes/3-hexo/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1581519526040},{"_id":"themes/3-hexo/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1581519526040},{"_id":"themes/3-hexo/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1581519526040},{"_id":"themes/3-hexo/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1581519526040},{"_id":"themes/3-hexo/.git/hooks/pre-commit.sample","hash":"33729ad4ce51acda35094e581e4088f3167a0af8","modified":1581519526040},{"_id":"themes/3-hexo/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1581519526040},{"_id":"themes/3-hexo/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1581519526040},{"_id":"themes/3-hexo/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1581519526040},{"_id":"themes/3-hexo/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1581519526040},{"_id":"themes/3-hexo/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1581519526040},{"_id":"themes/3-hexo/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1581519526040},{"_id":"themes/3-hexo/.git/logs/HEAD","hash":"aaaff8be039f581d47d498fe667b920727d17d69","modified":1581519578512},{"_id":"themes/3-hexo/layout/_partial/article.ejs","hash":"d3c928954057bcebdf3fc294b2123885b08396d3","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/article_copyright.ejs","hash":"05d3cddf5f3a53577452db4efa811bd361f7c0c4","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/comment.ejs","hash":"d18f94e04ef0cf7abb432a8e707ccb3abc7fe435","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/copyright.ejs","hash":"faffe25aec33936fa2ec9d8f0e34e16ef3d90c25","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/dashang.ejs","hash":"6eab1e5fae6bd60928325d026a1bed61c43d11a9","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/footer.ejs","hash":"311489fe2050ada8a0eaad3d0c57e5d5012f470e","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/friends.ejs","hash":"558a3d4bad578819fb07729fe1b50d9b81da8b93","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/full-toc.ejs","hash":"0e976208d79b0396eb51ca1af5016c963c6e4618","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/header.ejs","hash":"915d5f10dd8f3dcd19cb75010e23689e8f385caf","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/mathjax.ejs","hash":"e2be0e37f3d48e63e65a47d819bfb800b9aa3784","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/meta.ejs","hash":"ef387e80043b62e1925a068267f2377cac64adc7","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/nav-left.ejs","hash":"c14bc1393f779dff7854089621804dceea236d82","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/nav-right.ejs","hash":"98326675546fc6828a45e8b95250899b4ee2d821","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/tag.ejs","hash":"87e932476754f27424f9ec397ed66a4ab8a59ad8","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/toc-ref.ejs","hash":"33f7a4bfca1bb9835ec8f0d1e73188d1f56cc8b9","modified":1581519578522},{"_id":"themes/3-hexo/source/css/gitalk.css","hash":"3dc58e9a3fd63a3144d5fe850eb55e3dc885c9fb","modified":1581519578532},{"_id":"themes/3-hexo/source/css/mobile.styl","hash":"d10bdd736aa343f38fe15cba4c81d45d3d259de4","modified":1581519578532},{"_id":"themes/3-hexo/source/css/style.styl","hash":"322abe325d5fe9ff37347bdd19e772315a8ebfed","modified":1581519578532},{"_id":"themes/3-hexo/source/img/avatar.jpg","hash":"ef7834e511b15ea7c0523adaa961ae23a1e111ef","modified":1581519578532},{"_id":"themes/3-hexo/source/img/brown-papersq.png","hash":"3a1332ede3a75a3d24f60b6ed69035b72da5e182","modified":1581519578532},{"_id":"themes/3-hexo/source/img/weixin.jpg","hash":"8b4cb3d610db96246f5021d383cb9bb5c65e640e","modified":1581519578532},{"_id":"themes/3-hexo/source/img/school-book.png","hash":"711ec983c874e093bb89eb77afcbdf6741fa61ee","modified":1581519578532},{"_id":"themes/3-hexo/source/js/iconfont.js","hash":"3a0869ca1b09af07d82987e343a3bc4cb9558ecb","modified":1581519578532},{"_id":"themes/3-hexo/source/js/jquery.autocomplete.min.js","hash":"2462169ad7f4a8ae9f9f4063995cbe7fed45cd77","modified":1581519578532},{"_id":"themes/3-hexo/source/js/jquery.pjax.js","hash":"8c2a4f10a4da3d9615a3a81542494c6d21479b3d","modified":1581519578542},{"_id":"themes/3-hexo/source/js/script.js","hash":"14772b08b9c3d5c99a4b54748be9666deaae2778","modified":1581519578542},{"_id":"themes/3-hexo/source/js/search.js","hash":"788c610149a5f9361295f9f0207c8523f37ddb8b","modified":1581519578542},{"_id":"themes/3-hexo/.git/objects/pack/pack-e7864a71a376e5a87501fb45a0174947db9b153c.idx","hash":"a81e70b641d99cea10287b44bde340edd4ec9bbb","modified":1581519578492},{"_id":"themes/3-hexo/.git/refs/heads/master","hash":"bff5711ff5f7757626a7b889c628c5a09563a678","modified":1581519578512},{"_id":"themes/3-hexo/layout/_partial/comments/click2show.ejs","hash":"8a3a175c2da956366ce91bfc4f4012a487f4bdfc","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/comments/disqus.ejs","hash":"32ce7b48d366b9c888ff2ceb911a3cd82f864537","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/comments/gentie.ejs","hash":"908d9046502612d24780ca354bd9392a009b4d7b","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/comments/gitalk.ejs","hash":"01567e010cf4f2dd141fe2019490d3f0d5aa2529","modified":1581519578522},{"_id":"themes/3-hexo/layout/_partial/comments/gitment.ejs","hash":"eaf2b6f297282606b630ad55fb9e38af7e2829dc","modified":1581519578522},{"_id":"themes/3-hexo/source/css/_partial/autocomplete.styl","hash":"1ffe51e3b77afefcd94d386a718506d5b055ad94","modified":1581519578522},{"_id":"themes/3-hexo/source/css/_partial/comment.styl","hash":"fe00fb1269b4fe1f3d5ab917891926222ce47275","modified":1581519578522},{"_id":"themes/3-hexo/source/css/_partial/dashang.styl","hash":"f0eac1dc1f5dbed1769d032bb5fd5f002faaee26","modified":1581519578522},{"_id":"themes/3-hexo/source/css/_partial/fade.styl","hash":"02c7510a26f306e240f23ddbf772a69be2c890dd","modified":1581519578522},{"_id":"themes/3-hexo/source/css/_partial/font.styl","hash":"c200f3fabcfe83f3e45746e186b4bb111e73ad47","modified":1581519578522},{"_id":"themes/3-hexo/source/css/_partial/full-toc.styl","hash":"4102753dad0cc1ee9ed673f7253ba097a960c3b7","modified":1581519578522},{"_id":"themes/3-hexo/source/css/_partial/nav-left.styl","hash":"bf29eab9ea75fa191d678b6eefec440505ddf6e3","modified":1581519578522},{"_id":"themes/3-hexo/source/css/_partial/nav-right.styl","hash":"1d01247f974b059d9ef6a2178a724b4f72acd659","modified":1581519578522},{"_id":"themes/3-hexo/source/css/_partial/nprogress.styl","hash":"2620a02169a6aeb75137fd368eac2c36423d8498","modified":1581519578522},{"_id":"themes/3-hexo/source/css/_partial/num-load.styl","hash":"f7ef35459ece22e1da950b86126be1c2bfe97fcf","modified":1581519578522},{"_id":"themes/3-hexo/source/css/_partial/post.styl","hash":"8a462cf9b0b026e71eda9e704c0fbb952b4615c5","modified":1581519578522},{"_id":"themes/3-hexo/source/css/fonts/icomoon.eot","hash":"b6195bedc1cb2f9cfcb26cc27021f2e94be2ab0a","modified":1581519578522},{"_id":"themes/3-hexo/source/css/fonts/icomoon.svg","hash":"b5e7562c8494b0ddb3a70ecc5545ef7340d8e971","modified":1581519578522},{"_id":"themes/3-hexo/source/css/fonts/icomoon.ttf","hash":"eb976d8b8559fcddfc2658a03a4350cb566fc06b","modified":1581519578522},{"_id":"themes/3-hexo/source/css/fonts/icomoon.woff","hash":"3985d29416bb9b19f50a2f20f2bbbce47f10af8d","modified":1581519578522},{"_id":"themes/3-hexo/source/css/fonts/iconfont.eot","hash":"3dfe8e557d9dfaf39bca088a02b76deb82dbaa3d","modified":1581519578522},{"_id":"themes/3-hexo/source/css/fonts/iconfont.svg","hash":"7e54ae44c02faa319c4fe128e1e6bda38eae5c9d","modified":1581519578522},{"_id":"themes/3-hexo/source/css/fonts/iconfont.ttf","hash":"aa087561480fb9c2cfd541e33d1e99d5ac1a56bb","modified":1581519578522},{"_id":"themes/3-hexo/source/css/fonts/iconfont.woff","hash":"f8ed131ccf13f4bdd3ec11fc3e997339dd7b66ba","modified":1581519578532},{"_id":"themes/3-hexo/source/css/fonts/selection.json","hash":"b6456a4eabcffd95e822d1d7adce96da524d481a","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/atom-dark.styl","hash":"f3eb4e5feda9cbd6242ccf44ca064e2979b5d719","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/atom-light.styl","hash":"69d184a682bcaeba2b180b437dc4431bc3be38aa","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/brown-paper.styl","hash":"03af387edcc1cf8c18d12e9c440fd51b6cf425b6","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/darcula.styl","hash":"2bfc14f27ccca108b4b3755782de8366e8bd001e","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/github-gist.styl","hash":"5e05b19832c1099bd9d284bc3ed00dc8a3d7ee23","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/github.styl","hash":"53276ff1f224f691dfe811e82c0af7f4476abf5d","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-dark.styl","hash":"315ad610d303caba9eac80a7d51002193a15478a","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/gruvbox-light.styl","hash":"1bece084b1dbbbd4af064f05feffd8c332b96a48","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-dark.styl","hash":"e9c190f9ffc37a13cac430512e4e0c760205be4a","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/kimbie-light.styl","hash":"0c3ccd0d64e7504c7061d246dc32737f502f64e4","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/railscasts.styl","hash":"a6e8cfd2202afd7893f5268f3437421e35066e7b","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/rainbow.styl","hash":"e5c37646a9d9c1094f9aab7a7c65a4b242e8db00","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/school-book.styl","hash":"51659351b391a2be5c68728bb51b7ad467c5e0db","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/sublime.styl","hash":"501d75ef0f4385bea24d9b9b4cc434ba68d4be27","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/sunburst.styl","hash":"2aa9817e68fb2ed216781ea04b733039ebe18214","modified":1581519578532},{"_id":"themes/3-hexo/source/css/hl_theme/zenbum.styl","hash":"92941a6ae73b74f44ad7c559c5548c44073c644a","modified":1581519578532},{"_id":"themes/3-hexo/source/img/article/dead_lock01.png","hash":"4dce744d58824eb4966f5dd7ec8cdc0dec04595a","modified":1581519578532},{"_id":"themes/3-hexo/source/img/article/helloworld_sp2.png","hash":"7bf8201523bf4d8824c44e6635a79959c716f318","modified":1581519578532},{"_id":"themes/3-hexo/source/img/article/helloworld_sp2_gatew.png","hash":"8ee24f4dd1f362f82ca660c6ae951eaf883a8b8b","modified":1581519578532},{"_id":"themes/3-hexo/source/img/article/springcloudhelloworld01.png","hash":"3fea926aa65a6b2e8d8e8a3772127498cd124b03","modified":1581519578532},{"_id":"themes/3-hexo/source/img/article/springcloudeureka01.png","hash":"3efbc5b63e3c87d32617b62e97dbae0e9d6924ff","modified":1581519578532},{"_id":"themes/3-hexo/source/img/article/springcloudhelloworld02.png","hash":"bec4f775d5f34ee971d8f02ab6832b642cf3dac9","modified":1581519578532},{"_id":"themes/3-hexo/source/img/article/springcloudzuul01.png","hash":"cfba95e584b20609818458aba733ceab94ecb4c6","modified":1581519578532},{"_id":"themes/3-hexo/.git/logs/refs/heads/master","hash":"aaaff8be039f581d47d498fe667b920727d17d69","modified":1581519578512},{"_id":"themes/3-hexo/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1581519578512},{"_id":"themes/3-hexo/source/js/gitment.js","hash":"67984b83cd46ff4300d4fd959bf6c17dd66b4136","modified":1581519578532},{"_id":"themes/3-hexo/source/img/article-list-background.jpeg","hash":"fbe2b3789d63c51ee204ea8c77c518b5d29db6a0","modified":1581519578532},{"_id":"themes/3-hexo/source/js/gitalk.js","hash":"536f28c4354a13582af826d9d9b2cb27cec07dc6","modified":1581519578532},{"_id":"themes/3-hexo/.git/logs/refs/remotes/origin/HEAD","hash":"aaaff8be039f581d47d498fe667b920727d17d69","modified":1581519578512},{"_id":"themes/3-hexo/.git/objects/pack/pack-e7864a71a376e5a87501fb45a0174947db9b153c.pack","hash":"d675be2db0acbf5b593afdf373527790a075285d","modified":1581519578492},{"_id":"public/about/index.html","hash":"b6d7893b5c71a6db22d91c661188240cb6379c3e","modified":1581521627804},{"_id":"public/2020/02/12/临时学习记录/index.html","hash":"51852144897d6c4a13ba046505fdf8e73c39d9f3","modified":1581521859381},{"_id":"public/2020/02/11/回蓉番茄钟记录/index.html","hash":"7a39fc2d0973c9dcbd0affeab1e3057f909e6741","modified":1581521859381},{"_id":"public/2020/02/10/面试记录/index.html","hash":"eaf896cfc563eb72aaa933bc54901a118f0fb166","modified":1581521859382},{"_id":"public/2020/02/03/Java学习-内存模型/index.html","hash":"301e29a0e76dc70d783bea818d306a9dfcaff1d9","modified":1581521859382},{"_id":"public/2020/02/03/Java学习-内存区域/index.html","hash":"d529cddac84a9e8586f344d3dde47a0ffaffa4c9","modified":1581521859382},{"_id":"public/2019/12/13/Shell脚本编写常用语法及注意点/index.html","hash":"55648b6ae08990e1674378133ba53c5bfbd7092e","modified":1581521627806},{"_id":"public/2019/11/24/一次mysql死锁记录/index.html","hash":"cbc386e27767bdbd6d965210687ba3593cdb46c0","modified":1581521627806},{"_id":"public/2019/11/18/Mysql常用配置/index.html","hash":"ae1b9ece40f04b78c00c2b22e6e6cab63d0eac04","modified":1581521627806},{"_id":"public/2019/10/26/jdk8并发编程神器CompletableFuture初探/index.html","hash":"29c3c8e3340d4b5a797992e36681bb5429fe4e5c","modified":1581521627806},{"_id":"public/2019/11/06/JSP转HTML中EL表达式替换方式/index.html","hash":"844ca9cf0cd5c6f792822ed3cd18a0afe211c734","modified":1581521627806},{"_id":"public/2019/10/20/Spring-Cloud基础微服务搭建-springboot2/index.html","hash":"45483238d6bf4a50f23c83460e0043483aab1233","modified":1581521627806},{"_id":"public/2019/10/16/小组分享记录/index.html","hash":"a8bc47382c07ac172b1f283bff21ec4341808db4","modified":1581521627806},{"_id":"public/2019/10/16/Spring-Cloud基础微服务搭建/index.html","hash":"6e2b0b9cfd694b59997897264188f38cbdc9ac8b","modified":1581521627807},{"_id":"public/2019/10/13/大文本文件处理-Tar命令压缩-解压缩/index.html","hash":"f599d4cb2a353f7ebf7874dc159f81521c41c723","modified":1581521627807},{"_id":"public/2019/09/30/搭建自己的linux工作环境/index.html","hash":"f85fd8781886081512a7e4ff1744d74d5cfeed66","modified":1581521627807},{"_id":"public/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627807},{"_id":"public/page/2/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627807},{"_id":"public/archives/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627807},{"_id":"public/archives/page/2/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627807},{"_id":"public/archives/2019/09/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627807},{"_id":"public/archives/2019/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627807},{"_id":"public/archives/2019/10/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627807},{"_id":"public/archives/2019/11/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627807},{"_id":"public/archives/2019/12/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627807},{"_id":"public/archives/2020/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627807},{"_id":"public/archives/2020/02/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521859382},{"_id":"public/tags/JSP/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627807},{"_id":"public/tags/EL表达式/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627807},{"_id":"public/tags/配置/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627807},{"_id":"public/tags/内存区域/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521859382},{"_id":"public/tags/Shell/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627807},{"_id":"public/tags/内存模型/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521859382},{"_id":"public/tags/spring-cloud/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627808},{"_id":"public/tags/微服务/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627808},{"_id":"public/tags/框架搭建/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627808},{"_id":"public/tags/CompletableFuture/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627808},{"_id":"public/tags/jdk8/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627808},{"_id":"public/tags/并发编程/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627808},{"_id":"public/tags/Mysql/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627808},{"_id":"public/tags/死锁/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627808},{"_id":"public/tags/学习记录/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521859382},{"_id":"public/tags/番茄钟/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521859382},{"_id":"public/tags/Linux/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627808},{"_id":"public/tags/Tar/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627816},{"_id":"public/tags/压缩解压缩/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627816},{"_id":"public/tags/加密解密/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627816},{"_id":"public/tags/大文本/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627816},{"_id":"public/tags/linux/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627816},{"_id":"public/tags/sendi/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627816},{"_id":"public/tags/工作环境/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627816},{"_id":"public/tags/面试/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521859382},{"_id":"public/categories/前端/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627816},{"_id":"public/categories/Java/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627816},{"_id":"public/categories/Mysql/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627817},{"_id":"public/categories/Linux/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627817},{"_id":"public/categories/待整理/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521859382},{"_id":"public/categories/2020回蓉番茄钟执行记录/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521859382},{"_id":"public/categories/sendi趣味/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627817},{"_id":"public/categories/工具/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521627817},{"_id":"public/categories/面试/index.html","hash":"0fd47fa97ad4f967c91c18d3fe34f74c4591b62a","modified":1581521859382},{"_id":"public/img/avatar.jpg","hash":"ef7834e511b15ea7c0523adaa961ae23a1e111ef","modified":1581521627817},{"_id":"public/img/weixin.jpg","hash":"8b4cb3d610db96246f5021d383cb9bb5c65e640e","modified":1581521627817},{"_id":"public/img/brown-papersq.png","hash":"3a1332ede3a75a3d24f60b6ed69035b72da5e182","modified":1581521627817},{"_id":"public/img/school-book.png","hash":"711ec983c874e093bb89eb77afcbdf6741fa61ee","modified":1581521627817},{"_id":"public/css/fonts/icomoon.svg","hash":"b5e7562c8494b0ddb3a70ecc5545ef7340d8e971","modified":1581521627817},{"_id":"public/css/fonts/icomoon.eot","hash":"b6195bedc1cb2f9cfcb26cc27021f2e94be2ab0a","modified":1581521627817},{"_id":"public/css/fonts/icomoon.woff","hash":"3985d29416bb9b19f50a2f20f2bbbce47f10af8d","modified":1581521627817},{"_id":"public/css/fonts/icomoon.ttf","hash":"eb976d8b8559fcddfc2658a03a4350cb566fc06b","modified":1581521627817},{"_id":"public/css/fonts/iconfont.eot","hash":"3dfe8e557d9dfaf39bca088a02b76deb82dbaa3d","modified":1581521627817},{"_id":"public/css/fonts/iconfont.svg","hash":"7e54ae44c02faa319c4fe128e1e6bda38eae5c9d","modified":1581521627817},{"_id":"public/css/fonts/iconfont.ttf","hash":"aa087561480fb9c2cfd541e33d1e99d5ac1a56bb","modified":1581521627817},{"_id":"public/css/fonts/iconfont.woff","hash":"f8ed131ccf13f4bdd3ec11fc3e997339dd7b66ba","modified":1581521627817},{"_id":"public/img/article/dead_lock01.png","hash":"4dce744d58824eb4966f5dd7ec8cdc0dec04595a","modified":1581521627817},{"_id":"public/img/article/helloworld_sp2.png","hash":"7bf8201523bf4d8824c44e6635a79959c716f318","modified":1581521627817},{"_id":"public/img/article/helloworld_sp2_gatew.png","hash":"8ee24f4dd1f362f82ca660c6ae951eaf883a8b8b","modified":1581521627818},{"_id":"public/img/article/springcloudeureka01.png","hash":"3efbc5b63e3c87d32617b62e97dbae0e9d6924ff","modified":1581521627818},{"_id":"public/img/article/springcloudhelloworld02.png","hash":"bec4f775d5f34ee971d8f02ab6832b642cf3dac9","modified":1581521627818},{"_id":"public/img/article/springcloudzuul01.png","hash":"cfba95e584b20609818458aba733ceab94ecb4c6","modified":1581521627818},{"_id":"public/img/article/springcloudhelloworld01.png","hash":"3fea926aa65a6b2e8d8e8a3772127498cd124b03","modified":1581521628209},{"_id":"public/js/jquery.autocomplete.min.js","hash":"7b8ac4d06c9e763963832529f44a56ad42a81e5f","modified":1581521628215},{"_id":"public/js/search.js","hash":"c80c9a231ee040c7adc07a477793873fb85ce8bc","modified":1581521628215},{"_id":"public/css/hl_theme/atom-dark.css","hash":"88d11052a24e8100af6248eb4dbe1ce7b0e96408","modified":1581521628215},{"_id":"public/css/mobile.css","hash":"79ab291be160e0ca753512a96c5198f7477f13be","modified":1581521628215},{"_id":"public/css/hl_theme/brown-paper.css","hash":"500c8e750373f6656ff49a7857c871ceedcf8777","modified":1581521628215},{"_id":"public/css/hl_theme/darcula.css","hash":"4341074bae4bc9f0b86e32b623e27babc0159b6e","modified":1581521628215},{"_id":"public/css/hl_theme/github-gist.css","hash":"7a41c1c479d09df875f99f1f6d94aac42e9e2ad0","modified":1581521628215},{"_id":"public/css/hl_theme/atom-light.css","hash":"a3c8f3ee9a655594eff7ac545cb2e6914c1abcc2","modified":1581521628215},{"_id":"public/css/hl_theme/gruvbox-dark.css","hash":"8c440d9b4ee19ac03eaee3c6af78ba52e5ba5535","modified":1581521628215},{"_id":"public/css/hl_theme/github.css","hash":"e05a0806a508a26b9f3f3794b6b588ec6504ad3f","modified":1581521628215},{"_id":"public/css/hl_theme/gruvbox-light.css","hash":"30514aaa242a34647aa666cfca4fc74c595ea8f2","modified":1581521628216},{"_id":"public/css/hl_theme/kimbie-dark.css","hash":"728527fcc308da454722c119b89e6da3025bd1e3","modified":1581521628216},{"_id":"public/css/hl_theme/railscasts.css","hash":"511f2fd2a84d426e5da5cb17880cc08f73beb002","modified":1581521628216},{"_id":"public/css/hl_theme/rainbow.css","hash":"7ff4251938076ddb7e4e49413db82653e5b61321","modified":1581521628216},{"_id":"public/css/hl_theme/school-book.css","hash":"ffbbcd13a74ac2404262c50b7a43053dfd0096ff","modified":1581521628216},{"_id":"public/css/hl_theme/sublime.css","hash":"f65c5b116d9213afb9c324384a2f3bc86cb71121","modified":1581521628216},{"_id":"public/css/hl_theme/kimbie-light.css","hash":"0c61926c989163faefb031d27bce3e287d6e10f2","modified":1581521628216},{"_id":"public/css/hl_theme/sunburst.css","hash":"8a135abac1512cf430d1d1ad2304b79afa1a4d6e","modified":1581521628216},{"_id":"public/css/hl_theme/zenbum.css","hash":"0a78f74a93568e20b32ca7427c719e9bae9a0b55","modified":1581521628216},{"_id":"public/css/gitalk.css","hash":"58177ce227c50ee359fbf99a4fdd26058887afc5","modified":1581521628216},{"_id":"public/js/iconfont.js","hash":"3a0869ca1b09af07d82987e343a3bc4cb9558ecb","modified":1581521628216},{"_id":"public/js/script.js","hash":"7502191e29366a11323dc72ae365b1aed254e6f2","modified":1581521628216},{"_id":"public/js/jquery.pjax.js","hash":"191c49fdb40dff115a49cfd2b30dffb888d86550","modified":1581521628216},{"_id":"public/css/fonts/selection.json","hash":"047b615ea32dc48dae5b964061427d41feaaafdf","modified":1581521628216},{"_id":"public/css/style.css","hash":"07df7b0c130e9965b1ff10e98351e923178883d4","modified":1581521628216},{"_id":"public/js/gitment.js","hash":"59a1e03f2b0ce61dd9bd405d3c52d3e07cc10dec","modified":1581521628216},{"_id":"public/js/gitalk.js","hash":"d1eb82a3280981bd652d9a8e323060e4311c547b","modified":1581521628216},{"_id":"public/img/article-list-background.jpeg","hash":"fbe2b3789d63c51ee204ea8c77c518b5d29db6a0","modified":1581521628242}],"Category":[{"name":"前端","_id":"ck6jh55g00003ogvklnzvk2kx"},{"name":"Mysql","_id":"ck6jh55g50008ogvkhj4ne7t9"},{"name":"Java","_id":"ck6jh55g8000dogvkg0s7q1xn"},{"name":"Linux","_id":"ck6jh55gh000qogvkcw09697g"},{"name":"待整理","_id":"ck6jh55gn0017ogvkatcmnrbv"},{"name":"2020回蓉番茄钟执行记录","_id":"ck6jh55go001bogvkz69dpujy"},{"name":"工具","_id":"ck6jh55gp001eogvkixl4ghhq"},{"name":"sendi趣味","_id":"ck6jh55gq001iogvkxy17k2x1"},{"name":"面试","_id":"ck6jh55gs001pogvkm3e6cxsd"}],"Data":[],"Page":[{"title":"about","date":"2019-09-30T08:29:29.000Z","_content":"","source":"about/index.md","raw":"---\ntitle: about\ndate: 2019-09-30 16:29:29\n---\n","updated":"2020-02-10T07:35:40.270Z","path":"about/index.html","comments":1,"layout":"page","_id":"ck6jh55fy0001ogvkoah3uwjb","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"JSP转HTML中EL表达式替换方式","date":"2019-11-06T09:12:20.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n* [4.为什么采用以上方式](#4-为什么采用以上方式)\n\n## 1.缘由\n\n工作中遇到老项目写的jsp采用了较多EL表达式导致无法前后分离，需要替代掉EL表达式，转化为html后再进行前后分离。\n\n## 2.目的\n\n能把包含EL表达式的JSP转化为HTML\n\n## 3.具体实施\n\n采用HandleBar前端插件替换EL表达式。\n\n### 3.1事前准备\n\nHandleBar基础用法\n\n### 3.2实施并验证\n\n**将一个用EL表达式写的导航转化为HandleBar来做**\n\n**源EL表达式：**\n```\n<!--菜单输出开始-->\n<ul id=\"menu_ul\">\n<c:forEach var=\"firstMenu\" items=\"${menus}\" varStatus=\"status\">\n  <li class=\"second\" <c:if test=\"${!empty firstMenu.URL}\"> \n  onclick=\"navClick('${firstMenu.ID}','${firstMenu.NAME}',\n    <c:choose>\n      <c:when test=\"${fn:startsWith(firstMenu.URL, 'http')}\">\n      '${firstMenu.URL}'</c:when>\n      <c:otherwise>webRoot + '${firstMenu.URL}'</c:otherwise>\n    </c:choose> )\"</c:if>>\n    <!--一级菜单输出-->\n    <c:choose>\n      <c:when test=\"${fn:contains(firstMenu.iconClass, '/')}\">\n        <img src=\"<%=webRoot%>${firstMenu.iconClass}\" />\n      </c:when>\n      <c:otherwise>\n        <i class='<c:if test=\"${!empty firstMenu.iconClass}\">\n        ${firstMenu.iconClass}</c:if>\n        <c:if test=\"${empty firstMenu.iconClass}\">icon-map-marker</c:if>'\n        title='${firstMenu.NAME}'></i>\n      </c:otherwise>\n    </c:choose>\n    <p>${firstMenu.NAME}</p>\n\n    <!-- 二层 -->\n    <ul>\n      <c:forEach var=\"secondMenu\" items=\"${firstMenu.senconds}\">\n        <li <c:if test=\"${!empty secondMenu.URL}\"> \n        onclick=\"navClick('${secondMenu.ID}','${secondMenu.NAME}',\n          <c:choose>\n            <c:when test=\"${fn:startsWith(secondMenu.URL, 'http')}\">\n      '${secondMenu.URL}'</c:when>\n            <c:otherwise>webRoot + '${secondMenu.URL}'</c:otherwise>\n          </c:choose> )\"</c:if>>\n          <i class='<c:if test=\"${!empty secondMenu.iconClass}\">\n      ${secondMenu.iconClass}</c:if>\n      <c:if test=\"${empty secondMenu.iconClass}\">icon-info-sign\n      </c:if>'></i>\n          <span>${secondMenu.NAME}\n            <c:if test=\"${!empty secondMenu.thirds}\">\n              <i class=\"icon-angle-right\"></i>\n            </c:if>\n          </span>\n          <!--二级菜单输出-->\n          <c:if test=\"${!empty secondMenu.thirds}\">\n\n            <c:if test=\"${secondMenu.haveFourth!=1}\">\n\n              <!-- 三层 -->\n              <ul class='fourth'>\n\n                <c:forEach var=\"thirdMenu\" items=\"${secondMenu.thirds}\">\n                  <!--三级菜单输出-->\n                  <li class='third orange width2 height1' \n          <c:if test=\"${!empty thirdMenu.URL}\"> \n          onclick=\"navClick('${thirdMenu.ID}','${thirdMenu.NAME}',\n                    <c:choose>\n                      <c:when test=\"${fn:startsWith(thirdMenu.URL, 'http')}\">\n            '${thirdMenu.URL}'</c:when>\n                      <c:otherwise>webRoot + '${thirdMenu.URL}'</c:otherwise>\n                    </c:choose> )\"</c:if>>\n\n            <span>${thirdMenu.NAME}</span>\n            <img src=\"<%=webRoot%>/page/images/img.png\" \n      onerror=\"this.src='<%=webRoot%>/page/images/unvisited.png'\" />\n            </li>\n            </c:forEach>\n            </ul>\n\n          </c:if>\n\n          <c:if test=\"${secondMenu.haveFourth==1}\">\n            <ul class=\"thirds\">\n              <c:forEach var=\"thirdMenu\" items=\"${secondMenu.thirds}\">\n                <!--三级菜单输出-->\n                <li <c:if test=\"${!empty thirdMenu.URL}\"> \n        onclick=\"navClick('${thirdMenu.ID}','${thirdMenu.NAME}',\n                  <c:choose>\n                    <c:when test=\"${fn:startsWith(thirdMenu.URL, 'http')}\">\n          '${thirdMenu.URL}'</c:when>\n                    <c:otherwise>webRoot + '${thirdMenu.URL}'</c:otherwise>\n                  </c:choose> )\"</c:if>>\n          <i class='<c:if test=\"${!empty thirdMenu.iconClass}\">\n      ${thirdMenu.iconClass}</c:if>\n      <c:if test=\"${empty thirdMenu.iconClass}\">icon-info-sign</c:if>'></i>\n          <span>${thirdMenu.NAME}\n            <c:if test=\"${!empty thirdMenu.fourths}\">\n              <i class=\"icon-angle-right\"></i>\n            </c:if>\n          </span>\n          <!--二级菜单输出-->\n          <c:if test=\"${!empty thirdMenu.fourths}\">\n\n            <ul class='fourth'>\n              <c:forEach var=\"fourthMenu\" items=\"${thirdMenu.fourths}\">\n                <li class='third orange width2 height1' \n        <c:if test=\"${!empty fourthMenu.URL}\"> \n        onclick=\"navClick('${fourthMenu.ID}','${fourthMenu.NAME}',\n                  <c:choose>\n                    <c:when test=\"${fn:startsWith(fourthMenu.URL, 'http')}\">\n          '${fourthMenu.URL}'</c:when>\n                    <c:otherwise>webRoot + '${fourthMenu.URL}'</c:otherwise>\n                  </c:choose> )\"</c:if>>\n          <span>${fourthMenu.NAME}</span>\n          <img src=\"<%=webRoot%>/page/images/img.png\"  \n      onerror=\"this.src='<%=webRoot%>/page/images/unvisited.png'\" />\n\n          </li>\n          </c:forEach>\n          </ul>\n          </c:if>\n          </li>\n          </c:forEach>\n          </ul>\n          </c:if>\n          </c:if>\n        </li>\n\n      </c:forEach>\n    </ul>\n  </li>\n</c:forEach>\n</ul>\n```\n\n**更改之后的HandleBar表达式**\n```\n<script id=\"menu_html\" type=\"text/x-handlebars-template\">\n{{!-- 菜单输出开始 --}}\n{{#each menus}}\n\n{{!-- 一级菜单输出 --}}\n{{#if URL}}\n<li class=\"second\" onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n  {{else}}\n<li class=\"second\">\n  {{/if}}\n\n  {{#if iconImg}}\n  <img src=\"{{iconImg}}\"/>\n  {{else}}\n  {{#if iconClass}}\n  <i class=\"{{iconClass}}\" title=\"{{NAME}}\"></i>\n  {{else}}\n  <i class=\"icon-map-marker\" title=\"{{NAME}}\"></i>\n  {{/if}}\n  {{/if}}\n\n\n  <p>{{NAME}}</p>\n\n  {{!-- 二级菜单输出 --}}\n  <ul>\n    {{#each seconds}}\n\n    {{#if URL}}\n    <li onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n      {{else}}\n    <li>\n      {{/if}}\n\n      {{#if iconClass}}\n      <i class=\"{{iconClass}}\" title=\"{{NAME}}\"></i>\n      {{else}}\n      <i class=\"icon-info-sign\" title=\"{{NAME}}\"></i>\n      {{/if}}\n\n      {{#if thirds}}\n      <span>{{NAME}}<i class=\"icon-angle-right\"></i></span>\n      {{else}}\n      <span>{{NAME}}</span>\n      {{/if}}\n\n      {{!-- 三级菜单输出 --}}\n      {{#if haveFourth}}\n      <ul class=\"thirds\">\n        {{#each thirds}}\n\n        {{#if URL}}\n        <li onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n          {{else}}\n        <li>\n          {{/if}}\n\n          {{#if iconClass}}\n          <i class=\"{{iconClass}}\" title=\"{{NAME}}\"></i>\n          {{else}}\n          <i class=\"icon-info-sign\" title=\"{{NAME}}\"></i>\n          {{/if}}\n\n          {{#if fourths}}\n          <span>{{NAME}}<i class=\"icon-angle-right\"></i></span>\n          <ul class='fourth'>\n            {{#each fourths}}\n            {{#if URL}}\n            <li class='third orange width2 height1' \n      onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n              {{else}}\n            <li>\n              {{/if}}\n              <span>{{NAME}}</span>\n              <img src=\"./images/nav_default.jpg\" \n        onerror=\"this.src='./images/unvisited.png'\"/>\n            </li>\n            {{/each}}\n\n          </ul>\n          {{else}}\n          <span>{{NAME}}</span>\n          {{/if}}\n          {{/each}}\n      </ul>\n\n      {{else}}\n\n      {{#if thirds}}\n      <ul class='fourth'>\n        {{#each thirds}}\n\n        {{#if URL}}\n        <li class='third orange width2 height1' \n    onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n          {{else}}\n        <li>\n          {{/if}}\n          <span>{{NAME}}</span>\n          <img src=\"./images/nav_default.jpg\" \n      onerror=\"this.src='./images/unvisited.png'\"/>\n        </li>\n        {{/each}}\n      </ul>\n      {{/if}}\n\n      {{/if}}\n\n    </li>\n    {{/each}}\n  </ul>\n\n</li>\n{{/each}}\n</script>\n```\n\n**HandleBar模板以及原始数据的js处理：**\n```\n\n    $.post('http://xxx?menus', '', function (data) {\n        eachFirstNav(data.menus);\n\n        var menuHTML = $(\"#menu_html\").html();\n        var template = Handlebars.compile(menuHTML);\n        var html = template(data);\n\n        let menuDom = $('#menu_ul');\n        menuDom.html(html);\n\n        navInit01();\n    }, 'json')\n\n    function eachFirstNav(data) {\n\n        for(let item in data){\n            if(data[item].URL === undefined) continue;\n            if (data[item].iconClass.indexOf('/') !== -1){\n                data[item].iconImg = webRoot + data[item].iconClass\n            }\n            if (data[item].URL !== '' ) {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                eachSecondsNav(data[item].seconds);\n            }\n        }\n    }\n\n    function eachSecondsNav(data) {\n        for(let item in data){\n            /*若有4层导航，样式等需要替换，由于HandleBar的\n      IF/ELSE判断无法判断具体逻辑，只能判断非空，故作此处理*/\n            if (data[item].haveFourth === -1) {\n                data[item].haveFourth = '';\n            }\n            if(data[item].URL === undefined) continue;\n            if (data[item].URL !== '') {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                eachThirdsNav(data[item].thirds);\n            }\n        }\n    }\n\n    function eachThirdsNav(data) {\n        for(let item in data){\n            if(data[item].URL === undefined) continue;\n            if (data[item].URL !== '') {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                eachFourthNav(data[item].thirds);\n            }\n        }\n    }\n\n    function eachFourthNav(data) {\n        for(let item in data){\n            if(data[item].URL === undefined) continue;\n            if (data[item].URL !== '') {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                return;\n            }\n        }\n    }\n```\n\n**源测试数据:**\n```\n{\n  \"menus\": [\n    {\n      \"ID\": \"a25b2t4aastb\",\n      \"CREATEDATETIME\": 1484647359000,\n      \"DESCRIPTION\": \"\",\n      \"ICONCLS\": \"\",\n      \"NAME\": \" 视图管理\",\n      \"SEQ\": 5,\n      \"TARGET\": \"\",\n      \"UPDATEDATETIME\": 1503631792000,\n      \"URL\": \"\",\n      \"SYRESOURCE_ID\": \"\",\n      \"SYRESOURCETYPE_ID\": \"0\",\n      \"color\": \"\",\n      \"iconClass\": \"icon-sitemap\\t\",\n      \"seconds\": [\n        {\n          \"ID\": \"ab542b5b25a\",\n          \"CREATEDATETIME\": 1517818707000,\n          \"DESCRIPTION\": \"\",\n          \"ICONCLS\": \"ext-icon-folder_user\",\n          \"NAME\": \"用户视图\",\n          \"SEQ\": 4,\n          \"TARGET\": \"\",\n          \"UPDATEDATETIME\": 1517818707000,\n          \"URL\": \"http://www.baidu.com\",\n          \"SYRESOURCE_ID\": \"haerhh123515\",\n          \"SYRESOURCETYPE_ID\": \"0\",\n          \"haveFourth\": -1,\n          \"thirds\": []\n        }\n      ]\n    },\n    {\n      \"ID\": \"fawfaf244\",\n      \"CREATEDATETIME\": 1458248395000,\n      \"DESCRIPTION\": \"管理系统的资源、角色、机构、用户等信息\",\n      \"ICONCLS\": \"\",\n      \"NAME\": \"系统管理\",\n      \"SEQ\": 40,\n      \"TARGET\": \"\",\n      \"UPDATEDATETIME\": 1502706964000,\n      \"URL\": \"\",\n      \"SYRESOURCE_ID\": \"\",\n      \"SYRESOURCETYPE_ID\": \"0\",\n      \"color\": \"xxx-color-blue\",\n      \"iconClass\": \"/page/image/icon_leftmenu09.png\",\n      \"seconds\": [\n        {\n          \"ID\": \"afawfa2\",\n          \"CREATEDATETIME\": 1503633639000,\n          \"DESCRIPTION\": \"\",\n          \"ICONCLS\": \"\",\n          \"NAME\": \"系统维护\",\n          \"SEQ\": 4,\n          \"TARGET\": \"\",\n          \"UPDATEDATETIME\": 1503633639000,\n          \"URL\": \"\",\n          \"SYRESOURCE_ID\": \"a22ab3wb2\",\n          \"SYRESOURCETYPE_ID\": \"0\",\n          \"haveFourth\": 1,\n          \"thirds\": [\n            {\n              \"ID\": \"afa2fa\",\n              \"CREATEDATETIME\": 1466414417000,\n              \"DESCRIPTION\": \"\",\n              \"ICONCLS\": \"\",\n              \"NAME\": \"功能使用统计\",\n              \"SEQ\": 4,\n              \"TARGET\": \"\",\n              \"UPDATEDATETIME\": 1503633686000,\n              \"URL\": \"/xxx.do?ba32b522\",\n              \"SYRESOURCE_ID\": \"a2b5235\",\n              \"SYRESOURCETYPE_ID\": \"0\",\n              \"color\": \"\",\n              \"iconClass\": \"icon-unlock-alt\",\n              \"fourths\": []\n            },\n            {\n              \"ID\": \"afa2f2a445\",\n              \"CREATEDATETIME\": 1504236483000,\n              \"DESCRIPTION\": \"数据库监控相关操作\",\n              \"ICONCLS\": \"\",\n              \"NAME\": \"数据库监控\",\n              \"SEQ\": 14,\n              \"TARGET\": \"\",\n              \"UPDATEDATETIME\": 1504236483000,\n              \"URL\": \"\",\n              \"SYRESOURCE_ID\": \"SYRESOURCE_IDxx\",\n              \"SYRESOURCETYPE_ID\": \"0\",\n              \"fourths\": [\n                {\n                  \"ID\": \"2bab525\",\n                  \"CREATEDATETIME\": 1504236647000,\n                  \"DESCRIPTION\": \"数据库信息查看\",\n                  \"ICONCLS\": \"\",\n                  \"NAME\": \"数据库信息查看\",\n                  \"SEQ\": 1,\n                  \"TARGET\": \"\",\n                  \"UPDATEDATETIME\": 1504236782000,\n                  \"URL\": \"/xxx.do?xxx\",\n                  \"SYRESOURCE_ID\": \"SYRESOURCE_IDawdwa\",\n                  \"SYRESOURCETYPE_ID\": \"0\"\n                }\n              ]\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n```\n\n## 4.为什么采用以上方式\n\n此案例中，本质都是js拼接html，但如果纯用js拼接html，会导致html标签结构被破坏，不利于维护，而HandleBar能够解决这个问题。不过要注意的是HandleBar并没有提供复杂的逻辑判断，所以本次处理对源数据用js做了处理以适配HandleBar。\n\n\n","source":"_posts/JSP转HTML中EL表达式替换方式.md","raw":"---\ntitle: JSP转HTML中EL表达式替换方式\ncategories:\n  - 前端\ntags:\n  - JSP\n  - EL表达式\ndate: 2019-11-06 17:12:20\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n* [4.为什么采用以上方式](#4-为什么采用以上方式)\n\n## 1.缘由\n\n工作中遇到老项目写的jsp采用了较多EL表达式导致无法前后分离，需要替代掉EL表达式，转化为html后再进行前后分离。\n\n## 2.目的\n\n能把包含EL表达式的JSP转化为HTML\n\n## 3.具体实施\n\n采用HandleBar前端插件替换EL表达式。\n\n### 3.1事前准备\n\nHandleBar基础用法\n\n### 3.2实施并验证\n\n**将一个用EL表达式写的导航转化为HandleBar来做**\n\n**源EL表达式：**\n```\n<!--菜单输出开始-->\n<ul id=\"menu_ul\">\n<c:forEach var=\"firstMenu\" items=\"${menus}\" varStatus=\"status\">\n  <li class=\"second\" <c:if test=\"${!empty firstMenu.URL}\"> \n  onclick=\"navClick('${firstMenu.ID}','${firstMenu.NAME}',\n    <c:choose>\n      <c:when test=\"${fn:startsWith(firstMenu.URL, 'http')}\">\n      '${firstMenu.URL}'</c:when>\n      <c:otherwise>webRoot + '${firstMenu.URL}'</c:otherwise>\n    </c:choose> )\"</c:if>>\n    <!--一级菜单输出-->\n    <c:choose>\n      <c:when test=\"${fn:contains(firstMenu.iconClass, '/')}\">\n        <img src=\"<%=webRoot%>${firstMenu.iconClass}\" />\n      </c:when>\n      <c:otherwise>\n        <i class='<c:if test=\"${!empty firstMenu.iconClass}\">\n        ${firstMenu.iconClass}</c:if>\n        <c:if test=\"${empty firstMenu.iconClass}\">icon-map-marker</c:if>'\n        title='${firstMenu.NAME}'></i>\n      </c:otherwise>\n    </c:choose>\n    <p>${firstMenu.NAME}</p>\n\n    <!-- 二层 -->\n    <ul>\n      <c:forEach var=\"secondMenu\" items=\"${firstMenu.senconds}\">\n        <li <c:if test=\"${!empty secondMenu.URL}\"> \n        onclick=\"navClick('${secondMenu.ID}','${secondMenu.NAME}',\n          <c:choose>\n            <c:when test=\"${fn:startsWith(secondMenu.URL, 'http')}\">\n      '${secondMenu.URL}'</c:when>\n            <c:otherwise>webRoot + '${secondMenu.URL}'</c:otherwise>\n          </c:choose> )\"</c:if>>\n          <i class='<c:if test=\"${!empty secondMenu.iconClass}\">\n      ${secondMenu.iconClass}</c:if>\n      <c:if test=\"${empty secondMenu.iconClass}\">icon-info-sign\n      </c:if>'></i>\n          <span>${secondMenu.NAME}\n            <c:if test=\"${!empty secondMenu.thirds}\">\n              <i class=\"icon-angle-right\"></i>\n            </c:if>\n          </span>\n          <!--二级菜单输出-->\n          <c:if test=\"${!empty secondMenu.thirds}\">\n\n            <c:if test=\"${secondMenu.haveFourth!=1}\">\n\n              <!-- 三层 -->\n              <ul class='fourth'>\n\n                <c:forEach var=\"thirdMenu\" items=\"${secondMenu.thirds}\">\n                  <!--三级菜单输出-->\n                  <li class='third orange width2 height1' \n          <c:if test=\"${!empty thirdMenu.URL}\"> \n          onclick=\"navClick('${thirdMenu.ID}','${thirdMenu.NAME}',\n                    <c:choose>\n                      <c:when test=\"${fn:startsWith(thirdMenu.URL, 'http')}\">\n            '${thirdMenu.URL}'</c:when>\n                      <c:otherwise>webRoot + '${thirdMenu.URL}'</c:otherwise>\n                    </c:choose> )\"</c:if>>\n\n            <span>${thirdMenu.NAME}</span>\n            <img src=\"<%=webRoot%>/page/images/img.png\" \n      onerror=\"this.src='<%=webRoot%>/page/images/unvisited.png'\" />\n            </li>\n            </c:forEach>\n            </ul>\n\n          </c:if>\n\n          <c:if test=\"${secondMenu.haveFourth==1}\">\n            <ul class=\"thirds\">\n              <c:forEach var=\"thirdMenu\" items=\"${secondMenu.thirds}\">\n                <!--三级菜单输出-->\n                <li <c:if test=\"${!empty thirdMenu.URL}\"> \n        onclick=\"navClick('${thirdMenu.ID}','${thirdMenu.NAME}',\n                  <c:choose>\n                    <c:when test=\"${fn:startsWith(thirdMenu.URL, 'http')}\">\n          '${thirdMenu.URL}'</c:when>\n                    <c:otherwise>webRoot + '${thirdMenu.URL}'</c:otherwise>\n                  </c:choose> )\"</c:if>>\n          <i class='<c:if test=\"${!empty thirdMenu.iconClass}\">\n      ${thirdMenu.iconClass}</c:if>\n      <c:if test=\"${empty thirdMenu.iconClass}\">icon-info-sign</c:if>'></i>\n          <span>${thirdMenu.NAME}\n            <c:if test=\"${!empty thirdMenu.fourths}\">\n              <i class=\"icon-angle-right\"></i>\n            </c:if>\n          </span>\n          <!--二级菜单输出-->\n          <c:if test=\"${!empty thirdMenu.fourths}\">\n\n            <ul class='fourth'>\n              <c:forEach var=\"fourthMenu\" items=\"${thirdMenu.fourths}\">\n                <li class='third orange width2 height1' \n        <c:if test=\"${!empty fourthMenu.URL}\"> \n        onclick=\"navClick('${fourthMenu.ID}','${fourthMenu.NAME}',\n                  <c:choose>\n                    <c:when test=\"${fn:startsWith(fourthMenu.URL, 'http')}\">\n          '${fourthMenu.URL}'</c:when>\n                    <c:otherwise>webRoot + '${fourthMenu.URL}'</c:otherwise>\n                  </c:choose> )\"</c:if>>\n          <span>${fourthMenu.NAME}</span>\n          <img src=\"<%=webRoot%>/page/images/img.png\"  \n      onerror=\"this.src='<%=webRoot%>/page/images/unvisited.png'\" />\n\n          </li>\n          </c:forEach>\n          </ul>\n          </c:if>\n          </li>\n          </c:forEach>\n          </ul>\n          </c:if>\n          </c:if>\n        </li>\n\n      </c:forEach>\n    </ul>\n  </li>\n</c:forEach>\n</ul>\n```\n\n**更改之后的HandleBar表达式**\n```\n<script id=\"menu_html\" type=\"text/x-handlebars-template\">\n{{!-- 菜单输出开始 --}}\n{{#each menus}}\n\n{{!-- 一级菜单输出 --}}\n{{#if URL}}\n<li class=\"second\" onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n  {{else}}\n<li class=\"second\">\n  {{/if}}\n\n  {{#if iconImg}}\n  <img src=\"{{iconImg}}\"/>\n  {{else}}\n  {{#if iconClass}}\n  <i class=\"{{iconClass}}\" title=\"{{NAME}}\"></i>\n  {{else}}\n  <i class=\"icon-map-marker\" title=\"{{NAME}}\"></i>\n  {{/if}}\n  {{/if}}\n\n\n  <p>{{NAME}}</p>\n\n  {{!-- 二级菜单输出 --}}\n  <ul>\n    {{#each seconds}}\n\n    {{#if URL}}\n    <li onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n      {{else}}\n    <li>\n      {{/if}}\n\n      {{#if iconClass}}\n      <i class=\"{{iconClass}}\" title=\"{{NAME}}\"></i>\n      {{else}}\n      <i class=\"icon-info-sign\" title=\"{{NAME}}\"></i>\n      {{/if}}\n\n      {{#if thirds}}\n      <span>{{NAME}}<i class=\"icon-angle-right\"></i></span>\n      {{else}}\n      <span>{{NAME}}</span>\n      {{/if}}\n\n      {{!-- 三级菜单输出 --}}\n      {{#if haveFourth}}\n      <ul class=\"thirds\">\n        {{#each thirds}}\n\n        {{#if URL}}\n        <li onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n          {{else}}\n        <li>\n          {{/if}}\n\n          {{#if iconClass}}\n          <i class=\"{{iconClass}}\" title=\"{{NAME}}\"></i>\n          {{else}}\n          <i class=\"icon-info-sign\" title=\"{{NAME}}\"></i>\n          {{/if}}\n\n          {{#if fourths}}\n          <span>{{NAME}}<i class=\"icon-angle-right\"></i></span>\n          <ul class='fourth'>\n            {{#each fourths}}\n            {{#if URL}}\n            <li class='third orange width2 height1' \n      onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n              {{else}}\n            <li>\n              {{/if}}\n              <span>{{NAME}}</span>\n              <img src=\"./images/nav_default.jpg\" \n        onerror=\"this.src='./images/unvisited.png'\"/>\n            </li>\n            {{/each}}\n\n          </ul>\n          {{else}}\n          <span>{{NAME}}</span>\n          {{/if}}\n          {{/each}}\n      </ul>\n\n      {{else}}\n\n      {{#if thirds}}\n      <ul class='fourth'>\n        {{#each thirds}}\n\n        {{#if URL}}\n        <li class='third orange width2 height1' \n    onclick=\"navClick('{{ID}}','{{NAME}}','{{URL}}')\">\n          {{else}}\n        <li>\n          {{/if}}\n          <span>{{NAME}}</span>\n          <img src=\"./images/nav_default.jpg\" \n      onerror=\"this.src='./images/unvisited.png'\"/>\n        </li>\n        {{/each}}\n      </ul>\n      {{/if}}\n\n      {{/if}}\n\n    </li>\n    {{/each}}\n  </ul>\n\n</li>\n{{/each}}\n</script>\n```\n\n**HandleBar模板以及原始数据的js处理：**\n```\n\n    $.post('http://xxx?menus', '', function (data) {\n        eachFirstNav(data.menus);\n\n        var menuHTML = $(\"#menu_html\").html();\n        var template = Handlebars.compile(menuHTML);\n        var html = template(data);\n\n        let menuDom = $('#menu_ul');\n        menuDom.html(html);\n\n        navInit01();\n    }, 'json')\n\n    function eachFirstNav(data) {\n\n        for(let item in data){\n            if(data[item].URL === undefined) continue;\n            if (data[item].iconClass.indexOf('/') !== -1){\n                data[item].iconImg = webRoot + data[item].iconClass\n            }\n            if (data[item].URL !== '' ) {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                eachSecondsNav(data[item].seconds);\n            }\n        }\n    }\n\n    function eachSecondsNav(data) {\n        for(let item in data){\n            /*若有4层导航，样式等需要替换，由于HandleBar的\n      IF/ELSE判断无法判断具体逻辑，只能判断非空，故作此处理*/\n            if (data[item].haveFourth === -1) {\n                data[item].haveFourth = '';\n            }\n            if(data[item].URL === undefined) continue;\n            if (data[item].URL !== '') {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                eachThirdsNav(data[item].thirds);\n            }\n        }\n    }\n\n    function eachThirdsNav(data) {\n        for(let item in data){\n            if(data[item].URL === undefined) continue;\n            if (data[item].URL !== '') {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                eachFourthNav(data[item].thirds);\n            }\n        }\n    }\n\n    function eachFourthNav(data) {\n        for(let item in data){\n            if(data[item].URL === undefined) continue;\n            if (data[item].URL !== '') {\n                if (data[item].URL.indexOf('http') === -1) {\n                    data[item].URL = webRoot + data[item].URL ;\n                }\n            } else {\n                return;\n            }\n        }\n    }\n```\n\n**源测试数据:**\n```\n{\n  \"menus\": [\n    {\n      \"ID\": \"a25b2t4aastb\",\n      \"CREATEDATETIME\": 1484647359000,\n      \"DESCRIPTION\": \"\",\n      \"ICONCLS\": \"\",\n      \"NAME\": \" 视图管理\",\n      \"SEQ\": 5,\n      \"TARGET\": \"\",\n      \"UPDATEDATETIME\": 1503631792000,\n      \"URL\": \"\",\n      \"SYRESOURCE_ID\": \"\",\n      \"SYRESOURCETYPE_ID\": \"0\",\n      \"color\": \"\",\n      \"iconClass\": \"icon-sitemap\\t\",\n      \"seconds\": [\n        {\n          \"ID\": \"ab542b5b25a\",\n          \"CREATEDATETIME\": 1517818707000,\n          \"DESCRIPTION\": \"\",\n          \"ICONCLS\": \"ext-icon-folder_user\",\n          \"NAME\": \"用户视图\",\n          \"SEQ\": 4,\n          \"TARGET\": \"\",\n          \"UPDATEDATETIME\": 1517818707000,\n          \"URL\": \"http://www.baidu.com\",\n          \"SYRESOURCE_ID\": \"haerhh123515\",\n          \"SYRESOURCETYPE_ID\": \"0\",\n          \"haveFourth\": -1,\n          \"thirds\": []\n        }\n      ]\n    },\n    {\n      \"ID\": \"fawfaf244\",\n      \"CREATEDATETIME\": 1458248395000,\n      \"DESCRIPTION\": \"管理系统的资源、角色、机构、用户等信息\",\n      \"ICONCLS\": \"\",\n      \"NAME\": \"系统管理\",\n      \"SEQ\": 40,\n      \"TARGET\": \"\",\n      \"UPDATEDATETIME\": 1502706964000,\n      \"URL\": \"\",\n      \"SYRESOURCE_ID\": \"\",\n      \"SYRESOURCETYPE_ID\": \"0\",\n      \"color\": \"xxx-color-blue\",\n      \"iconClass\": \"/page/image/icon_leftmenu09.png\",\n      \"seconds\": [\n        {\n          \"ID\": \"afawfa2\",\n          \"CREATEDATETIME\": 1503633639000,\n          \"DESCRIPTION\": \"\",\n          \"ICONCLS\": \"\",\n          \"NAME\": \"系统维护\",\n          \"SEQ\": 4,\n          \"TARGET\": \"\",\n          \"UPDATEDATETIME\": 1503633639000,\n          \"URL\": \"\",\n          \"SYRESOURCE_ID\": \"a22ab3wb2\",\n          \"SYRESOURCETYPE_ID\": \"0\",\n          \"haveFourth\": 1,\n          \"thirds\": [\n            {\n              \"ID\": \"afa2fa\",\n              \"CREATEDATETIME\": 1466414417000,\n              \"DESCRIPTION\": \"\",\n              \"ICONCLS\": \"\",\n              \"NAME\": \"功能使用统计\",\n              \"SEQ\": 4,\n              \"TARGET\": \"\",\n              \"UPDATEDATETIME\": 1503633686000,\n              \"URL\": \"/xxx.do?ba32b522\",\n              \"SYRESOURCE_ID\": \"a2b5235\",\n              \"SYRESOURCETYPE_ID\": \"0\",\n              \"color\": \"\",\n              \"iconClass\": \"icon-unlock-alt\",\n              \"fourths\": []\n            },\n            {\n              \"ID\": \"afa2f2a445\",\n              \"CREATEDATETIME\": 1504236483000,\n              \"DESCRIPTION\": \"数据库监控相关操作\",\n              \"ICONCLS\": \"\",\n              \"NAME\": \"数据库监控\",\n              \"SEQ\": 14,\n              \"TARGET\": \"\",\n              \"UPDATEDATETIME\": 1504236483000,\n              \"URL\": \"\",\n              \"SYRESOURCE_ID\": \"SYRESOURCE_IDxx\",\n              \"SYRESOURCETYPE_ID\": \"0\",\n              \"fourths\": [\n                {\n                  \"ID\": \"2bab525\",\n                  \"CREATEDATETIME\": 1504236647000,\n                  \"DESCRIPTION\": \"数据库信息查看\",\n                  \"ICONCLS\": \"\",\n                  \"NAME\": \"数据库信息查看\",\n                  \"SEQ\": 1,\n                  \"TARGET\": \"\",\n                  \"UPDATEDATETIME\": 1504236782000,\n                  \"URL\": \"/xxx.do?xxx\",\n                  \"SYRESOURCE_ID\": \"SYRESOURCE_IDawdwa\",\n                  \"SYRESOURCETYPE_ID\": \"0\"\n                }\n              ]\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n```\n\n## 4.为什么采用以上方式\n\n此案例中，本质都是js拼接html，但如果纯用js拼接html，会导致html标签结构被破坏，不利于维护，而HandleBar能够解决这个问题。不过要注意的是HandleBar并没有提供复杂的逻辑判断，所以本次处理对源数据用js做了处理以适配HandleBar。\n\n\n","slug":"JSP转HTML中EL表达式替换方式","published":1,"updated":"2020-02-10T07:35:40.255Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55fv0000ogvkchefzxnp","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a></li>\n</ul>\n</li>\n<li><a href=\"#4-为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>工作中遇到老项目写的jsp采用了较多EL表达式导致无法前后分离，需要替代掉EL表达式，转化为html后再进行前后分离。</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能把包含EL表达式的JSP转化为HTML</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><p>采用HandleBar前端插件替换EL表达式。</p>\n<h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><p>HandleBar基础用法</p>\n<h3 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h3><p><strong>将一个用EL表达式写的导航转化为HandleBar来做</strong></p>\n<p><strong>源EL表达式：</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!--菜单输出开始--&gt;</span><br><span class=\"line\">&lt;ul id=&quot;menu_ul&quot;&gt;</span><br><span class=\"line\">&lt;c:forEach var=&quot;firstMenu&quot; items=&quot;$&#123;menus&#125;&quot; varStatus=&quot;status&quot;&gt;</span><br><span class=\"line\">  &lt;li class=&quot;second&quot; &lt;c:if test=&quot;$&#123;!empty firstMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">  onclick=&quot;navClick(&apos;$&#123;firstMenu.ID&#125;&apos;,&apos;$&#123;firstMenu.NAME&#125;&apos;,</span><br><span class=\"line\">    &lt;c:choose&gt;</span><br><span class=\"line\">      &lt;c:when test=&quot;$&#123;fn:startsWith(firstMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">      &apos;$&#123;firstMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">      &lt;c:otherwise&gt;webRoot + &apos;$&#123;firstMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">    &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">    &lt;!--一级菜单输出--&gt;</span><br><span class=\"line\">    &lt;c:choose&gt;</span><br><span class=\"line\">      &lt;c:when test=&quot;$&#123;fn:contains(firstMenu.iconClass, &apos;/&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">        &lt;img src=&quot;&lt;%=webRoot%&gt;$&#123;firstMenu.iconClass&#125;&quot; /&gt;</span><br><span class=\"line\">      &lt;/c:when&gt;</span><br><span class=\"line\">      &lt;c:otherwise&gt;</span><br><span class=\"line\">        &lt;i class=&apos;&lt;c:if test=&quot;$&#123;!empty firstMenu.iconClass&#125;&quot;&gt;</span><br><span class=\"line\">        $&#123;firstMenu.iconClass&#125;&lt;/c:if&gt;</span><br><span class=\"line\">        &lt;c:if test=&quot;$&#123;empty firstMenu.iconClass&#125;&quot;&gt;icon-map-marker&lt;/c:if&gt;&apos;</span><br><span class=\"line\">        title=&apos;$&#123;firstMenu.NAME&#125;&apos;&gt;&lt;/i&gt;</span><br><span class=\"line\">      &lt;/c:otherwise&gt;</span><br><span class=\"line\">    &lt;/c:choose&gt;</span><br><span class=\"line\">    &lt;p&gt;$&#123;firstMenu.NAME&#125;&lt;/p&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- 二层 --&gt;</span><br><span class=\"line\">    &lt;ul&gt;</span><br><span class=\"line\">      &lt;c:forEach var=&quot;secondMenu&quot; items=&quot;$&#123;firstMenu.senconds&#125;&quot;&gt;</span><br><span class=\"line\">        &lt;li &lt;c:if test=&quot;$&#123;!empty secondMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">        onclick=&quot;navClick(&apos;$&#123;secondMenu.ID&#125;&apos;,&apos;$&#123;secondMenu.NAME&#125;&apos;,</span><br><span class=\"line\">          &lt;c:choose&gt;</span><br><span class=\"line\">            &lt;c:when test=&quot;$&#123;fn:startsWith(secondMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">      &apos;$&#123;secondMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">            &lt;c:otherwise&gt;webRoot + &apos;$&#123;secondMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">          &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">          &lt;i class=&apos;&lt;c:if test=&quot;$&#123;!empty secondMenu.iconClass&#125;&quot;&gt;</span><br><span class=\"line\">      $&#123;secondMenu.iconClass&#125;&lt;/c:if&gt;</span><br><span class=\"line\">      &lt;c:if test=&quot;$&#123;empty secondMenu.iconClass&#125;&quot;&gt;icon-info-sign</span><br><span class=\"line\">      &lt;/c:if&gt;&apos;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &lt;span&gt;$&#123;secondMenu.NAME&#125;</span><br><span class=\"line\">            &lt;c:if test=&quot;$&#123;!empty secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\">              &lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">            &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/span&gt;</span><br><span class=\"line\">          &lt;!--二级菜单输出--&gt;</span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;!empty secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">            &lt;c:if test=&quot;$&#123;secondMenu.haveFourth!=1&#125;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">              &lt;!-- 三层 --&gt;</span><br><span class=\"line\">              &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">                &lt;c:forEach var=&quot;thirdMenu&quot; items=&quot;$&#123;secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\">                  &lt;!--三级菜单输出--&gt;</span><br><span class=\"line\">                  &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;!empty thirdMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">          onclick=&quot;navClick(&apos;$&#123;thirdMenu.ID&#125;&apos;,&apos;$&#123;thirdMenu.NAME&#125;&apos;,</span><br><span class=\"line\">                    &lt;c:choose&gt;</span><br><span class=\"line\">                      &lt;c:when test=&quot;$&#123;fn:startsWith(thirdMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">            &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">                      &lt;c:otherwise&gt;webRoot + &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">                    &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">            &lt;span&gt;$&#123;thirdMenu.NAME&#125;&lt;/span&gt;</span><br><span class=\"line\">            &lt;img src=&quot;&lt;%=webRoot%&gt;/page/images/img.png&quot; </span><br><span class=\"line\">      onerror=&quot;this.src=&apos;&lt;%=webRoot%&gt;/page/images/unvisited.png&apos;&quot; /&gt;</span><br><span class=\"line\">            &lt;/li&gt;</span><br><span class=\"line\">            &lt;/c:forEach&gt;</span><br><span class=\"line\">            &lt;/ul&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;secondMenu.haveFourth==1&#125;&quot;&gt;</span><br><span class=\"line\">            &lt;ul class=&quot;thirds&quot;&gt;</span><br><span class=\"line\">              &lt;c:forEach var=&quot;thirdMenu&quot; items=&quot;$&#123;secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\">                &lt;!--三级菜单输出--&gt;</span><br><span class=\"line\">                &lt;li &lt;c:if test=&quot;$&#123;!empty thirdMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">        onclick=&quot;navClick(&apos;$&#123;thirdMenu.ID&#125;&apos;,&apos;$&#123;thirdMenu.NAME&#125;&apos;,</span><br><span class=\"line\">                  &lt;c:choose&gt;</span><br><span class=\"line\">                    &lt;c:when test=&quot;$&#123;fn:startsWith(thirdMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">          &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">                    &lt;c:otherwise&gt;webRoot + &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">                  &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">          &lt;i class=&apos;&lt;c:if test=&quot;$&#123;!empty thirdMenu.iconClass&#125;&quot;&gt;</span><br><span class=\"line\">      $&#123;thirdMenu.iconClass&#125;&lt;/c:if&gt;</span><br><span class=\"line\">      &lt;c:if test=&quot;$&#123;empty thirdMenu.iconClass&#125;&quot;&gt;icon-info-sign&lt;/c:if&gt;&apos;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &lt;span&gt;$&#123;thirdMenu.NAME&#125;</span><br><span class=\"line\">            &lt;c:if test=&quot;$&#123;!empty thirdMenu.fourths&#125;&quot;&gt;</span><br><span class=\"line\">              &lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">            &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/span&gt;</span><br><span class=\"line\">          &lt;!--二级菜单输出--&gt;</span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;!empty thirdMenu.fourths&#125;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">            &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\">              &lt;c:forEach var=&quot;fourthMenu&quot; items=&quot;$&#123;thirdMenu.fourths&#125;&quot;&gt;</span><br><span class=\"line\">                &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">        &lt;c:if test=&quot;$&#123;!empty fourthMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">        onclick=&quot;navClick(&apos;$&#123;fourthMenu.ID&#125;&apos;,&apos;$&#123;fourthMenu.NAME&#125;&apos;,</span><br><span class=\"line\">                  &lt;c:choose&gt;</span><br><span class=\"line\">                    &lt;c:when test=&quot;$&#123;fn:startsWith(fourthMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">          &apos;$&#123;fourthMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">                    &lt;c:otherwise&gt;webRoot + &apos;$&#123;fourthMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">                  &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">          &lt;span&gt;$&#123;fourthMenu.NAME&#125;&lt;/span&gt;</span><br><span class=\"line\">          &lt;img src=&quot;&lt;%=webRoot%&gt;/page/images/img.png&quot;  </span><br><span class=\"line\">      onerror=&quot;this.src=&apos;&lt;%=webRoot%&gt;/page/images/unvisited.png&apos;&quot; /&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;/li&gt;</span><br><span class=\"line\">          &lt;/c:forEach&gt;</span><br><span class=\"line\">          &lt;/ul&gt;</span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/li&gt;</span><br><span class=\"line\">          &lt;/c:forEach&gt;</span><br><span class=\"line\">          &lt;/ul&gt;</span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\">        &lt;/li&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">      &lt;/c:forEach&gt;</span><br><span class=\"line\">    &lt;/ul&gt;</span><br><span class=\"line\">  &lt;/li&gt;</span><br><span class=\"line\">&lt;/c:forEach&gt;</span><br><span class=\"line\">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>\n\n<p><strong>更改之后的HandleBar表达式</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script id=&quot;menu_html&quot; type=&quot;text/x-handlebars-template&quot;&gt;</span><br><span class=\"line\">&#123;&#123;!-- 菜单输出开始 --&#125;&#125;</span><br><span class=\"line\">&#123;&#123;#each menus&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;&#123;!-- 一级菜单输出 --&#125;&#125;</span><br><span class=\"line\">&#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">&lt;li class=&quot;second&quot; onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">  &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">&lt;li class=&quot;second&quot;&gt;</span><br><span class=\"line\">  &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  &#123;&#123;#if iconImg&#125;&#125;</span><br><span class=\"line\">  &lt;img src=&quot;&#123;&#123;iconImg&#125;&#125;&quot;/&gt;</span><br><span class=\"line\">  &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">  &#123;&#123;#if iconClass&#125;&#125;</span><br><span class=\"line\">  &lt;i class=&quot;&#123;&#123;iconClass&#125;&#125;&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">  &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">  &lt;i class=&quot;icon-map-marker&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">  &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">  &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">  &lt;p&gt;&#123;&#123;NAME&#125;&#125;&lt;/p&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">  &#123;&#123;!-- 二级菜单输出 --&#125;&#125;</span><br><span class=\"line\">  &lt;ul&gt;</span><br><span class=\"line\">    &#123;&#123;#each seconds&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">    &lt;li onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">    &lt;li&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;#if iconClass&#125;&#125;</span><br><span class=\"line\">      &lt;i class=&quot;&#123;&#123;iconClass&#125;&#125;&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">      &lt;i class=&quot;icon-info-sign&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;#if thirds&#125;&#125;</span><br><span class=\"line\">      &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;&lt;/span&gt;</span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">      &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;!-- 三级菜单输出 --&#125;&#125;</span><br><span class=\"line\">      &#123;&#123;#if haveFourth&#125;&#125;</span><br><span class=\"line\">      &lt;ul class=&quot;thirds&quot;&gt;</span><br><span class=\"line\">        &#123;&#123;#each thirds&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">        &lt;li onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">        &lt;li&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          &#123;&#123;#if iconClass&#125;&#125;</span><br><span class=\"line\">          &lt;i class=&quot;&#123;&#123;iconClass&#125;&#125;&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">          &lt;i class=&quot;icon-info-sign&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          &#123;&#123;#if fourths&#125;&#125;</span><br><span class=\"line\">          &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;&lt;/span&gt;</span><br><span class=\"line\">          &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\">            &#123;&#123;#each fourths&#125;&#125;</span><br><span class=\"line\">            &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">            &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">      onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">              &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">            &lt;li&gt;</span><br><span class=\"line\">              &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">              &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">              &lt;img src=&quot;./images/nav_default.jpg&quot; </span><br><span class=\"line\">        onerror=&quot;this.src=&apos;./images/unvisited.png&apos;&quot;/&gt;</span><br><span class=\"line\">            &lt;/li&gt;</span><br><span class=\"line\">            &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;/ul&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">          &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">          &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">      &lt;/ul&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;#if thirds&#125;&#125;</span><br><span class=\"line\">      &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\">        &#123;&#123;#each thirds&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">        &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">    onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">        &lt;li&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">          &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">          &lt;img src=&quot;./images/nav_default.jpg&quot; </span><br><span class=\"line\">      onerror=&quot;this.src=&apos;./images/unvisited.png&apos;&quot;/&gt;</span><br><span class=\"line\">        &lt;/li&gt;</span><br><span class=\"line\">        &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">      &lt;/ul&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;/li&gt;</span><br><span class=\"line\">    &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">  &lt;/ul&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/li&gt;</span><br><span class=\"line\">&#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n\n<p><strong>HandleBar模板以及原始数据的js处理：</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">$.post(&apos;http://xxx?menus&apos;, &apos;&apos;, function (data) &#123;</span><br><span class=\"line\">    eachFirstNav(data.menus);</span><br><span class=\"line\"></span><br><span class=\"line\">    var menuHTML = $(&quot;#menu_html&quot;).html();</span><br><span class=\"line\">    var template = Handlebars.compile(menuHTML);</span><br><span class=\"line\">    var html = template(data);</span><br><span class=\"line\"></span><br><span class=\"line\">    let menuDom = $(&apos;#menu_ul&apos;);</span><br><span class=\"line\">    menuDom.html(html);</span><br><span class=\"line\"></span><br><span class=\"line\">    navInit01();</span><br><span class=\"line\">&#125;, &apos;json&apos;)</span><br><span class=\"line\"></span><br><span class=\"line\">function eachFirstNav(data) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].iconClass.indexOf(&apos;/&apos;) !== -1)&#123;</span><br><span class=\"line\">            data[item].iconImg = webRoot + data[item].iconClass</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos; ) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            eachSecondsNav(data[item].seconds);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function eachSecondsNav(data) &#123;</span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        /*若有4层导航，样式等需要替换，由于HandleBar的</span><br><span class=\"line\">  IF/ELSE判断无法判断具体逻辑，只能判断非空，故作此处理*/</span><br><span class=\"line\">        if (data[item].haveFourth === -1) &#123;</span><br><span class=\"line\">            data[item].haveFourth = &apos;&apos;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos;) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            eachThirdsNav(data[item].thirds);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function eachThirdsNav(data) &#123;</span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos;) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            eachFourthNav(data[item].thirds);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function eachFourthNav(data) &#123;</span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos;) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            return;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>源测试数据:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;menus&quot;: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      &quot;ID&quot;: &quot;a25b2t4aastb&quot;,</span><br><span class=\"line\">      &quot;CREATEDATETIME&quot;: 1484647359000,</span><br><span class=\"line\">      &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;NAME&quot;: &quot; 视图管理&quot;,</span><br><span class=\"line\">      &quot;SEQ&quot;: 5,</span><br><span class=\"line\">      &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;UPDATEDATETIME&quot;: 1503631792000,</span><br><span class=\"line\">      &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCE_ID&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">      &quot;color&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;iconClass&quot;: &quot;icon-sitemap\\t&quot;,</span><br><span class=\"line\">      &quot;seconds&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          &quot;ID&quot;: &quot;ab542b5b25a&quot;,</span><br><span class=\"line\">          &quot;CREATEDATETIME&quot;: 1517818707000,</span><br><span class=\"line\">          &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;ICONCLS&quot;: &quot;ext-icon-folder_user&quot;,</span><br><span class=\"line\">          &quot;NAME&quot;: &quot;用户视图&quot;,</span><br><span class=\"line\">          &quot;SEQ&quot;: 4,</span><br><span class=\"line\">          &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;UPDATEDATETIME&quot;: 1517818707000,</span><br><span class=\"line\">          &quot;URL&quot;: &quot;http://www.baidu.com&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCE_ID&quot;: &quot;haerhh123515&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">          &quot;haveFourth&quot;: -1,</span><br><span class=\"line\">          &quot;thirds&quot;: []</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      &quot;ID&quot;: &quot;fawfaf244&quot;,</span><br><span class=\"line\">      &quot;CREATEDATETIME&quot;: 1458248395000,</span><br><span class=\"line\">      &quot;DESCRIPTION&quot;: &quot;管理系统的资源、角色、机构、用户等信息&quot;,</span><br><span class=\"line\">      &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;NAME&quot;: &quot;系统管理&quot;,</span><br><span class=\"line\">      &quot;SEQ&quot;: 40,</span><br><span class=\"line\">      &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;UPDATEDATETIME&quot;: 1502706964000,</span><br><span class=\"line\">      &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCE_ID&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">      &quot;color&quot;: &quot;xxx-color-blue&quot;,</span><br><span class=\"line\">      &quot;iconClass&quot;: &quot;/page/image/icon_leftmenu09.png&quot;,</span><br><span class=\"line\">      &quot;seconds&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          &quot;ID&quot;: &quot;afawfa2&quot;,</span><br><span class=\"line\">          &quot;CREATEDATETIME&quot;: 1503633639000,</span><br><span class=\"line\">          &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;NAME&quot;: &quot;系统维护&quot;,</span><br><span class=\"line\">          &quot;SEQ&quot;: 4,</span><br><span class=\"line\">          &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;UPDATEDATETIME&quot;: 1503633639000,</span><br><span class=\"line\">          &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCE_ID&quot;: &quot;a22ab3wb2&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">          &quot;haveFourth&quot;: 1,</span><br><span class=\"line\">          &quot;thirds&quot;: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">              &quot;ID&quot;: &quot;afa2fa&quot;,</span><br><span class=\"line\">              &quot;CREATEDATETIME&quot;: 1466414417000,</span><br><span class=\"line\">              &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;NAME&quot;: &quot;功能使用统计&quot;,</span><br><span class=\"line\">              &quot;SEQ&quot;: 4,</span><br><span class=\"line\">              &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;UPDATEDATETIME&quot;: 1503633686000,</span><br><span class=\"line\">              &quot;URL&quot;: &quot;/xxx.do?ba32b522&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCE_ID&quot;: &quot;a2b5235&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">              &quot;color&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;iconClass&quot;: &quot;icon-unlock-alt&quot;,</span><br><span class=\"line\">              &quot;fourths&quot;: []</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">              &quot;ID&quot;: &quot;afa2f2a445&quot;,</span><br><span class=\"line\">              &quot;CREATEDATETIME&quot;: 1504236483000,</span><br><span class=\"line\">              &quot;DESCRIPTION&quot;: &quot;数据库监控相关操作&quot;,</span><br><span class=\"line\">              &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;NAME&quot;: &quot;数据库监控&quot;,</span><br><span class=\"line\">              &quot;SEQ&quot;: 14,</span><br><span class=\"line\">              &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;UPDATEDATETIME&quot;: 1504236483000,</span><br><span class=\"line\">              &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCE_ID&quot;: &quot;SYRESOURCE_IDxx&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">              &quot;fourths&quot;: [</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                  &quot;ID&quot;: &quot;2bab525&quot;,</span><br><span class=\"line\">                  &quot;CREATEDATETIME&quot;: 1504236647000,</span><br><span class=\"line\">                  &quot;DESCRIPTION&quot;: &quot;数据库信息查看&quot;,</span><br><span class=\"line\">                  &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">                  &quot;NAME&quot;: &quot;数据库信息查看&quot;,</span><br><span class=\"line\">                  &quot;SEQ&quot;: 1,</span><br><span class=\"line\">                  &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">                  &quot;UPDATEDATETIME&quot;: 1504236782000,</span><br><span class=\"line\">                  &quot;URL&quot;: &quot;/xxx.do?xxx&quot;,</span><br><span class=\"line\">                  &quot;SYRESOURCE_ID&quot;: &quot;SYRESOURCE_IDawdwa&quot;,</span><br><span class=\"line\">                  &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">              ]</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          ]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-为什么采用以上方式\"><a href=\"#4-为什么采用以上方式\" class=\"headerlink\" title=\"4.为什么采用以上方式\"></a>4.为什么采用以上方式</h2><p>此案例中，本质都是js拼接html，但如果纯用js拼接html，会导致html标签结构被破坏，不利于维护，而HandleBar能够解决这个问题。不过要注意的是HandleBar并没有提供复杂的逻辑判断，所以本次处理对源数据用js做了处理以适配HandleBar。</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a></li>\n</ul>\n</li>\n<li><a href=\"#4-为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>工作中遇到老项目写的jsp采用了较多EL表达式导致无法前后分离，需要替代掉EL表达式，转化为html后再进行前后分离。</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能把包含EL表达式的JSP转化为HTML</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><p>采用HandleBar前端插件替换EL表达式。</p>\n<h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><p>HandleBar基础用法</p>\n<h3 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h3><p><strong>将一个用EL表达式写的导航转化为HandleBar来做</strong></p>\n<p><strong>源EL表达式：</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!--菜单输出开始--&gt;</span><br><span class=\"line\">&lt;ul id=&quot;menu_ul&quot;&gt;</span><br><span class=\"line\">&lt;c:forEach var=&quot;firstMenu&quot; items=&quot;$&#123;menus&#125;&quot; varStatus=&quot;status&quot;&gt;</span><br><span class=\"line\">  &lt;li class=&quot;second&quot; &lt;c:if test=&quot;$&#123;!empty firstMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">  onclick=&quot;navClick(&apos;$&#123;firstMenu.ID&#125;&apos;,&apos;$&#123;firstMenu.NAME&#125;&apos;,</span><br><span class=\"line\">    &lt;c:choose&gt;</span><br><span class=\"line\">      &lt;c:when test=&quot;$&#123;fn:startsWith(firstMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">      &apos;$&#123;firstMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">      &lt;c:otherwise&gt;webRoot + &apos;$&#123;firstMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">    &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">    &lt;!--一级菜单输出--&gt;</span><br><span class=\"line\">    &lt;c:choose&gt;</span><br><span class=\"line\">      &lt;c:when test=&quot;$&#123;fn:contains(firstMenu.iconClass, &apos;/&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">        &lt;img src=&quot;&lt;%=webRoot%&gt;$&#123;firstMenu.iconClass&#125;&quot; /&gt;</span><br><span class=\"line\">      &lt;/c:when&gt;</span><br><span class=\"line\">      &lt;c:otherwise&gt;</span><br><span class=\"line\">        &lt;i class=&apos;&lt;c:if test=&quot;$&#123;!empty firstMenu.iconClass&#125;&quot;&gt;</span><br><span class=\"line\">        $&#123;firstMenu.iconClass&#125;&lt;/c:if&gt;</span><br><span class=\"line\">        &lt;c:if test=&quot;$&#123;empty firstMenu.iconClass&#125;&quot;&gt;icon-map-marker&lt;/c:if&gt;&apos;</span><br><span class=\"line\">        title=&apos;$&#123;firstMenu.NAME&#125;&apos;&gt;&lt;/i&gt;</span><br><span class=\"line\">      &lt;/c:otherwise&gt;</span><br><span class=\"line\">    &lt;/c:choose&gt;</span><br><span class=\"line\">    &lt;p&gt;$&#123;firstMenu.NAME&#125;&lt;/p&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;!-- 二层 --&gt;</span><br><span class=\"line\">    &lt;ul&gt;</span><br><span class=\"line\">      &lt;c:forEach var=&quot;secondMenu&quot; items=&quot;$&#123;firstMenu.senconds&#125;&quot;&gt;</span><br><span class=\"line\">        &lt;li &lt;c:if test=&quot;$&#123;!empty secondMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">        onclick=&quot;navClick(&apos;$&#123;secondMenu.ID&#125;&apos;,&apos;$&#123;secondMenu.NAME&#125;&apos;,</span><br><span class=\"line\">          &lt;c:choose&gt;</span><br><span class=\"line\">            &lt;c:when test=&quot;$&#123;fn:startsWith(secondMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">      &apos;$&#123;secondMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">            &lt;c:otherwise&gt;webRoot + &apos;$&#123;secondMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">          &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">          &lt;i class=&apos;&lt;c:if test=&quot;$&#123;!empty secondMenu.iconClass&#125;&quot;&gt;</span><br><span class=\"line\">      $&#123;secondMenu.iconClass&#125;&lt;/c:if&gt;</span><br><span class=\"line\">      &lt;c:if test=&quot;$&#123;empty secondMenu.iconClass&#125;&quot;&gt;icon-info-sign</span><br><span class=\"line\">      &lt;/c:if&gt;&apos;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &lt;span&gt;$&#123;secondMenu.NAME&#125;</span><br><span class=\"line\">            &lt;c:if test=&quot;$&#123;!empty secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\">              &lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">            &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/span&gt;</span><br><span class=\"line\">          &lt;!--二级菜单输出--&gt;</span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;!empty secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">            &lt;c:if test=&quot;$&#123;secondMenu.haveFourth!=1&#125;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">              &lt;!-- 三层 --&gt;</span><br><span class=\"line\">              &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">                &lt;c:forEach var=&quot;thirdMenu&quot; items=&quot;$&#123;secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\">                  &lt;!--三级菜单输出--&gt;</span><br><span class=\"line\">                  &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;!empty thirdMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">          onclick=&quot;navClick(&apos;$&#123;thirdMenu.ID&#125;&apos;,&apos;$&#123;thirdMenu.NAME&#125;&apos;,</span><br><span class=\"line\">                    &lt;c:choose&gt;</span><br><span class=\"line\">                      &lt;c:when test=&quot;$&#123;fn:startsWith(thirdMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">            &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">                      &lt;c:otherwise&gt;webRoot + &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">                    &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">            &lt;span&gt;$&#123;thirdMenu.NAME&#125;&lt;/span&gt;</span><br><span class=\"line\">            &lt;img src=&quot;&lt;%=webRoot%&gt;/page/images/img.png&quot; </span><br><span class=\"line\">      onerror=&quot;this.src=&apos;&lt;%=webRoot%&gt;/page/images/unvisited.png&apos;&quot; /&gt;</span><br><span class=\"line\">            &lt;/li&gt;</span><br><span class=\"line\">            &lt;/c:forEach&gt;</span><br><span class=\"line\">            &lt;/ul&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;secondMenu.haveFourth==1&#125;&quot;&gt;</span><br><span class=\"line\">            &lt;ul class=&quot;thirds&quot;&gt;</span><br><span class=\"line\">              &lt;c:forEach var=&quot;thirdMenu&quot; items=&quot;$&#123;secondMenu.thirds&#125;&quot;&gt;</span><br><span class=\"line\">                &lt;!--三级菜单输出--&gt;</span><br><span class=\"line\">                &lt;li &lt;c:if test=&quot;$&#123;!empty thirdMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">        onclick=&quot;navClick(&apos;$&#123;thirdMenu.ID&#125;&apos;,&apos;$&#123;thirdMenu.NAME&#125;&apos;,</span><br><span class=\"line\">                  &lt;c:choose&gt;</span><br><span class=\"line\">                    &lt;c:when test=&quot;$&#123;fn:startsWith(thirdMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">          &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">                    &lt;c:otherwise&gt;webRoot + &apos;$&#123;thirdMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">                  &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">          &lt;i class=&apos;&lt;c:if test=&quot;$&#123;!empty thirdMenu.iconClass&#125;&quot;&gt;</span><br><span class=\"line\">      $&#123;thirdMenu.iconClass&#125;&lt;/c:if&gt;</span><br><span class=\"line\">      &lt;c:if test=&quot;$&#123;empty thirdMenu.iconClass&#125;&quot;&gt;icon-info-sign&lt;/c:if&gt;&apos;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &lt;span&gt;$&#123;thirdMenu.NAME&#125;</span><br><span class=\"line\">            &lt;c:if test=&quot;$&#123;!empty thirdMenu.fourths&#125;&quot;&gt;</span><br><span class=\"line\">              &lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">            &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/span&gt;</span><br><span class=\"line\">          &lt;!--二级菜单输出--&gt;</span><br><span class=\"line\">          &lt;c:if test=&quot;$&#123;!empty thirdMenu.fourths&#125;&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">            &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\">              &lt;c:forEach var=&quot;fourthMenu&quot; items=&quot;$&#123;thirdMenu.fourths&#125;&quot;&gt;</span><br><span class=\"line\">                &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">        &lt;c:if test=&quot;$&#123;!empty fourthMenu.URL&#125;&quot;&gt; </span><br><span class=\"line\">        onclick=&quot;navClick(&apos;$&#123;fourthMenu.ID&#125;&apos;,&apos;$&#123;fourthMenu.NAME&#125;&apos;,</span><br><span class=\"line\">                  &lt;c:choose&gt;</span><br><span class=\"line\">                    &lt;c:when test=&quot;$&#123;fn:startsWith(fourthMenu.URL, &apos;http&apos;)&#125;&quot;&gt;</span><br><span class=\"line\">          &apos;$&#123;fourthMenu.URL&#125;&apos;&lt;/c:when&gt;</span><br><span class=\"line\">                    &lt;c:otherwise&gt;webRoot + &apos;$&#123;fourthMenu.URL&#125;&apos;&lt;/c:otherwise&gt;</span><br><span class=\"line\">                  &lt;/c:choose&gt; )&quot;&lt;/c:if&gt;&gt;</span><br><span class=\"line\">          &lt;span&gt;$&#123;fourthMenu.NAME&#125;&lt;/span&gt;</span><br><span class=\"line\">          &lt;img src=&quot;&lt;%=webRoot%&gt;/page/images/img.png&quot;  </span><br><span class=\"line\">      onerror=&quot;this.src=&apos;&lt;%=webRoot%&gt;/page/images/unvisited.png&apos;&quot; /&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;/li&gt;</span><br><span class=\"line\">          &lt;/c:forEach&gt;</span><br><span class=\"line\">          &lt;/ul&gt;</span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/li&gt;</span><br><span class=\"line\">          &lt;/c:forEach&gt;</span><br><span class=\"line\">          &lt;/ul&gt;</span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\">          &lt;/c:if&gt;</span><br><span class=\"line\">        &lt;/li&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">      &lt;/c:forEach&gt;</span><br><span class=\"line\">    &lt;/ul&gt;</span><br><span class=\"line\">  &lt;/li&gt;</span><br><span class=\"line\">&lt;/c:forEach&gt;</span><br><span class=\"line\">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>\n\n<p><strong>更改之后的HandleBar表达式</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script id=&quot;menu_html&quot; type=&quot;text/x-handlebars-template&quot;&gt;</span><br><span class=\"line\">&#123;&#123;!-- 菜单输出开始 --&#125;&#125;</span><br><span class=\"line\">&#123;&#123;#each menus&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;&#123;!-- 一级菜单输出 --&#125;&#125;</span><br><span class=\"line\">&#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">&lt;li class=&quot;second&quot; onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">  &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">&lt;li class=&quot;second&quot;&gt;</span><br><span class=\"line\">  &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  &#123;&#123;#if iconImg&#125;&#125;</span><br><span class=\"line\">  &lt;img src=&quot;&#123;&#123;iconImg&#125;&#125;&quot;/&gt;</span><br><span class=\"line\">  &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">  &#123;&#123;#if iconClass&#125;&#125;</span><br><span class=\"line\">  &lt;i class=&quot;&#123;&#123;iconClass&#125;&#125;&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">  &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">  &lt;i class=&quot;icon-map-marker&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">  &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">  &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">  &lt;p&gt;&#123;&#123;NAME&#125;&#125;&lt;/p&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">  &#123;&#123;!-- 二级菜单输出 --&#125;&#125;</span><br><span class=\"line\">  &lt;ul&gt;</span><br><span class=\"line\">    &#123;&#123;#each seconds&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">    &lt;li onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">    &lt;li&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;#if iconClass&#125;&#125;</span><br><span class=\"line\">      &lt;i class=&quot;&#123;&#123;iconClass&#125;&#125;&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">      &lt;i class=&quot;icon-info-sign&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;#if thirds&#125;&#125;</span><br><span class=\"line\">      &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;&lt;/span&gt;</span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">      &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;!-- 三级菜单输出 --&#125;&#125;</span><br><span class=\"line\">      &#123;&#123;#if haveFourth&#125;&#125;</span><br><span class=\"line\">      &lt;ul class=&quot;thirds&quot;&gt;</span><br><span class=\"line\">        &#123;&#123;#each thirds&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">        &lt;li onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">        &lt;li&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          &#123;&#123;#if iconClass&#125;&#125;</span><br><span class=\"line\">          &lt;i class=&quot;&#123;&#123;iconClass&#125;&#125;&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">          &lt;i class=&quot;icon-info-sign&quot; title=&quot;&#123;&#123;NAME&#125;&#125;&quot;&gt;&lt;/i&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          &#123;&#123;#if fourths&#125;&#125;</span><br><span class=\"line\">          &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;i class=&quot;icon-angle-right&quot;&gt;&lt;/i&gt;&lt;/span&gt;</span><br><span class=\"line\">          &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\">            &#123;&#123;#each fourths&#125;&#125;</span><br><span class=\"line\">            &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">            &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">      onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">              &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">            &lt;li&gt;</span><br><span class=\"line\">              &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">              &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">              &lt;img src=&quot;./images/nav_default.jpg&quot; </span><br><span class=\"line\">        onerror=&quot;this.src=&apos;./images/unvisited.png&apos;&quot;/&gt;</span><br><span class=\"line\">            &lt;/li&gt;</span><br><span class=\"line\">            &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">          &lt;/ul&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">          &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">          &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">      &lt;/ul&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;else&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;#if thirds&#125;&#125;</span><br><span class=\"line\">      &lt;ul class=&apos;fourth&apos;&gt;</span><br><span class=\"line\">        &#123;&#123;#each thirds&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#123;&#123;#if URL&#125;&#125;</span><br><span class=\"line\">        &lt;li class=&apos;third orange width2 height1&apos; </span><br><span class=\"line\">    onclick=&quot;navClick(&apos;&#123;&#123;ID&#125;&#125;&apos;,&apos;&#123;&#123;NAME&#125;&#125;&apos;,&apos;&#123;&#123;URL&#125;&#125;&apos;)&quot;&gt;</span><br><span class=\"line\">          &#123;&#123;else&#125;&#125;</span><br><span class=\"line\">        &lt;li&gt;</span><br><span class=\"line\">          &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\">          &lt;span&gt;&#123;&#123;NAME&#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">          &lt;img src=&quot;./images/nav_default.jpg&quot; </span><br><span class=\"line\">      onerror=&quot;this.src=&apos;./images/unvisited.png&apos;&quot;/&gt;</span><br><span class=\"line\">        &lt;/li&gt;</span><br><span class=\"line\">        &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">      &lt;/ul&gt;</span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;&#123;/if&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;/li&gt;</span><br><span class=\"line\">    &#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">  &lt;/ul&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/li&gt;</span><br><span class=\"line\">&#123;&#123;/each&#125;&#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n\n<p><strong>HandleBar模板以及原始数据的js处理：</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">$.post(&apos;http://xxx?menus&apos;, &apos;&apos;, function (data) &#123;</span><br><span class=\"line\">    eachFirstNav(data.menus);</span><br><span class=\"line\"></span><br><span class=\"line\">    var menuHTML = $(&quot;#menu_html&quot;).html();</span><br><span class=\"line\">    var template = Handlebars.compile(menuHTML);</span><br><span class=\"line\">    var html = template(data);</span><br><span class=\"line\"></span><br><span class=\"line\">    let menuDom = $(&apos;#menu_ul&apos;);</span><br><span class=\"line\">    menuDom.html(html);</span><br><span class=\"line\"></span><br><span class=\"line\">    navInit01();</span><br><span class=\"line\">&#125;, &apos;json&apos;)</span><br><span class=\"line\"></span><br><span class=\"line\">function eachFirstNav(data) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].iconClass.indexOf(&apos;/&apos;) !== -1)&#123;</span><br><span class=\"line\">            data[item].iconImg = webRoot + data[item].iconClass</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos; ) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            eachSecondsNav(data[item].seconds);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function eachSecondsNav(data) &#123;</span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        /*若有4层导航，样式等需要替换，由于HandleBar的</span><br><span class=\"line\">  IF/ELSE判断无法判断具体逻辑，只能判断非空，故作此处理*/</span><br><span class=\"line\">        if (data[item].haveFourth === -1) &#123;</span><br><span class=\"line\">            data[item].haveFourth = &apos;&apos;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos;) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            eachThirdsNav(data[item].thirds);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function eachThirdsNav(data) &#123;</span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos;) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            eachFourthNav(data[item].thirds);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function eachFourthNav(data) &#123;</span><br><span class=\"line\">    for(let item in data)&#123;</span><br><span class=\"line\">        if(data[item].URL === undefined) continue;</span><br><span class=\"line\">        if (data[item].URL !== &apos;&apos;) &#123;</span><br><span class=\"line\">            if (data[item].URL.indexOf(&apos;http&apos;) === -1) &#123;</span><br><span class=\"line\">                data[item].URL = webRoot + data[item].URL ;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            return;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>源测试数据:</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;menus&quot;: [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      &quot;ID&quot;: &quot;a25b2t4aastb&quot;,</span><br><span class=\"line\">      &quot;CREATEDATETIME&quot;: 1484647359000,</span><br><span class=\"line\">      &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;NAME&quot;: &quot; 视图管理&quot;,</span><br><span class=\"line\">      &quot;SEQ&quot;: 5,</span><br><span class=\"line\">      &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;UPDATEDATETIME&quot;: 1503631792000,</span><br><span class=\"line\">      &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCE_ID&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">      &quot;color&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;iconClass&quot;: &quot;icon-sitemap\\t&quot;,</span><br><span class=\"line\">      &quot;seconds&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          &quot;ID&quot;: &quot;ab542b5b25a&quot;,</span><br><span class=\"line\">          &quot;CREATEDATETIME&quot;: 1517818707000,</span><br><span class=\"line\">          &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;ICONCLS&quot;: &quot;ext-icon-folder_user&quot;,</span><br><span class=\"line\">          &quot;NAME&quot;: &quot;用户视图&quot;,</span><br><span class=\"line\">          &quot;SEQ&quot;: 4,</span><br><span class=\"line\">          &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;UPDATEDATETIME&quot;: 1517818707000,</span><br><span class=\"line\">          &quot;URL&quot;: &quot;http://www.baidu.com&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCE_ID&quot;: &quot;haerhh123515&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">          &quot;haveFourth&quot;: -1,</span><br><span class=\"line\">          &quot;thirds&quot;: []</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      &quot;ID&quot;: &quot;fawfaf244&quot;,</span><br><span class=\"line\">      &quot;CREATEDATETIME&quot;: 1458248395000,</span><br><span class=\"line\">      &quot;DESCRIPTION&quot;: &quot;管理系统的资源、角色、机构、用户等信息&quot;,</span><br><span class=\"line\">      &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;NAME&quot;: &quot;系统管理&quot;,</span><br><span class=\"line\">      &quot;SEQ&quot;: 40,</span><br><span class=\"line\">      &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;UPDATEDATETIME&quot;: 1502706964000,</span><br><span class=\"line\">      &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCE_ID&quot;: &quot;&quot;,</span><br><span class=\"line\">      &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">      &quot;color&quot;: &quot;xxx-color-blue&quot;,</span><br><span class=\"line\">      &quot;iconClass&quot;: &quot;/page/image/icon_leftmenu09.png&quot;,</span><br><span class=\"line\">      &quot;seconds&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">          &quot;ID&quot;: &quot;afawfa2&quot;,</span><br><span class=\"line\">          &quot;CREATEDATETIME&quot;: 1503633639000,</span><br><span class=\"line\">          &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;NAME&quot;: &quot;系统维护&quot;,</span><br><span class=\"line\">          &quot;SEQ&quot;: 4,</span><br><span class=\"line\">          &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;UPDATEDATETIME&quot;: 1503633639000,</span><br><span class=\"line\">          &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCE_ID&quot;: &quot;a22ab3wb2&quot;,</span><br><span class=\"line\">          &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">          &quot;haveFourth&quot;: 1,</span><br><span class=\"line\">          &quot;thirds&quot;: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">              &quot;ID&quot;: &quot;afa2fa&quot;,</span><br><span class=\"line\">              &quot;CREATEDATETIME&quot;: 1466414417000,</span><br><span class=\"line\">              &quot;DESCRIPTION&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;NAME&quot;: &quot;功能使用统计&quot;,</span><br><span class=\"line\">              &quot;SEQ&quot;: 4,</span><br><span class=\"line\">              &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;UPDATEDATETIME&quot;: 1503633686000,</span><br><span class=\"line\">              &quot;URL&quot;: &quot;/xxx.do?ba32b522&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCE_ID&quot;: &quot;a2b5235&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">              &quot;color&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;iconClass&quot;: &quot;icon-unlock-alt&quot;,</span><br><span class=\"line\">              &quot;fourths&quot;: []</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">              &quot;ID&quot;: &quot;afa2f2a445&quot;,</span><br><span class=\"line\">              &quot;CREATEDATETIME&quot;: 1504236483000,</span><br><span class=\"line\">              &quot;DESCRIPTION&quot;: &quot;数据库监控相关操作&quot;,</span><br><span class=\"line\">              &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;NAME&quot;: &quot;数据库监控&quot;,</span><br><span class=\"line\">              &quot;SEQ&quot;: 14,</span><br><span class=\"line\">              &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;UPDATEDATETIME&quot;: 1504236483000,</span><br><span class=\"line\">              &quot;URL&quot;: &quot;&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCE_ID&quot;: &quot;SYRESOURCE_IDxx&quot;,</span><br><span class=\"line\">              &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;,</span><br><span class=\"line\">              &quot;fourths&quot;: [</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                  &quot;ID&quot;: &quot;2bab525&quot;,</span><br><span class=\"line\">                  &quot;CREATEDATETIME&quot;: 1504236647000,</span><br><span class=\"line\">                  &quot;DESCRIPTION&quot;: &quot;数据库信息查看&quot;,</span><br><span class=\"line\">                  &quot;ICONCLS&quot;: &quot;&quot;,</span><br><span class=\"line\">                  &quot;NAME&quot;: &quot;数据库信息查看&quot;,</span><br><span class=\"line\">                  &quot;SEQ&quot;: 1,</span><br><span class=\"line\">                  &quot;TARGET&quot;: &quot;&quot;,</span><br><span class=\"line\">                  &quot;UPDATEDATETIME&quot;: 1504236782000,</span><br><span class=\"line\">                  &quot;URL&quot;: &quot;/xxx.do?xxx&quot;,</span><br><span class=\"line\">                  &quot;SYRESOURCE_ID&quot;: &quot;SYRESOURCE_IDawdwa&quot;,</span><br><span class=\"line\">                  &quot;SYRESOURCETYPE_ID&quot;: &quot;0&quot;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">              ]</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">          ]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-为什么采用以上方式\"><a href=\"#4-为什么采用以上方式\" class=\"headerlink\" title=\"4.为什么采用以上方式\"></a>4.为什么采用以上方式</h2><p>此案例中，本质都是js拼接html，但如果纯用js拼接html，会导致html标签结构被破坏，不利于维护，而HandleBar能够解决这个问题。不过要注意的是HandleBar并没有提供复杂的逻辑判断，所以本次处理对源数据用js做了处理以适配HandleBar。</p>\n"},{"title":"Mysql常用配置","date":"2019-11-18T03:33:03.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n* [4.为什么采用以上方式](#4-为什么采用以上方式)\n\n## 1.缘由\n\n\n\n## 2.目的\n\n\n\n## 3.具体实施\n\n\n\n### 3.1事前准备\n\n\n\n### 3.2实施并验证\n\n**具体配置**\n\n```\n[client]\nport=3306\nsocket=/usr/local/var/mysql.sock\ndefault-character-set=utf8\n\n[mysqld]\nuser=mysql\nbind-address=0.0.0.0\nport=3306\ndatadir=/data/mysql/\nsocket=/usr/local/var/mysql.sock\nlog_bin=/data/mysql/mysql-bin\nexpire_logs_days=7\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\n\nmax-connections=2048\nmax_connect_errors=500\nmax_allowed_packet=16M\nopen-files-limit=65536\n\ncharacter-set-server=utf8\ndefault-storage-engine=InnoDB\nlower_case_table_names=1\nsql_mode=STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION\n\nserver-id=1\n\ninnodb_data_home_dir=/data/mysql/\ninnodb_file_per_table=1\ninnodb_open_files=4096\ntable_open_cache=4096\n\n#Forced autoinc locking\nbinlog_format=row\ninnodb_autoinc_lock_mode=2\n\n#load data\ninnodb_buffer_pool_size=62G\n\n\ninnodb_log_buffer_size=16M\ninnodb_log_file_size=256M\ninnodb_log_files_in_group=8\n\n\n[mysqld_safe]\nlog_bin=/data/mysql/mysql-bin\nexpire_logs_days=7\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\n\n```\n\n## 4.为什么采用以上方式\n\n\n\n","source":"_posts/Mysql常用配置.md","raw":"---\ntitle: Mysql常用配置\ncategories:\n  - Mysql\ntags:\n  - 配置\ndate: 2019-11-18 11:33:03\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n* [4.为什么采用以上方式](#4-为什么采用以上方式)\n\n## 1.缘由\n\n\n\n## 2.目的\n\n\n\n## 3.具体实施\n\n\n\n### 3.1事前准备\n\n\n\n### 3.2实施并验证\n\n**具体配置**\n\n```\n[client]\nport=3306\nsocket=/usr/local/var/mysql.sock\ndefault-character-set=utf8\n\n[mysqld]\nuser=mysql\nbind-address=0.0.0.0\nport=3306\ndatadir=/data/mysql/\nsocket=/usr/local/var/mysql.sock\nlog_bin=/data/mysql/mysql-bin\nexpire_logs_days=7\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\n\nmax-connections=2048\nmax_connect_errors=500\nmax_allowed_packet=16M\nopen-files-limit=65536\n\ncharacter-set-server=utf8\ndefault-storage-engine=InnoDB\nlower_case_table_names=1\nsql_mode=STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION\n\nserver-id=1\n\ninnodb_data_home_dir=/data/mysql/\ninnodb_file_per_table=1\ninnodb_open_files=4096\ntable_open_cache=4096\n\n#Forced autoinc locking\nbinlog_format=row\ninnodb_autoinc_lock_mode=2\n\n#load data\ninnodb_buffer_pool_size=62G\n\n\ninnodb_log_buffer_size=16M\ninnodb_log_file_size=256M\ninnodb_log_files_in_group=8\n\n\n[mysqld_safe]\nlog_bin=/data/mysql/mysql-bin\nexpire_logs_days=7\nlog-error=/var/log/mysqld.log\npid-file=/var/run/mysqld/mysqld.pid\n\n```\n\n## 4.为什么采用以上方式\n\n\n\n","slug":"Mysql常用配置","published":1,"updated":"2020-02-10T07:35:40.255Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55fz0002ogvkt3znglcy","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a></li>\n</ul>\n</li>\n<li><a href=\"#4-为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><h3 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h3><p><strong>具体配置</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[client]</span><br><span class=\"line\">port=3306</span><br><span class=\"line\">socket=/usr/local/var/mysql.sock</span><br><span class=\"line\">default-character-set=utf8</span><br><span class=\"line\"></span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\">user=mysql</span><br><span class=\"line\">bind-address=0.0.0.0</span><br><span class=\"line\">port=3306</span><br><span class=\"line\">datadir=/data/mysql/</span><br><span class=\"line\">socket=/usr/local/var/mysql.sock</span><br><span class=\"line\">log_bin=/data/mysql/mysql-bin</span><br><span class=\"line\">expire_logs_days=7</span><br><span class=\"line\">log-error=/var/log/mysqld.log</span><br><span class=\"line\">pid-file=/var/run/mysqld/mysqld.pid</span><br><span class=\"line\"></span><br><span class=\"line\">max-connections=2048</span><br><span class=\"line\">max_connect_errors=500</span><br><span class=\"line\">max_allowed_packet=16M</span><br><span class=\"line\">open-files-limit=65536</span><br><span class=\"line\"></span><br><span class=\"line\">character-set-server=utf8</span><br><span class=\"line\">default-storage-engine=InnoDB</span><br><span class=\"line\">lower_case_table_names=1</span><br><span class=\"line\">sql_mode=STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION</span><br><span class=\"line\"></span><br><span class=\"line\">server-id=1</span><br><span class=\"line\"></span><br><span class=\"line\">innodb_data_home_dir=/data/mysql/</span><br><span class=\"line\">innodb_file_per_table=1</span><br><span class=\"line\">innodb_open_files=4096</span><br><span class=\"line\">table_open_cache=4096</span><br><span class=\"line\"></span><br><span class=\"line\">#Forced autoinc locking</span><br><span class=\"line\">binlog_format=row</span><br><span class=\"line\">innodb_autoinc_lock_mode=2</span><br><span class=\"line\"></span><br><span class=\"line\">#load data</span><br><span class=\"line\">innodb_buffer_pool_size=62G</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">innodb_log_buffer_size=16M</span><br><span class=\"line\">innodb_log_file_size=256M</span><br><span class=\"line\">innodb_log_files_in_group=8</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">[mysqld_safe]</span><br><span class=\"line\">log_bin=/data/mysql/mysql-bin</span><br><span class=\"line\">expire_logs_days=7</span><br><span class=\"line\">log-error=/var/log/mysqld.log</span><br><span class=\"line\">pid-file=/var/run/mysqld/mysqld.pid</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-为什么采用以上方式\"><a href=\"#4-为什么采用以上方式\" class=\"headerlink\" title=\"4.为什么采用以上方式\"></a>4.为什么采用以上方式</h2>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a></li>\n</ul>\n</li>\n<li><a href=\"#4-为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><h3 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h3><p><strong>具体配置</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[client]</span><br><span class=\"line\">port=3306</span><br><span class=\"line\">socket=/usr/local/var/mysql.sock</span><br><span class=\"line\">default-character-set=utf8</span><br><span class=\"line\"></span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\">user=mysql</span><br><span class=\"line\">bind-address=0.0.0.0</span><br><span class=\"line\">port=3306</span><br><span class=\"line\">datadir=/data/mysql/</span><br><span class=\"line\">socket=/usr/local/var/mysql.sock</span><br><span class=\"line\">log_bin=/data/mysql/mysql-bin</span><br><span class=\"line\">expire_logs_days=7</span><br><span class=\"line\">log-error=/var/log/mysqld.log</span><br><span class=\"line\">pid-file=/var/run/mysqld/mysqld.pid</span><br><span class=\"line\"></span><br><span class=\"line\">max-connections=2048</span><br><span class=\"line\">max_connect_errors=500</span><br><span class=\"line\">max_allowed_packet=16M</span><br><span class=\"line\">open-files-limit=65536</span><br><span class=\"line\"></span><br><span class=\"line\">character-set-server=utf8</span><br><span class=\"line\">default-storage-engine=InnoDB</span><br><span class=\"line\">lower_case_table_names=1</span><br><span class=\"line\">sql_mode=STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION</span><br><span class=\"line\"></span><br><span class=\"line\">server-id=1</span><br><span class=\"line\"></span><br><span class=\"line\">innodb_data_home_dir=/data/mysql/</span><br><span class=\"line\">innodb_file_per_table=1</span><br><span class=\"line\">innodb_open_files=4096</span><br><span class=\"line\">table_open_cache=4096</span><br><span class=\"line\"></span><br><span class=\"line\">#Forced autoinc locking</span><br><span class=\"line\">binlog_format=row</span><br><span class=\"line\">innodb_autoinc_lock_mode=2</span><br><span class=\"line\"></span><br><span class=\"line\">#load data</span><br><span class=\"line\">innodb_buffer_pool_size=62G</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">innodb_log_buffer_size=16M</span><br><span class=\"line\">innodb_log_file_size=256M</span><br><span class=\"line\">innodb_log_files_in_group=8</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">[mysqld_safe]</span><br><span class=\"line\">log_bin=/data/mysql/mysql-bin</span><br><span class=\"line\">expire_logs_days=7</span><br><span class=\"line\">log-error=/var/log/mysqld.log</span><br><span class=\"line\">pid-file=/var/run/mysqld/mysqld.pid</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-为什么采用以上方式\"><a href=\"#4-为什么采用以上方式\" class=\"headerlink\" title=\"4.为什么采用以上方式\"></a>4.为什么采用以上方式</h2>"},{"title":"Java学习-内存区域","date":"2020-02-03T08:12:21.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 进入正题](#3-2进入正题)\n\n## 1.缘由\n\n巩固Java知识图谱\n\n## 2.目的\n\n强化基础，避免大楼不稳\n\n## 3.具体实施\n\n### 3.1事前准备\n\n注意区别于内存模型，JMM即内存模型，是指线程和主内存之前的抽象关系，定义了JVM在RAM中的工作方式，用于并发编程。\n\n内存区域指的是JVM运行时将数据分区域存储，是对内存空间的划分。\n\n### 3.2进入正题\n\njdk8之后JVM内存区域有几大块：\n\n* 本地方法栈(Native Method Stacks)\n* 程序计数器(Program Counter Register)\n* 虚拟机栈(JVM Stacks)\n* 虚拟机堆(JVM Heap)\n* 元数据区(Metaspace)\n\n### 3.2.1本地方法栈\n\n\n为虚拟机使用到的native方法服务，Sun HotSpot虚拟机把本地方法栈和虚拟机栈合二为一，都会跑出对应SOF、OOM异常。\n\n由于是调用操作系统特性功能，复用非Java代码，所以不受JVM约束，可以通过JNI来访问运行时的数据区，或调用寄存器等，不过使用JNI同样会使得系统丧失跨平台特性。\n\n### 3.2.2程序计数器\n\n程序计数器是一块较小的内存空间，可以看作为当前线程所执行的字节码的行号指示器。\n\n值得一提的是JVM的多线程是通过线程轮流切换并分配处理器执行时间的方式来实现的，在任何一个确定的时刻，一个处理器内核都只会执行一条线程中的指令。因此，为了线程切换后能恢复到正确的执行位置，每条线程都需要有一个独立的程序计数器，各条线程之间计数器互不影响，独立存储，这类内存区域为\"线程私有\"的内存。\n\n若线程执行的是一个Native方法，这个计数器值则为空(Undefined)。此内存区域是唯一一个在JVM中没有规定OOM的区域。\n\n### 3.2.3虚拟机栈\n\n和程序计数器一样，为线程私有，生命周期于线程相同。\n\n虚拟机栈描述的是Java方法执行的内存模型：每个方法在执行的同时都会创建一个栈帧(Stack Frame,方法运行时的基础数据结构)用于存储局部变量、操作数栈、动态链接、方法出口等信息。每一个方法从调用直至执行完成的过程，就对应着一个栈帧在虚拟机栈中入栈到出栈的过程。\n\n在活动线程中，只有位于栈顶的帧才是有效的，称为当前栈帧。正在执行的方法称为当前方法，栈帧是方法运行的基本结构。在执行引擎运行时，所有指令都只能针对当前栈帧进行操作。\n\n\n1. 局部变量表\n局部变量表是存放方法参数和局部变量的区域。 局部变量没有准备阶段， 必须显式初始化。如果是非静态方法，则在 index[0] 位置上存储的是方法所属对象的实例引用，一个引用变量占 4 个字节，随后存储的是参数和局部变量。字节码指令中的 STORE 指令就是将操作栈中计算完成的局部变呈写回局部变量表的存储空间内。\n\n虚拟机栈规定了两种异常状况：如果线程请求的栈深度大于虚拟机所允许的深度，将抛出 StackOverflowError 异常；如果虚拟机栈可以动态扩展（当前大部分的 Java 虚拟机都可动态扩展），如果扩展时无法申请到足够的内存，就会抛出 OutOfMemoryError 异常。\n\n2. 操作栈\n操作栈是个初始状态为空的桶式结构栈。在方法执行过程中， 会有各种指令往\n栈中写入和提取信息。JVM 的执行引擎是基于栈的执行引擎， 其中的栈指的就是操\n作栈。字节码指令集的定义都是基于栈类型的，栈的深度在方法元信息的 stack 属性中。\n\ni++ 和 ++i 的区别：\n\ni++：从局部变量表取出 i 并压入操作栈，然后对局部变量表中的 i 自增 1，将操作栈栈顶值取出使用，最后，使用栈顶值更新局部变量表，如此线程从操作栈读到的是自增之前的值。\n++i：先对局部变量表的 i 自增 1，然后取出并压入操作栈，再将操作栈栈顶值取出使用，最后，使用栈顶值更新局部变量表，线程从操作栈读到的是自增之后的值。\n之前之所以说 i++ 不是原子操作，即使使用 volatile 修饰也不是线程安全，就是因为，可能 i 被从局部变量表（内存）取出，压入操作栈（寄存器），操作栈中自增，使用栈顶值更新局部变量表（寄存器更新写入内存），其中分为 3 步，volatile 保证可见性，保证每次从局部变量表读取的都是最新的值，但可能这 3 步可能被另一个线程的 3 步打断，产生数据互相覆盖问题，从而导致 i 的值比预期的小。\n\n3. 动态链接\n每个栈帧中包含一个在常量池中对当前方法的引用， 目的是支持方法调用过程的动态连接。\n\n4.方法返回地址\n方法执行时有两种退出情况：\n\n正常退出，即正常执行到任何方法的返回字节码指令，如 RETURN、IRETURN、ARETURN 等；\n异常退出。\n无论何种退出情况，都将返回至方法当前被调用的位置。方法退出的过程相当于弹出当前栈帧，退出可能有三种方式：\n\n返回值压入上层调用栈帧。\n异常信息抛给能够处理的栈帧。\nPC计数器指向方法调用后的下一条指令。\n\n\n### 3.2.4虚拟机堆\n\n#### Java堆\n\n对于大多数应用来说，Java 堆（Java Heap）是 Java 虚拟机所管理的内存中最大的一块。Java 堆是被所有线程共享的一块内存区域，在虚拟机启动时创建。此内存区域的唯一目的就是存放对象实例，几乎所有的对象实例都在这里分配内存。\n\n堆是垃圾收集器管理的主要区域，因此很多时候也被称做“GC堆”（Garbage Collected Heap）。从内存回收的角度来看，由于现在收集器基本都采用\n//todo\n![分代收集算法](./GC-分代收集算法.md)，所以 Java 堆中还可以细分为：新生代和老年代；再细致一点的有 Eden 空间、From Survivor 空间、To Survivor 空间等。从内存分配的角度来看，线程共享的 Java 堆中可能划分出多个线程私有的分配缓冲区（Thread Local Allocation Buffer,TLAB）。\n\nJava 堆可以处于物理上不连续的内存空间中，只要逻辑上是连续的即可，当前主流的虚拟机都是按照可扩展来实现的（通过 -Xmx 和 -Xms 控制）。如果在堆中没有内存完成实例分配，并且堆也无法再扩展时，将会抛出 OutOfMemoryError 异常。\n\n### 3.2.5元数据区\n\n#### 方法区\n\n方法区（Method Area）与 Java 堆一样，是各个线程共享的内存区域，它用于存储已被虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。虽然\nJava 虚拟机规范把方法区描述为堆的一个逻辑部分，但是它却有一个别名叫做 Non-Heap（非堆），目的应该是与 Java 堆区分开来。\n\nJava 虚拟机规范对方法区的限制非常宽松，除了和 Java 堆一样不需要连续的内存和可以选择固定大小或者可扩展外，还可以选择不实现垃圾收集。垃圾收集行为在这个区域是比较少出现的，其内存回收目标主要是针对常量池的回收和对类型的卸载。当方法区无法满足内存分配需求时，将抛出 OutOfMemoryError 异常。\n\nJDK8 之前，Hotspot 中方法区的实现是永久代（Perm），JDK8 开始使用元空间（Metaspace），以前永久代所有内容的字符串常量移至堆内存，其他内容移至元空间，元空间直接在本地内存分配。\n\n为什么要使用元空间取代永久代的实现？\n\n字符串存在永久代中，容易出现性能问题和内存溢出。\n类及方法的信息等比较难确定其大小，因此对于永久代的大小指定比较困难，太小容易出现永久代溢出，太大则容易导致老年代溢出。\n永久代会为 GC 带来不必要的复杂度，并且回收效率偏低。\n将 HotSpot 与 JRockit 合二为一。\n\n\n\n运行时常量池\n\n运行时常量池（Runtime Constant Pool）是方法区的一部分。Class 文件中除了有类的版本、字段、方法、接口等描述信息外，还有一项信息是常量池（Constant Pool Table），用于存放编译期生成的各种字面量和符号引用，这部分内容将在类加载后进入方法区的运行时常量池中存放。\n\n一般来说，除了保存 Class 文件中描述的符号引用外，还会把翻译出来的直接引用也存储在运行时常量池中。\n\n运行时常量池相对于 Class 文件常量池的另外一个重要特征是具备动态性，Java 语言并不要求常量一定只有编译期才能产生，也就是并非预置入 Class 文件中常量池的内容才能进入方法区运行时常量池，运行期间也可能将新的常量放入池中，这种特性被开发人员利用得比较多的便是 String 类的 intern() 方法。\n\n既然运行时常量池是方法区的一部分，自然受到方法区内存的限制，当常量池无法再申请到内存时会抛出 OutOfMemoryError 异常。\n\n直接内存\n\n直接内存（Direct Memory）并不是虚拟机运行时数据区的一部分，也不是 Java 虚拟机规范中定义的内存区域。\n\n在 JDK 1.4 中新加入了 NIO，引入了一种基于通道（Channel）与缓冲区（Buffer）的 I/O 方式，它可以使用 Native 函数库直接分配堆外内存，然后通过一个存储在 Java 堆中的 DirectByteBuffer 对象作为这块内存的引用进行操作。这样能在一些场景中显著提高性能，因为避免了在 Java 堆和 Native 堆中来回复制数据。\n\n显然，本机直接内存的分配不会受到 Java 堆大小的限制，但是，既然是内存，肯定还是会受到本机总内存（包括 RAM 以及 SWAP 区或者分页文件）大小以及处理器寻址空间的限制。服务器管理员在配置虚拟机参数时，会根据实际内存设置 -Xmx 等参数信息，但经常忽略直接内存，使得各个内存区域总和大于物理内存限制（包括物理的和操作系统级的限制），从而导致动态扩展时出现 OutOfMemoryError 异常。\n\n//todo\n\n疑问1：是执行native方法时才没有OOM还是所有方法计数器都没有OOM？\n\n疑问2：JVM堆中方法区jdk8使用元数据的原因以及产生有点的原理？\n\n疑问3：直接内存的使用场景？\n","source":"_posts/Java学习-内存区域.md","raw":"---\ntitle: Java学习-内存区域\ncategories:\n  - Java\ntags:\n  - 内存区域\ndate: 2020-02-03 16:12:21\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 进入正题](#3-2进入正题)\n\n## 1.缘由\n\n巩固Java知识图谱\n\n## 2.目的\n\n强化基础，避免大楼不稳\n\n## 3.具体实施\n\n### 3.1事前准备\n\n注意区别于内存模型，JMM即内存模型，是指线程和主内存之前的抽象关系，定义了JVM在RAM中的工作方式，用于并发编程。\n\n内存区域指的是JVM运行时将数据分区域存储，是对内存空间的划分。\n\n### 3.2进入正题\n\njdk8之后JVM内存区域有几大块：\n\n* 本地方法栈(Native Method Stacks)\n* 程序计数器(Program Counter Register)\n* 虚拟机栈(JVM Stacks)\n* 虚拟机堆(JVM Heap)\n* 元数据区(Metaspace)\n\n### 3.2.1本地方法栈\n\n\n为虚拟机使用到的native方法服务，Sun HotSpot虚拟机把本地方法栈和虚拟机栈合二为一，都会跑出对应SOF、OOM异常。\n\n由于是调用操作系统特性功能，复用非Java代码，所以不受JVM约束，可以通过JNI来访问运行时的数据区，或调用寄存器等，不过使用JNI同样会使得系统丧失跨平台特性。\n\n### 3.2.2程序计数器\n\n程序计数器是一块较小的内存空间，可以看作为当前线程所执行的字节码的行号指示器。\n\n值得一提的是JVM的多线程是通过线程轮流切换并分配处理器执行时间的方式来实现的，在任何一个确定的时刻，一个处理器内核都只会执行一条线程中的指令。因此，为了线程切换后能恢复到正确的执行位置，每条线程都需要有一个独立的程序计数器，各条线程之间计数器互不影响，独立存储，这类内存区域为\"线程私有\"的内存。\n\n若线程执行的是一个Native方法，这个计数器值则为空(Undefined)。此内存区域是唯一一个在JVM中没有规定OOM的区域。\n\n### 3.2.3虚拟机栈\n\n和程序计数器一样，为线程私有，生命周期于线程相同。\n\n虚拟机栈描述的是Java方法执行的内存模型：每个方法在执行的同时都会创建一个栈帧(Stack Frame,方法运行时的基础数据结构)用于存储局部变量、操作数栈、动态链接、方法出口等信息。每一个方法从调用直至执行完成的过程，就对应着一个栈帧在虚拟机栈中入栈到出栈的过程。\n\n在活动线程中，只有位于栈顶的帧才是有效的，称为当前栈帧。正在执行的方法称为当前方法，栈帧是方法运行的基本结构。在执行引擎运行时，所有指令都只能针对当前栈帧进行操作。\n\n\n1. 局部变量表\n局部变量表是存放方法参数和局部变量的区域。 局部变量没有准备阶段， 必须显式初始化。如果是非静态方法，则在 index[0] 位置上存储的是方法所属对象的实例引用，一个引用变量占 4 个字节，随后存储的是参数和局部变量。字节码指令中的 STORE 指令就是将操作栈中计算完成的局部变呈写回局部变量表的存储空间内。\n\n虚拟机栈规定了两种异常状况：如果线程请求的栈深度大于虚拟机所允许的深度，将抛出 StackOverflowError 异常；如果虚拟机栈可以动态扩展（当前大部分的 Java 虚拟机都可动态扩展），如果扩展时无法申请到足够的内存，就会抛出 OutOfMemoryError 异常。\n\n2. 操作栈\n操作栈是个初始状态为空的桶式结构栈。在方法执行过程中， 会有各种指令往\n栈中写入和提取信息。JVM 的执行引擎是基于栈的执行引擎， 其中的栈指的就是操\n作栈。字节码指令集的定义都是基于栈类型的，栈的深度在方法元信息的 stack 属性中。\n\ni++ 和 ++i 的区别：\n\ni++：从局部变量表取出 i 并压入操作栈，然后对局部变量表中的 i 自增 1，将操作栈栈顶值取出使用，最后，使用栈顶值更新局部变量表，如此线程从操作栈读到的是自增之前的值。\n++i：先对局部变量表的 i 自增 1，然后取出并压入操作栈，再将操作栈栈顶值取出使用，最后，使用栈顶值更新局部变量表，线程从操作栈读到的是自增之后的值。\n之前之所以说 i++ 不是原子操作，即使使用 volatile 修饰也不是线程安全，就是因为，可能 i 被从局部变量表（内存）取出，压入操作栈（寄存器），操作栈中自增，使用栈顶值更新局部变量表（寄存器更新写入内存），其中分为 3 步，volatile 保证可见性，保证每次从局部变量表读取的都是最新的值，但可能这 3 步可能被另一个线程的 3 步打断，产生数据互相覆盖问题，从而导致 i 的值比预期的小。\n\n3. 动态链接\n每个栈帧中包含一个在常量池中对当前方法的引用， 目的是支持方法调用过程的动态连接。\n\n4.方法返回地址\n方法执行时有两种退出情况：\n\n正常退出，即正常执行到任何方法的返回字节码指令，如 RETURN、IRETURN、ARETURN 等；\n异常退出。\n无论何种退出情况，都将返回至方法当前被调用的位置。方法退出的过程相当于弹出当前栈帧，退出可能有三种方式：\n\n返回值压入上层调用栈帧。\n异常信息抛给能够处理的栈帧。\nPC计数器指向方法调用后的下一条指令。\n\n\n### 3.2.4虚拟机堆\n\n#### Java堆\n\n对于大多数应用来说，Java 堆（Java Heap）是 Java 虚拟机所管理的内存中最大的一块。Java 堆是被所有线程共享的一块内存区域，在虚拟机启动时创建。此内存区域的唯一目的就是存放对象实例，几乎所有的对象实例都在这里分配内存。\n\n堆是垃圾收集器管理的主要区域，因此很多时候也被称做“GC堆”（Garbage Collected Heap）。从内存回收的角度来看，由于现在收集器基本都采用\n//todo\n![分代收集算法](./GC-分代收集算法.md)，所以 Java 堆中还可以细分为：新生代和老年代；再细致一点的有 Eden 空间、From Survivor 空间、To Survivor 空间等。从内存分配的角度来看，线程共享的 Java 堆中可能划分出多个线程私有的分配缓冲区（Thread Local Allocation Buffer,TLAB）。\n\nJava 堆可以处于物理上不连续的内存空间中，只要逻辑上是连续的即可，当前主流的虚拟机都是按照可扩展来实现的（通过 -Xmx 和 -Xms 控制）。如果在堆中没有内存完成实例分配，并且堆也无法再扩展时，将会抛出 OutOfMemoryError 异常。\n\n### 3.2.5元数据区\n\n#### 方法区\n\n方法区（Method Area）与 Java 堆一样，是各个线程共享的内存区域，它用于存储已被虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。虽然\nJava 虚拟机规范把方法区描述为堆的一个逻辑部分，但是它却有一个别名叫做 Non-Heap（非堆），目的应该是与 Java 堆区分开来。\n\nJava 虚拟机规范对方法区的限制非常宽松，除了和 Java 堆一样不需要连续的内存和可以选择固定大小或者可扩展外，还可以选择不实现垃圾收集。垃圾收集行为在这个区域是比较少出现的，其内存回收目标主要是针对常量池的回收和对类型的卸载。当方法区无法满足内存分配需求时，将抛出 OutOfMemoryError 异常。\n\nJDK8 之前，Hotspot 中方法区的实现是永久代（Perm），JDK8 开始使用元空间（Metaspace），以前永久代所有内容的字符串常量移至堆内存，其他内容移至元空间，元空间直接在本地内存分配。\n\n为什么要使用元空间取代永久代的实现？\n\n字符串存在永久代中，容易出现性能问题和内存溢出。\n类及方法的信息等比较难确定其大小，因此对于永久代的大小指定比较困难，太小容易出现永久代溢出，太大则容易导致老年代溢出。\n永久代会为 GC 带来不必要的复杂度，并且回收效率偏低。\n将 HotSpot 与 JRockit 合二为一。\n\n\n\n运行时常量池\n\n运行时常量池（Runtime Constant Pool）是方法区的一部分。Class 文件中除了有类的版本、字段、方法、接口等描述信息外，还有一项信息是常量池（Constant Pool Table），用于存放编译期生成的各种字面量和符号引用，这部分内容将在类加载后进入方法区的运行时常量池中存放。\n\n一般来说，除了保存 Class 文件中描述的符号引用外，还会把翻译出来的直接引用也存储在运行时常量池中。\n\n运行时常量池相对于 Class 文件常量池的另外一个重要特征是具备动态性，Java 语言并不要求常量一定只有编译期才能产生，也就是并非预置入 Class 文件中常量池的内容才能进入方法区运行时常量池，运行期间也可能将新的常量放入池中，这种特性被开发人员利用得比较多的便是 String 类的 intern() 方法。\n\n既然运行时常量池是方法区的一部分，自然受到方法区内存的限制，当常量池无法再申请到内存时会抛出 OutOfMemoryError 异常。\n\n直接内存\n\n直接内存（Direct Memory）并不是虚拟机运行时数据区的一部分，也不是 Java 虚拟机规范中定义的内存区域。\n\n在 JDK 1.4 中新加入了 NIO，引入了一种基于通道（Channel）与缓冲区（Buffer）的 I/O 方式，它可以使用 Native 函数库直接分配堆外内存，然后通过一个存储在 Java 堆中的 DirectByteBuffer 对象作为这块内存的引用进行操作。这样能在一些场景中显著提高性能，因为避免了在 Java 堆和 Native 堆中来回复制数据。\n\n显然，本机直接内存的分配不会受到 Java 堆大小的限制，但是，既然是内存，肯定还是会受到本机总内存（包括 RAM 以及 SWAP 区或者分页文件）大小以及处理器寻址空间的限制。服务器管理员在配置虚拟机参数时，会根据实际内存设置 -Xmx 等参数信息，但经常忽略直接内存，使得各个内存区域总和大于物理内存限制（包括物理的和操作系统级的限制），从而导致动态扩展时出现 OutOfMemoryError 异常。\n\n//todo\n\n疑问1：是执行native方法时才没有OOM还是所有方法计数器都没有OOM？\n\n疑问2：JVM堆中方法区jdk8使用元数据的原因以及产生有点的原理？\n\n疑问3：直接内存的使用场景？\n","slug":"Java学习-内存区域","published":1,"updated":"2020-02-10T07:35:40.255Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55g20005ogvkcef64tg3","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2进入正题\">3.2 进入正题</a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>巩固Java知识图谱</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>强化基础，避免大楼不稳</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><p>注意区别于内存模型，JMM即内存模型，是指线程和主内存之前的抽象关系，定义了JVM在RAM中的工作方式，用于并发编程。</p>\n<p>内存区域指的是JVM运行时将数据分区域存储，是对内存空间的划分。</p>\n<h3 id=\"3-2进入正题\"><a href=\"#3-2进入正题\" class=\"headerlink\" title=\"3.2进入正题\"></a>3.2进入正题</h3><p>jdk8之后JVM内存区域有几大块：</p>\n<ul>\n<li>本地方法栈(Native Method Stacks)</li>\n<li>程序计数器(Program Counter Register)</li>\n<li>虚拟机栈(JVM Stacks)</li>\n<li>虚拟机堆(JVM Heap)</li>\n<li>元数据区(Metaspace)</li>\n</ul>\n<h3 id=\"3-2-1本地方法栈\"><a href=\"#3-2-1本地方法栈\" class=\"headerlink\" title=\"3.2.1本地方法栈\"></a>3.2.1本地方法栈</h3><p>为虚拟机使用到的native方法服务，Sun HotSpot虚拟机把本地方法栈和虚拟机栈合二为一，都会跑出对应SOF、OOM异常。</p>\n<p>由于是调用操作系统特性功能，复用非Java代码，所以不受JVM约束，可以通过JNI来访问运行时的数据区，或调用寄存器等，不过使用JNI同样会使得系统丧失跨平台特性。</p>\n<h3 id=\"3-2-2程序计数器\"><a href=\"#3-2-2程序计数器\" class=\"headerlink\" title=\"3.2.2程序计数器\"></a>3.2.2程序计数器</h3><p>程序计数器是一块较小的内存空间，可以看作为当前线程所执行的字节码的行号指示器。</p>\n<p>值得一提的是JVM的多线程是通过线程轮流切换并分配处理器执行时间的方式来实现的，在任何一个确定的时刻，一个处理器内核都只会执行一条线程中的指令。因此，为了线程切换后能恢复到正确的执行位置，每条线程都需要有一个独立的程序计数器，各条线程之间计数器互不影响，独立存储，这类内存区域为”线程私有”的内存。</p>\n<p>若线程执行的是一个Native方法，这个计数器值则为空(Undefined)。此内存区域是唯一一个在JVM中没有规定OOM的区域。</p>\n<h3 id=\"3-2-3虚拟机栈\"><a href=\"#3-2-3虚拟机栈\" class=\"headerlink\" title=\"3.2.3虚拟机栈\"></a>3.2.3虚拟机栈</h3><p>和程序计数器一样，为线程私有，生命周期于线程相同。</p>\n<p>虚拟机栈描述的是Java方法执行的内存模型：每个方法在执行的同时都会创建一个栈帧(Stack Frame,方法运行时的基础数据结构)用于存储局部变量、操作数栈、动态链接、方法出口等信息。每一个方法从调用直至执行完成的过程，就对应着一个栈帧在虚拟机栈中入栈到出栈的过程。</p>\n<p>在活动线程中，只有位于栈顶的帧才是有效的，称为当前栈帧。正在执行的方法称为当前方法，栈帧是方法运行的基本结构。在执行引擎运行时，所有指令都只能针对当前栈帧进行操作。</p>\n<ol>\n<li>局部变量表<br>局部变量表是存放方法参数和局部变量的区域。 局部变量没有准备阶段， 必须显式初始化。如果是非静态方法，则在 index[0] 位置上存储的是方法所属对象的实例引用，一个引用变量占 4 个字节，随后存储的是参数和局部变量。字节码指令中的 STORE 指令就是将操作栈中计算完成的局部变呈写回局部变量表的存储空间内。</li>\n</ol>\n<p>虚拟机栈规定了两种异常状况：如果线程请求的栈深度大于虚拟机所允许的深度，将抛出 StackOverflowError 异常；如果虚拟机栈可以动态扩展（当前大部分的 Java 虚拟机都可动态扩展），如果扩展时无法申请到足够的内存，就会抛出 OutOfMemoryError 异常。</p>\n<ol start=\"2\">\n<li>操作栈<br>操作栈是个初始状态为空的桶式结构栈。在方法执行过程中， 会有各种指令往<br>栈中写入和提取信息。JVM 的执行引擎是基于栈的执行引擎， 其中的栈指的就是操<br>作栈。字节码指令集的定义都是基于栈类型的，栈的深度在方法元信息的 stack 属性中。</li>\n</ol>\n<p>i++ 和 ++i 的区别：</p>\n<p>i++：从局部变量表取出 i 并压入操作栈，然后对局部变量表中的 i 自增 1，将操作栈栈顶值取出使用，最后，使用栈顶值更新局部变量表，如此线程从操作栈读到的是自增之前的值。<br>++i：先对局部变量表的 i 自增 1，然后取出并压入操作栈，再将操作栈栈顶值取出使用，最后，使用栈顶值更新局部变量表，线程从操作栈读到的是自增之后的值。<br>之前之所以说 i++ 不是原子操作，即使使用 volatile 修饰也不是线程安全，就是因为，可能 i 被从局部变量表（内存）取出，压入操作栈（寄存器），操作栈中自增，使用栈顶值更新局部变量表（寄存器更新写入内存），其中分为 3 步，volatile 保证可见性，保证每次从局部变量表读取的都是最新的值，但可能这 3 步可能被另一个线程的 3 步打断，产生数据互相覆盖问题，从而导致 i 的值比预期的小。</p>\n<ol start=\"3\">\n<li>动态链接<br>每个栈帧中包含一个在常量池中对当前方法的引用， 目的是支持方法调用过程的动态连接。</li>\n</ol>\n<p>4.方法返回地址<br>方法执行时有两种退出情况：</p>\n<p>正常退出，即正常执行到任何方法的返回字节码指令，如 RETURN、IRETURN、ARETURN 等；<br>异常退出。<br>无论何种退出情况，都将返回至方法当前被调用的位置。方法退出的过程相当于弹出当前栈帧，退出可能有三种方式：</p>\n<p>返回值压入上层调用栈帧。<br>异常信息抛给能够处理的栈帧。<br>PC计数器指向方法调用后的下一条指令。</p>\n<h3 id=\"3-2-4虚拟机堆\"><a href=\"#3-2-4虚拟机堆\" class=\"headerlink\" title=\"3.2.4虚拟机堆\"></a>3.2.4虚拟机堆</h3><h4 id=\"Java堆\"><a href=\"#Java堆\" class=\"headerlink\" title=\"Java堆\"></a>Java堆</h4><p>对于大多数应用来说，Java 堆（Java Heap）是 Java 虚拟机所管理的内存中最大的一块。Java 堆是被所有线程共享的一块内存区域，在虚拟机启动时创建。此内存区域的唯一目的就是存放对象实例，几乎所有的对象实例都在这里分配内存。</p>\n<p>堆是垃圾收集器管理的主要区域，因此很多时候也被称做“GC堆”（Garbage Collected Heap）。从内存回收的角度来看，由于现在收集器基本都采用<br>//todo<br><img src=\"./GC-%E5%88%86%E4%BB%A3%E6%94%B6%E9%9B%86%E7%AE%97%E6%B3%95.md\" alt=\"分代收集算法\">，所以 Java 堆中还可以细分为：新生代和老年代；再细致一点的有 Eden 空间、From Survivor 空间、To Survivor 空间等。从内存分配的角度来看，线程共享的 Java 堆中可能划分出多个线程私有的分配缓冲区（Thread Local Allocation Buffer,TLAB）。</p>\n<p>Java 堆可以处于物理上不连续的内存空间中，只要逻辑上是连续的即可，当前主流的虚拟机都是按照可扩展来实现的（通过 -Xmx 和 -Xms 控制）。如果在堆中没有内存完成实例分配，并且堆也无法再扩展时，将会抛出 OutOfMemoryError 异常。</p>\n<h3 id=\"3-2-5元数据区\"><a href=\"#3-2-5元数据区\" class=\"headerlink\" title=\"3.2.5元数据区\"></a>3.2.5元数据区</h3><h4 id=\"方法区\"><a href=\"#方法区\" class=\"headerlink\" title=\"方法区\"></a>方法区</h4><p>方法区（Method Area）与 Java 堆一样，是各个线程共享的内存区域，它用于存储已被虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。虽然<br>Java 虚拟机规范把方法区描述为堆的一个逻辑部分，但是它却有一个别名叫做 Non-Heap（非堆），目的应该是与 Java 堆区分开来。</p>\n<p>Java 虚拟机规范对方法区的限制非常宽松，除了和 Java 堆一样不需要连续的内存和可以选择固定大小或者可扩展外，还可以选择不实现垃圾收集。垃圾收集行为在这个区域是比较少出现的，其内存回收目标主要是针对常量池的回收和对类型的卸载。当方法区无法满足内存分配需求时，将抛出 OutOfMemoryError 异常。</p>\n<p>JDK8 之前，Hotspot 中方法区的实现是永久代（Perm），JDK8 开始使用元空间（Metaspace），以前永久代所有内容的字符串常量移至堆内存，其他内容移至元空间，元空间直接在本地内存分配。</p>\n<p>为什么要使用元空间取代永久代的实现？</p>\n<p>字符串存在永久代中，容易出现性能问题和内存溢出。<br>类及方法的信息等比较难确定其大小，因此对于永久代的大小指定比较困难，太小容易出现永久代溢出，太大则容易导致老年代溢出。<br>永久代会为 GC 带来不必要的复杂度，并且回收效率偏低。<br>将 HotSpot 与 JRockit 合二为一。</p>\n<p>运行时常量池</p>\n<p>运行时常量池（Runtime Constant Pool）是方法区的一部分。Class 文件中除了有类的版本、字段、方法、接口等描述信息外，还有一项信息是常量池（Constant Pool Table），用于存放编译期生成的各种字面量和符号引用，这部分内容将在类加载后进入方法区的运行时常量池中存放。</p>\n<p>一般来说，除了保存 Class 文件中描述的符号引用外，还会把翻译出来的直接引用也存储在运行时常量池中。</p>\n<p>运行时常量池相对于 Class 文件常量池的另外一个重要特征是具备动态性，Java 语言并不要求常量一定只有编译期才能产生，也就是并非预置入 Class 文件中常量池的内容才能进入方法区运行时常量池，运行期间也可能将新的常量放入池中，这种特性被开发人员利用得比较多的便是 String 类的 intern() 方法。</p>\n<p>既然运行时常量池是方法区的一部分，自然受到方法区内存的限制，当常量池无法再申请到内存时会抛出 OutOfMemoryError 异常。</p>\n<p>直接内存</p>\n<p>直接内存（Direct Memory）并不是虚拟机运行时数据区的一部分，也不是 Java 虚拟机规范中定义的内存区域。</p>\n<p>在 JDK 1.4 中新加入了 NIO，引入了一种基于通道（Channel）与缓冲区（Buffer）的 I/O 方式，它可以使用 Native 函数库直接分配堆外内存，然后通过一个存储在 Java 堆中的 DirectByteBuffer 对象作为这块内存的引用进行操作。这样能在一些场景中显著提高性能，因为避免了在 Java 堆和 Native 堆中来回复制数据。</p>\n<p>显然，本机直接内存的分配不会受到 Java 堆大小的限制，但是，既然是内存，肯定还是会受到本机总内存（包括 RAM 以及 SWAP 区或者分页文件）大小以及处理器寻址空间的限制。服务器管理员在配置虚拟机参数时，会根据实际内存设置 -Xmx 等参数信息，但经常忽略直接内存，使得各个内存区域总和大于物理内存限制（包括物理的和操作系统级的限制），从而导致动态扩展时出现 OutOfMemoryError 异常。</p>\n<p>//todo</p>\n<p>疑问1：是执行native方法时才没有OOM还是所有方法计数器都没有OOM？</p>\n<p>疑问2：JVM堆中方法区jdk8使用元数据的原因以及产生有点的原理？</p>\n<p>疑问3：直接内存的使用场景？</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2进入正题\">3.2 进入正题</a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>巩固Java知识图谱</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>强化基础，避免大楼不稳</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><p>注意区别于内存模型，JMM即内存模型，是指线程和主内存之前的抽象关系，定义了JVM在RAM中的工作方式，用于并发编程。</p>\n<p>内存区域指的是JVM运行时将数据分区域存储，是对内存空间的划分。</p>\n<h3 id=\"3-2进入正题\"><a href=\"#3-2进入正题\" class=\"headerlink\" title=\"3.2进入正题\"></a>3.2进入正题</h3><p>jdk8之后JVM内存区域有几大块：</p>\n<ul>\n<li>本地方法栈(Native Method Stacks)</li>\n<li>程序计数器(Program Counter Register)</li>\n<li>虚拟机栈(JVM Stacks)</li>\n<li>虚拟机堆(JVM Heap)</li>\n<li>元数据区(Metaspace)</li>\n</ul>\n<h3 id=\"3-2-1本地方法栈\"><a href=\"#3-2-1本地方法栈\" class=\"headerlink\" title=\"3.2.1本地方法栈\"></a>3.2.1本地方法栈</h3><p>为虚拟机使用到的native方法服务，Sun HotSpot虚拟机把本地方法栈和虚拟机栈合二为一，都会跑出对应SOF、OOM异常。</p>\n<p>由于是调用操作系统特性功能，复用非Java代码，所以不受JVM约束，可以通过JNI来访问运行时的数据区，或调用寄存器等，不过使用JNI同样会使得系统丧失跨平台特性。</p>\n<h3 id=\"3-2-2程序计数器\"><a href=\"#3-2-2程序计数器\" class=\"headerlink\" title=\"3.2.2程序计数器\"></a>3.2.2程序计数器</h3><p>程序计数器是一块较小的内存空间，可以看作为当前线程所执行的字节码的行号指示器。</p>\n<p>值得一提的是JVM的多线程是通过线程轮流切换并分配处理器执行时间的方式来实现的，在任何一个确定的时刻，一个处理器内核都只会执行一条线程中的指令。因此，为了线程切换后能恢复到正确的执行位置，每条线程都需要有一个独立的程序计数器，各条线程之间计数器互不影响，独立存储，这类内存区域为”线程私有”的内存。</p>\n<p>若线程执行的是一个Native方法，这个计数器值则为空(Undefined)。此内存区域是唯一一个在JVM中没有规定OOM的区域。</p>\n<h3 id=\"3-2-3虚拟机栈\"><a href=\"#3-2-3虚拟机栈\" class=\"headerlink\" title=\"3.2.3虚拟机栈\"></a>3.2.3虚拟机栈</h3><p>和程序计数器一样，为线程私有，生命周期于线程相同。</p>\n<p>虚拟机栈描述的是Java方法执行的内存模型：每个方法在执行的同时都会创建一个栈帧(Stack Frame,方法运行时的基础数据结构)用于存储局部变量、操作数栈、动态链接、方法出口等信息。每一个方法从调用直至执行完成的过程，就对应着一个栈帧在虚拟机栈中入栈到出栈的过程。</p>\n<p>在活动线程中，只有位于栈顶的帧才是有效的，称为当前栈帧。正在执行的方法称为当前方法，栈帧是方法运行的基本结构。在执行引擎运行时，所有指令都只能针对当前栈帧进行操作。</p>\n<ol>\n<li>局部变量表<br>局部变量表是存放方法参数和局部变量的区域。 局部变量没有准备阶段， 必须显式初始化。如果是非静态方法，则在 index[0] 位置上存储的是方法所属对象的实例引用，一个引用变量占 4 个字节，随后存储的是参数和局部变量。字节码指令中的 STORE 指令就是将操作栈中计算完成的局部变呈写回局部变量表的存储空间内。</li>\n</ol>\n<p>虚拟机栈规定了两种异常状况：如果线程请求的栈深度大于虚拟机所允许的深度，将抛出 StackOverflowError 异常；如果虚拟机栈可以动态扩展（当前大部分的 Java 虚拟机都可动态扩展），如果扩展时无法申请到足够的内存，就会抛出 OutOfMemoryError 异常。</p>\n<ol start=\"2\">\n<li>操作栈<br>操作栈是个初始状态为空的桶式结构栈。在方法执行过程中， 会有各种指令往<br>栈中写入和提取信息。JVM 的执行引擎是基于栈的执行引擎， 其中的栈指的就是操<br>作栈。字节码指令集的定义都是基于栈类型的，栈的深度在方法元信息的 stack 属性中。</li>\n</ol>\n<p>i++ 和 ++i 的区别：</p>\n<p>i++：从局部变量表取出 i 并压入操作栈，然后对局部变量表中的 i 自增 1，将操作栈栈顶值取出使用，最后，使用栈顶值更新局部变量表，如此线程从操作栈读到的是自增之前的值。<br>++i：先对局部变量表的 i 自增 1，然后取出并压入操作栈，再将操作栈栈顶值取出使用，最后，使用栈顶值更新局部变量表，线程从操作栈读到的是自增之后的值。<br>之前之所以说 i++ 不是原子操作，即使使用 volatile 修饰也不是线程安全，就是因为，可能 i 被从局部变量表（内存）取出，压入操作栈（寄存器），操作栈中自增，使用栈顶值更新局部变量表（寄存器更新写入内存），其中分为 3 步，volatile 保证可见性，保证每次从局部变量表读取的都是最新的值，但可能这 3 步可能被另一个线程的 3 步打断，产生数据互相覆盖问题，从而导致 i 的值比预期的小。</p>\n<ol start=\"3\">\n<li>动态链接<br>每个栈帧中包含一个在常量池中对当前方法的引用， 目的是支持方法调用过程的动态连接。</li>\n</ol>\n<p>4.方法返回地址<br>方法执行时有两种退出情况：</p>\n<p>正常退出，即正常执行到任何方法的返回字节码指令，如 RETURN、IRETURN、ARETURN 等；<br>异常退出。<br>无论何种退出情况，都将返回至方法当前被调用的位置。方法退出的过程相当于弹出当前栈帧，退出可能有三种方式：</p>\n<p>返回值压入上层调用栈帧。<br>异常信息抛给能够处理的栈帧。<br>PC计数器指向方法调用后的下一条指令。</p>\n<h3 id=\"3-2-4虚拟机堆\"><a href=\"#3-2-4虚拟机堆\" class=\"headerlink\" title=\"3.2.4虚拟机堆\"></a>3.2.4虚拟机堆</h3><h4 id=\"Java堆\"><a href=\"#Java堆\" class=\"headerlink\" title=\"Java堆\"></a>Java堆</h4><p>对于大多数应用来说，Java 堆（Java Heap）是 Java 虚拟机所管理的内存中最大的一块。Java 堆是被所有线程共享的一块内存区域，在虚拟机启动时创建。此内存区域的唯一目的就是存放对象实例，几乎所有的对象实例都在这里分配内存。</p>\n<p>堆是垃圾收集器管理的主要区域，因此很多时候也被称做“GC堆”（Garbage Collected Heap）。从内存回收的角度来看，由于现在收集器基本都采用<br>//todo<br><img src=\"./GC-%E5%88%86%E4%BB%A3%E6%94%B6%E9%9B%86%E7%AE%97%E6%B3%95.md\" alt=\"分代收集算法\">，所以 Java 堆中还可以细分为：新生代和老年代；再细致一点的有 Eden 空间、From Survivor 空间、To Survivor 空间等。从内存分配的角度来看，线程共享的 Java 堆中可能划分出多个线程私有的分配缓冲区（Thread Local Allocation Buffer,TLAB）。</p>\n<p>Java 堆可以处于物理上不连续的内存空间中，只要逻辑上是连续的即可，当前主流的虚拟机都是按照可扩展来实现的（通过 -Xmx 和 -Xms 控制）。如果在堆中没有内存完成实例分配，并且堆也无法再扩展时，将会抛出 OutOfMemoryError 异常。</p>\n<h3 id=\"3-2-5元数据区\"><a href=\"#3-2-5元数据区\" class=\"headerlink\" title=\"3.2.5元数据区\"></a>3.2.5元数据区</h3><h4 id=\"方法区\"><a href=\"#方法区\" class=\"headerlink\" title=\"方法区\"></a>方法区</h4><p>方法区（Method Area）与 Java 堆一样，是各个线程共享的内存区域，它用于存储已被虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。虽然<br>Java 虚拟机规范把方法区描述为堆的一个逻辑部分，但是它却有一个别名叫做 Non-Heap（非堆），目的应该是与 Java 堆区分开来。</p>\n<p>Java 虚拟机规范对方法区的限制非常宽松，除了和 Java 堆一样不需要连续的内存和可以选择固定大小或者可扩展外，还可以选择不实现垃圾收集。垃圾收集行为在这个区域是比较少出现的，其内存回收目标主要是针对常量池的回收和对类型的卸载。当方法区无法满足内存分配需求时，将抛出 OutOfMemoryError 异常。</p>\n<p>JDK8 之前，Hotspot 中方法区的实现是永久代（Perm），JDK8 开始使用元空间（Metaspace），以前永久代所有内容的字符串常量移至堆内存，其他内容移至元空间，元空间直接在本地内存分配。</p>\n<p>为什么要使用元空间取代永久代的实现？</p>\n<p>字符串存在永久代中，容易出现性能问题和内存溢出。<br>类及方法的信息等比较难确定其大小，因此对于永久代的大小指定比较困难，太小容易出现永久代溢出，太大则容易导致老年代溢出。<br>永久代会为 GC 带来不必要的复杂度，并且回收效率偏低。<br>将 HotSpot 与 JRockit 合二为一。</p>\n<p>运行时常量池</p>\n<p>运行时常量池（Runtime Constant Pool）是方法区的一部分。Class 文件中除了有类的版本、字段、方法、接口等描述信息外，还有一项信息是常量池（Constant Pool Table），用于存放编译期生成的各种字面量和符号引用，这部分内容将在类加载后进入方法区的运行时常量池中存放。</p>\n<p>一般来说，除了保存 Class 文件中描述的符号引用外，还会把翻译出来的直接引用也存储在运行时常量池中。</p>\n<p>运行时常量池相对于 Class 文件常量池的另外一个重要特征是具备动态性，Java 语言并不要求常量一定只有编译期才能产生，也就是并非预置入 Class 文件中常量池的内容才能进入方法区运行时常量池，运行期间也可能将新的常量放入池中，这种特性被开发人员利用得比较多的便是 String 类的 intern() 方法。</p>\n<p>既然运行时常量池是方法区的一部分，自然受到方法区内存的限制，当常量池无法再申请到内存时会抛出 OutOfMemoryError 异常。</p>\n<p>直接内存</p>\n<p>直接内存（Direct Memory）并不是虚拟机运行时数据区的一部分，也不是 Java 虚拟机规范中定义的内存区域。</p>\n<p>在 JDK 1.4 中新加入了 NIO，引入了一种基于通道（Channel）与缓冲区（Buffer）的 I/O 方式，它可以使用 Native 函数库直接分配堆外内存，然后通过一个存储在 Java 堆中的 DirectByteBuffer 对象作为这块内存的引用进行操作。这样能在一些场景中显著提高性能，因为避免了在 Java 堆和 Native 堆中来回复制数据。</p>\n<p>显然，本机直接内存的分配不会受到 Java 堆大小的限制，但是，既然是内存，肯定还是会受到本机总内存（包括 RAM 以及 SWAP 区或者分页文件）大小以及处理器寻址空间的限制。服务器管理员在配置虚拟机参数时，会根据实际内存设置 -Xmx 等参数信息，但经常忽略直接内存，使得各个内存区域总和大于物理内存限制（包括物理的和操作系统级的限制），从而导致动态扩展时出现 OutOfMemoryError 异常。</p>\n<p>//todo</p>\n<p>疑问1：是执行native方法时才没有OOM还是所有方法计数器都没有OOM？</p>\n<p>疑问2：JVM堆中方法区jdk8使用元数据的原因以及产生有点的原理？</p>\n<p>疑问3：直接内存的使用场景？</p>\n"},{"title":"Java学习-内存模型","date":"2020-02-03T10:11:00.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 进入正题](#3-2进入正题)\n\n## 1.缘由\n\n巩固Java知识图谱\n\n## 2.目的\n\n强化基础，避免大楼不稳\n\n## 3.具体实施\n\n### 3.1事前准备\n\n注意区别于内存区域，内存区域指的是JVM运行时将数据分区域存储，是对内存空间的划分。\n\nJava内存模型(Java Memory Model)，是共享内存的并发模型，线程之间主要通过读-写共享变量（堆内存中的实例域，静态域和数组元素）来完成隐式通信。\n\nJava 内存模型（JMM）控制 Java 线程之间的通信，决定一个线程对共享变量的写入何时对另一个线程可见。\n\n### 3.2进入正题\n\n\n\n\n\n\n","source":"_posts/Java学习-内存模型.md","raw":"---\ntitle: Java学习-内存模型\ncategories:\n  - Java\ntags:\n  - 内存模型\ndate: 2020-02-03 18:11:00\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 进入正题](#3-2进入正题)\n\n## 1.缘由\n\n巩固Java知识图谱\n\n## 2.目的\n\n强化基础，避免大楼不稳\n\n## 3.具体实施\n\n### 3.1事前准备\n\n注意区别于内存区域，内存区域指的是JVM运行时将数据分区域存储，是对内存空间的划分。\n\nJava内存模型(Java Memory Model)，是共享内存的并发模型，线程之间主要通过读-写共享变量（堆内存中的实例域，静态域和数组元素）来完成隐式通信。\n\nJava 内存模型（JMM）控制 Java 线程之间的通信，决定一个线程对共享变量的写入何时对另一个线程可见。\n\n### 3.2进入正题\n\n\n\n\n\n\n","slug":"Java学习-内存模型","published":1,"updated":"2020-02-10T07:35:40.255Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55g30006ogvk04pvl4oo","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2进入正题\">3.2 进入正题</a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>巩固Java知识图谱</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>强化基础，避免大楼不稳</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><p>注意区别于内存区域，内存区域指的是JVM运行时将数据分区域存储，是对内存空间的划分。</p>\n<p>Java内存模型(Java Memory Model)，是共享内存的并发模型，线程之间主要通过读-写共享变量（堆内存中的实例域，静态域和数组元素）来完成隐式通信。</p>\n<p>Java 内存模型（JMM）控制 Java 线程之间的通信，决定一个线程对共享变量的写入何时对另一个线程可见。</p>\n<h3 id=\"3-2进入正题\"><a href=\"#3-2进入正题\" class=\"headerlink\" title=\"3.2进入正题\"></a>3.2进入正题</h3>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2进入正题\">3.2 进入正题</a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>巩固Java知识图谱</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>强化基础，避免大楼不稳</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><p>注意区别于内存区域，内存区域指的是JVM运行时将数据分区域存储，是对内存空间的划分。</p>\n<p>Java内存模型(Java Memory Model)，是共享内存的并发模型，线程之间主要通过读-写共享变量（堆内存中的实例域，静态域和数组元素）来完成隐式通信。</p>\n<p>Java 内存模型（JMM）控制 Java 线程之间的通信，决定一个线程对共享变量的写入何时对另一个线程可见。</p>\n<h3 id=\"3-2进入正题\"><a href=\"#3-2进入正题\" class=\"headerlink\" title=\"3.2进入正题\"></a>3.2进入正题</h3>"},{"title":"Shell脚本编写常用语法及注意点","date":"2019-12-13T01:56:07.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.开始吧](#3-开始吧)\n    * [3.1 Shell脚本开头](#3-1Shell脚本开头)\n\n## 1.缘由\n\n1. 在项目中写shell脚本时想当然得认为可以正常执行，却由于一些小细节，让本身可以正常执行的脚本不能执行了。\n2. 由于不是天天写shell脚本，某些常用语法有时也会忘记，故做记录。\n\n## 2.目的\n\n1. 能够快速找到自己要的常用语法\n2. 能够不被小细节打倒，让脚本更稳定\n\n## 3.开始吧\n\n### 3.1Shell脚本开头\n\n```\n#! /bin/bash\nexport $PATH\nsource /etc/profile\n```\n\n#! /bin/bash 申明脚本执行方式，屏蔽不同系统差异\n\nexport $PATH \nsource /etc/profile\n上面两句加载环境变量，防止部分指令在脚本中不生效\n\n\n","source":"_posts/Shell脚本编写常用语法及注意点.md","raw":"---\ntitle: Shell脚本编写常用语法及注意点\ncategories:\n  - Linux\ntags:\n  - Shell\ndate: 2019-12-13 09:56:07\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.开始吧](#3-开始吧)\n    * [3.1 Shell脚本开头](#3-1Shell脚本开头)\n\n## 1.缘由\n\n1. 在项目中写shell脚本时想当然得认为可以正常执行，却由于一些小细节，让本身可以正常执行的脚本不能执行了。\n2. 由于不是天天写shell脚本，某些常用语法有时也会忘记，故做记录。\n\n## 2.目的\n\n1. 能够快速找到自己要的常用语法\n2. 能够不被小细节打倒，让脚本更稳定\n\n## 3.开始吧\n\n### 3.1Shell脚本开头\n\n```\n#! /bin/bash\nexport $PATH\nsource /etc/profile\n```\n\n#! /bin/bash 申明脚本执行方式，屏蔽不同系统差异\n\nexport $PATH \nsource /etc/profile\n上面两句加载环境变量，防止部分指令在脚本中不生效\n\n\n","slug":"Shell脚本编写常用语法及注意点","published":1,"updated":"2020-02-10T07:35:40.256Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55g40007ogvkfks5q4bb","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-开始吧\">3.开始吧</a><ul>\n<li><a href=\"#3-1Shell脚本开头\">3.1 Shell脚本开头</a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><ol>\n<li>在项目中写shell脚本时想当然得认为可以正常执行，却由于一些小细节，让本身可以正常执行的脚本不能执行了。</li>\n<li>由于不是天天写shell脚本，某些常用语法有时也会忘记，故做记录。</li>\n</ol>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><ol>\n<li>能够快速找到自己要的常用语法</li>\n<li>能够不被小细节打倒，让脚本更稳定</li>\n</ol>\n<h2 id=\"3-开始吧\"><a href=\"#3-开始吧\" class=\"headerlink\" title=\"3.开始吧\"></a>3.开始吧</h2><h3 id=\"3-1Shell脚本开头\"><a href=\"#3-1Shell脚本开头\" class=\"headerlink\" title=\"3.1Shell脚本开头\"></a>3.1Shell脚本开头</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#! /bin/bash</span><br><span class=\"line\">export $PATH</span><br><span class=\"line\">source /etc/profile</span><br></pre></td></tr></table></figure>\n\n<p>#! /bin/bash 申明脚本执行方式，屏蔽不同系统差异</p>\n<p>export $PATH<br>source /etc/profile<br>上面两句加载环境变量，防止部分指令在脚本中不生效</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-开始吧\">3.开始吧</a><ul>\n<li><a href=\"#3-1Shell脚本开头\">3.1 Shell脚本开头</a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><ol>\n<li>在项目中写shell脚本时想当然得认为可以正常执行，却由于一些小细节，让本身可以正常执行的脚本不能执行了。</li>\n<li>由于不是天天写shell脚本，某些常用语法有时也会忘记，故做记录。</li>\n</ol>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><ol>\n<li>能够快速找到自己要的常用语法</li>\n<li>能够不被小细节打倒，让脚本更稳定</li>\n</ol>\n<h2 id=\"3-开始吧\"><a href=\"#3-开始吧\" class=\"headerlink\" title=\"3.开始吧\"></a>3.开始吧</h2><h3 id=\"3-1Shell脚本开头\"><a href=\"#3-1Shell脚本开头\" class=\"headerlink\" title=\"3.1Shell脚本开头\"></a>3.1Shell脚本开头</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#! /bin/bash</span><br><span class=\"line\">export $PATH</span><br><span class=\"line\">source /etc/profile</span><br></pre></td></tr></table></figure>\n\n<p>#! /bin/bash 申明脚本执行方式，屏蔽不同系统差异</p>\n<p>export $PATH<br>source /etc/profile<br>上面两句加载环境变量，防止部分指令在脚本中不生效</p>\n"},{"title":"Spring-Cloud基础微服务搭建(springboot2)","date":"2019-10-20T09:15:54.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-目的)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n\t\t* [3.2.1 使用maven打包各服务](#3-2-1使用maven打包各服务)\n\t\t* [3.2.2 按照一定顺序启动各服务](#3-2-2按照一定顺序启动各服务)\n* [4.相关说明](#4-相关说明)\n* [5.FQA](#5-FQA)\n\n## 1.缘由\n\n之前写过springboot1的简单服务搭建，这次完善一下springboot2的搭建方式。\n\n之前写的springboot1是采用两台虚拟机来做的，本次使用单机不同端口来做，可用于测试环境。需要多节点的可以移步[springboot1](https://fiendoghx.github.io/2019/10/16/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA/)\n\n## 2.目的\n\n能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。\n\n## 3.具体实施\n\nspring-boot版本：2.1.9.RELEASE\n\n## 3.1事前准备\n\n[Jdk8](https://www.oracle.com/technetwork/java/archive-139210.html)\n* 开发环境工具：\n[maven3+](https://maven.apache.org/) \\ [Git](https://git-scm.com/)\n* spring-cloud-frame工程: \n[下载demo工程](https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot2)\n\nPS: demo工程配置了哪些内容：\n1. 网关服务和具体服务访问eureka注册中心Security用户名密码校验\n2. 服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置\n3. 网关服务的总连接数，路由连接数及采用策略配置\n4. 各服务于注册中心的心跳和续约时间，超期及时剔除服务配置\n5. 配置了logback日志info于warn、error分开按日期存放\n\n服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备\n\n## 3.2实施并验证\n\n### 3.2.1使用maven打包各服务\n\n```\n#打包注册中心Eureka:\ncd <下载的目录>/spring-cloud-frame/base-eureka\nmvn install\n#打包网关Zuul\ncd <下载的目录>/spring-cloud-frame/base-zuul\nmvn install\n#打包HelloWorld服务\ncd <下载的目录>/spring-cloud-frame/service-helloworld\nmvn install\n```\n\n### 3.2.2 按照一定顺序启动各服务\n\njava -jar base-eureka-1.0.jar\njava -jar base-gateway-1.0.jar\njava -jar service-helloworld-1.0.jar\n\n### 3.2.3 访问接口验证\n\n直接访问接口 http://127.0.0.1:13001/helloworld\n\n通过gateway网关访问接口 http://127.0.0.1:12002/SERVICE-HELLOWORLD/helloworld\n\n\n","source":"_posts/Spring-Cloud基础微服务搭建-springboot2.md","raw":"---\ntitle: Spring-Cloud基础微服务搭建(springboot2)\ndate: 2019-10-20 17:15:54\ncategories:\n- Java\ntags:\n- spring-cloud\n- 微服务\n- 框架搭建\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-目的)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n\t\t* [3.2.1 使用maven打包各服务](#3-2-1使用maven打包各服务)\n\t\t* [3.2.2 按照一定顺序启动各服务](#3-2-2按照一定顺序启动各服务)\n* [4.相关说明](#4-相关说明)\n* [5.FQA](#5-FQA)\n\n## 1.缘由\n\n之前写过springboot1的简单服务搭建，这次完善一下springboot2的搭建方式。\n\n之前写的springboot1是采用两台虚拟机来做的，本次使用单机不同端口来做，可用于测试环境。需要多节点的可以移步[springboot1](https://fiendoghx.github.io/2019/10/16/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA/)\n\n## 2.目的\n\n能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。\n\n## 3.具体实施\n\nspring-boot版本：2.1.9.RELEASE\n\n## 3.1事前准备\n\n[Jdk8](https://www.oracle.com/technetwork/java/archive-139210.html)\n* 开发环境工具：\n[maven3+](https://maven.apache.org/) \\ [Git](https://git-scm.com/)\n* spring-cloud-frame工程: \n[下载demo工程](https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot2)\n\nPS: demo工程配置了哪些内容：\n1. 网关服务和具体服务访问eureka注册中心Security用户名密码校验\n2. 服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置\n3. 网关服务的总连接数，路由连接数及采用策略配置\n4. 各服务于注册中心的心跳和续约时间，超期及时剔除服务配置\n5. 配置了logback日志info于warn、error分开按日期存放\n\n服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备\n\n## 3.2实施并验证\n\n### 3.2.1使用maven打包各服务\n\n```\n#打包注册中心Eureka:\ncd <下载的目录>/spring-cloud-frame/base-eureka\nmvn install\n#打包网关Zuul\ncd <下载的目录>/spring-cloud-frame/base-zuul\nmvn install\n#打包HelloWorld服务\ncd <下载的目录>/spring-cloud-frame/service-helloworld\nmvn install\n```\n\n### 3.2.2 按照一定顺序启动各服务\n\njava -jar base-eureka-1.0.jar\njava -jar base-gateway-1.0.jar\njava -jar service-helloworld-1.0.jar\n\n### 3.2.3 访问接口验证\n\n直接访问接口 http://127.0.0.1:13001/helloworld\n\n通过gateway网关访问接口 http://127.0.0.1:12002/SERVICE-HELLOWORLD/helloworld\n\n\n","slug":"Spring-Cloud基础微服务搭建-springboot2","published":1,"updated":"2020-02-10T07:35:40.256Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55g5000aogvkncfc1dda","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-目的\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a><ul>\n<li><a href=\"#3-2-1使用maven打包各服务\">3.2.1 使用maven打包各服务</a></li>\n<li><a href=\"#3-2-2按照一定顺序启动各服务\">3.2.2 按照一定顺序启动各服务</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#4-相关说明\">4.相关说明</a></li>\n<li><a href=\"#5-FQA\">5.FQA</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>之前写过springboot1的简单服务搭建，这次完善一下springboot2的搭建方式。</p>\n<p>之前写的springboot1是采用两台虚拟机来做的，本次使用单机不同端口来做，可用于测试环境。需要多节点的可以移步<a href=\"https://fiendoghx.github.io/2019/10/16/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA/\">springboot1</a></p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><p>spring-boot版本：2.1.9.RELEASE</p>\n<h2 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h2><p><a href=\"https://www.oracle.com/technetwork/java/archive-139210.html\" target=\"_blank\" rel=\"noopener\">Jdk8</a></p>\n<ul>\n<li>开发环境工具：<br><a href=\"https://maven.apache.org/\" target=\"_blank\" rel=\"noopener\">maven3+</a> \\ <a href=\"https://git-scm.com/\" target=\"_blank\" rel=\"noopener\">Git</a></li>\n<li>spring-cloud-frame工程:<br><a href=\"https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot2\" target=\"_blank\" rel=\"noopener\">下载demo工程</a></li>\n</ul>\n<p>PS: demo工程配置了哪些内容：</p>\n<ol>\n<li>网关服务和具体服务访问eureka注册中心Security用户名密码校验</li>\n<li>服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置</li>\n<li>网关服务的总连接数，路由连接数及采用策略配置</li>\n<li>各服务于注册中心的心跳和续约时间，超期及时剔除服务配置</li>\n<li>配置了logback日志info于warn、error分开按日期存放</li>\n</ol>\n<p>服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备</p>\n<h2 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h2><h3 id=\"3-2-1使用maven打包各服务\"><a href=\"#3-2-1使用maven打包各服务\" class=\"headerlink\" title=\"3.2.1使用maven打包各服务\"></a>3.2.1使用maven打包各服务</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#打包注册中心Eureka:</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-eureka</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包网关Zuul</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-zuul</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包HelloWorld服务</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/service-helloworld</span><br><span class=\"line\">mvn install</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2-2-按照一定顺序启动各服务\"><a href=\"#3-2-2-按照一定顺序启动各服务\" class=\"headerlink\" title=\"3.2.2 按照一定顺序启动各服务\"></a>3.2.2 按照一定顺序启动各服务</h3><p>java -jar base-eureka-1.0.jar<br>java -jar base-gateway-1.0.jar<br>java -jar service-helloworld-1.0.jar</p>\n<h3 id=\"3-2-3-访问接口验证\"><a href=\"#3-2-3-访问接口验证\" class=\"headerlink\" title=\"3.2.3 访问接口验证\"></a>3.2.3 访问接口验证</h3><p>直接访问接口 <a href=\"http://127.0.0.1:13001/helloworld\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1:13001/helloworld</a></p>\n<p>通过gateway网关访问接口 <a href=\"http://127.0.0.1:12002/SERVICE-HELLOWORLD/helloworld\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1:12002/SERVICE-HELLOWORLD/helloworld</a></p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-目的\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a><ul>\n<li><a href=\"#3-2-1使用maven打包各服务\">3.2.1 使用maven打包各服务</a></li>\n<li><a href=\"#3-2-2按照一定顺序启动各服务\">3.2.2 按照一定顺序启动各服务</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#4-相关说明\">4.相关说明</a></li>\n<li><a href=\"#5-FQA\">5.FQA</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>之前写过springboot1的简单服务搭建，这次完善一下springboot2的搭建方式。</p>\n<p>之前写的springboot1是采用两台虚拟机来做的，本次使用单机不同端口来做，可用于测试环境。需要多节点的可以移步<a href=\"https://fiendoghx.github.io/2019/10/16/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA/\">springboot1</a></p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><p>spring-boot版本：2.1.9.RELEASE</p>\n<h2 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h2><p><a href=\"https://www.oracle.com/technetwork/java/archive-139210.html\" target=\"_blank\" rel=\"noopener\">Jdk8</a></p>\n<ul>\n<li>开发环境工具：<br><a href=\"https://maven.apache.org/\" target=\"_blank\" rel=\"noopener\">maven3+</a> \\ <a href=\"https://git-scm.com/\" target=\"_blank\" rel=\"noopener\">Git</a></li>\n<li>spring-cloud-frame工程:<br><a href=\"https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot2\" target=\"_blank\" rel=\"noopener\">下载demo工程</a></li>\n</ul>\n<p>PS: demo工程配置了哪些内容：</p>\n<ol>\n<li>网关服务和具体服务访问eureka注册中心Security用户名密码校验</li>\n<li>服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置</li>\n<li>网关服务的总连接数，路由连接数及采用策略配置</li>\n<li>各服务于注册中心的心跳和续约时间，超期及时剔除服务配置</li>\n<li>配置了logback日志info于warn、error分开按日期存放</li>\n</ol>\n<p>服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备</p>\n<h2 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h2><h3 id=\"3-2-1使用maven打包各服务\"><a href=\"#3-2-1使用maven打包各服务\" class=\"headerlink\" title=\"3.2.1使用maven打包各服务\"></a>3.2.1使用maven打包各服务</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#打包注册中心Eureka:</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-eureka</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包网关Zuul</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-zuul</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包HelloWorld服务</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/service-helloworld</span><br><span class=\"line\">mvn install</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2-2-按照一定顺序启动各服务\"><a href=\"#3-2-2-按照一定顺序启动各服务\" class=\"headerlink\" title=\"3.2.2 按照一定顺序启动各服务\"></a>3.2.2 按照一定顺序启动各服务</h3><p>java -jar base-eureka-1.0.jar<br>java -jar base-gateway-1.0.jar<br>java -jar service-helloworld-1.0.jar</p>\n<h3 id=\"3-2-3-访问接口验证\"><a href=\"#3-2-3-访问接口验证\" class=\"headerlink\" title=\"3.2.3 访问接口验证\"></a>3.2.3 访问接口验证</h3><p>直接访问接口 <a href=\"http://127.0.0.1:13001/helloworld\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1:13001/helloworld</a></p>\n<p>通过gateway网关访问接口 <a href=\"http://127.0.0.1:12002/SERVICE-HELLOWORLD/helloworld\" target=\"_blank\" rel=\"noopener\">http://127.0.0.1:12002/SERVICE-HELLOWORLD/helloworld</a></p>\n"},{"title":"Spring-Cloud基础微服务搭建(springboot1)","date":"2019-10-16T02:09:55.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-目的)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n\t\t* [3.2.1 设置虚机dns](#3-2-1设置虚机dns)\n\t\t* [3.2.2 使用maven打包各服务](#3-2-2使用maven打包各服务)\n\t\t* [3.2.3 按照一定顺序执行run.sh](#3-2-3按照一定顺序执行run-sh)\n\t\t\t* [3.2.3.1 启动注册中心](#3-2-3-1启动注册中心)\n\t\t\t* [3.2.3.2 启动Zuul网关](#3-2-3-2启动Zuul网关)\n\t\t\t* [3.2.3.3 启动HelloWorld服务](#3-2-3-3启动HelloWorld服务)\n* [4.相关说明](#4-相关说明)\n* [5.FQA](#5-FQA)\n\n## 1.缘由\n\n\n身边有小伙伴需要一套spring-cloud微服务基础服务搭建的方法，自己也需要重新整理一下今年遇到的一些问题\n\n## 2.目的\n\n能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。\n\n## 3.具体实施\n\nspring-boot版本：1.5.19.RELEASE\n\n## 3.1事前准备\n\n* centos虚拟服务器2台: 192.168.1.150/151 \n[centos_download](https://wiki.centos.org/Download)\n* centos虚拟服务器 \n[Jdk8](https://www.oracle.com/technetwork/java/archive-139210.html)\n* 开发环境工具：\n[maven3+](https://maven.apache.org/) \\ [Git](https://git-scm.com/)\n* spring-cloud-frame工程: \n[下载demo工程](https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot1)\n\nPS: demo工程配置了哪些内容：\n1. 网关服务和具体服务访问eureka注册中心Security用户名密码校验\n2. 服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置\n3. 网关服务的总连接数，路由连接数及采用策略配置\n4. 各服务于注册中心的心跳和续约时间，超期及时剔除服务配置\n5. 配置了logback日志info于warn、error分开按日期存放\n\n服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备\n\n## 3.2实施并验证\n\n### 3.2.1设置虚机dns\n\n```\n#分别在每个虚机使用root用户执行\ncat >> /etc/hosts << EOF\n192.168.1.150 spring-cloud-01\n192.168.1.151 spring-cloud-02\nEOF\n```\n\n### 3.2.2使用maven打包各服务\n\n```\n#打包注册中心Eureka:\ncd <下载的目录>/spring-cloud-frame/base-eureka\nmvn install\n#打包网关Zuul\ncd <下载的目录>/spring-cloud-frame/base-zuul\nmvn install\n#打包HelloWorld服务\ncd <下载的目录>/spring-cloud-frame/service-helloworld\nmvn install\n```\n\n以上步骤能得到base-eureka-1.0.jar/base-zuul-1.0.jar/service-helloworld-1.0.jar三个jar包\n\n把对应的jar包上传到对应resource目录,工程中的可执行文件run.sh上传到bin目录\n\n```\n#分别在每个虚机创建对应目录\nmkdir -p /home/fiendo/spring-cloud-frame/eureka/resource\nmkdir -p /home/fiendo/spring-cloud-frame/eureka/bin\nmkdir -p /home/fiendo/spring-cloud-frame/zuul/resource\nmkdir -p /home/fiendo/spring-cloud-frame/zuul/bin\nmkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/resource\nmkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/bin\n```\n\n**采用scp命令把各个基础jar包传到准备好的虚机上，目录保持一致**\n\n```\nscp /home/fiendo/spring-cloud-frame/eureka/resource/base-eureka-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/resource\nscp /home/fiendo/spring-cloud-frame/zuul/resource/base-zuul-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/resource\nscp /home/fiendo/spring-cloud-frame/service-helloworld/resource/service-helloworld-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/resource\n```\n\n**用root给各个虚机上run.sh加上可执行权限**\n\n```\nchmod +x /home/fiendo/spring-cloud-frame/eureka/bin/run.sh\nchmod +x /home/fiendo/spring-cloud-frame/zuul/bin/run.sh\nchmod +x /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh\n```\n\n**解决windows环境下run.sh出现的编码问题**\n\n```\n#直接执行./run.sh会由于windows下回车的编码问题报错，采用sed命令替换处理后可正常执行\nsed -i 's/\\r//' /home/fiendo/spring-cloud-frame/eureka/bin/run.sh\nsed -i 's/\\r//' /home/fiendo/spring-cloud-frame/zuul/bin/run.sh\nsed -i 's/\\r//' /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh\n```\n\n**采用scp命令把处理ok的可执行文件传到其他节点**\n\n```\nscp /home/fiendo/spring-cloud-frame/eureka/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/bin\nscp /home/fiendo/spring-cloud-frame/zuul/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/bin\nscp /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/bin\n```\n\n### 3.2.3按照一定顺序执行run.sh\n\n### 3.2.3.1启动注册中心\n\n**对不同虚机的eureka目录run.sh进行编辑**\n\n确定虚机对应的server文件\n\n|参数  | 说明 |\n| :----------:| :-----------:| \n|spring-cloud-01   |[server1](https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server1.yml)      |\n|spring-cloud-02   |[server2](https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server2.yml)      |\n\n```\n#登陆spring-cloud-01启动eureka\ncd /home/fiendo/spring-cloud-frame/eureka/bin\n./run.sh start --spring.profiles.active=server1\n#登陆spring-cloud-02启动eureka\ncd /home/fiendo/spring-cloud-frame/eureka/bin\n./run.sh start --spring.profiles.active=server2\n```\n\n**验证结果**\n\n登陆server1的[Eureka](http://192.168.1.150:12001/)，由于配置了Security，需要用户名密码，可以在配置文件查看 [点击查看](https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/application.yml)\n\n若无异常会看到有两个Eureka节点已经启动\n\n![Eureka](/img/article/springcloudeureka01.png)\n\n### 3.2.3.2启动Zuul网关\n\n**登陆各虚机启动Zuul**\n\n```\n#登陆spring-cloud-01启动zuul\ncd /home/fiendo/spring-cloud-frame/zuul/bin\n./run.sh start\n#登陆spring-cloud-02启动zuul\ncd /home/fiendo/spring-cloud-frame/zuul/bin\n./run.sh start\n```\n\n**验证结果**\n\n若无异常会看到有两个Zuul节点已经启动\n\n![Eureka](/img/article/springcloudzuul01.png)\n\n### 3.2.3.3启动HelloWorld服务\n\n```\n#登陆spring-cloud-01启动service-helloworld\ncd /home/fiendo/spring-cloud-frame/service-helloworld/bin\n./run.sh start\n#登陆spring-cloud-02启动service-helloworld\ncd /home/fiendo/spring-cloud-frame/service-helloworld/bin\n./run.sh start\n```\n\n**验证结果**\n\n若无异常会看到有两个service-helloworld节点已经启动\n\n![Eureka](/img/article/springcloudhelloworld01.png)\n\n**通过Zuul网关访问Hello-World微服务**\n\n本文采用Zuul网关来控制各个服务的访问，路由采用默认配置，也就是说访问url为：http://<网关host>/<服务名>/<api>\n\n访问具体服务 http://192.168.1.150:12002/service-helloworld/helloworld\n\n![HelloWorld](/img/article/springcloudhelloworld02.png)\n\n**至此我们就已经搭建完毕一套分布式的微服务基础框架**\n\n## 4.相关说明</h2>\n\n本文基于springboot1搭建的微服务，最初spring-cloud官方给出的方案就是eureka+zuul,本文也是根据最初的方案进行搭建。直到spring-boot2之后迟迟等不到zuul2的更新，才开始出现的gateway，具体springboot2搭建，移步[传送门](https://fiendoghx.github.io/2019/10/20/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA-springboot2/)\n\n## 5.FQA\n\n### 5.1Eureka在不同虚机为什么要采用不同配置?\n\n由于注册中心本身是相互注册的，不会注册到自己本身，所以不同配置其实是除去了自身，添加其他的注册中心地址而已，类似Zookeeper。\n\n**非常欢迎提问，所有的提问会总结写入FQA之中**","source":"_posts/Spring-Cloud基础微服务搭建.md","raw":"---\ntitle: Spring-Cloud基础微服务搭建(springboot1)\ndate: 2019-10-16 10:09:55\ncategories:\n- Java\ntags:\n- spring-cloud\n- 微服务\n- 框架搭建\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-目的)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n\t\t* [3.2.1 设置虚机dns](#3-2-1设置虚机dns)\n\t\t* [3.2.2 使用maven打包各服务](#3-2-2使用maven打包各服务)\n\t\t* [3.2.3 按照一定顺序执行run.sh](#3-2-3按照一定顺序执行run-sh)\n\t\t\t* [3.2.3.1 启动注册中心](#3-2-3-1启动注册中心)\n\t\t\t* [3.2.3.2 启动Zuul网关](#3-2-3-2启动Zuul网关)\n\t\t\t* [3.2.3.3 启动HelloWorld服务](#3-2-3-3启动HelloWorld服务)\n* [4.相关说明](#4-相关说明)\n* [5.FQA](#5-FQA)\n\n## 1.缘由\n\n\n身边有小伙伴需要一套spring-cloud微服务基础服务搭建的方法，自己也需要重新整理一下今年遇到的一些问题\n\n## 2.目的\n\n能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。\n\n## 3.具体实施\n\nspring-boot版本：1.5.19.RELEASE\n\n## 3.1事前准备\n\n* centos虚拟服务器2台: 192.168.1.150/151 \n[centos_download](https://wiki.centos.org/Download)\n* centos虚拟服务器 \n[Jdk8](https://www.oracle.com/technetwork/java/archive-139210.html)\n* 开发环境工具：\n[maven3+](https://maven.apache.org/) \\ [Git](https://git-scm.com/)\n* spring-cloud-frame工程: \n[下载demo工程](https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot1)\n\nPS: demo工程配置了哪些内容：\n1. 网关服务和具体服务访问eureka注册中心Security用户名密码校验\n2. 服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置\n3. 网关服务的总连接数，路由连接数及采用策略配置\n4. 各服务于注册中心的心跳和续约时间，超期及时剔除服务配置\n5. 配置了logback日志info于warn、error分开按日期存放\n\n服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备\n\n## 3.2实施并验证\n\n### 3.2.1设置虚机dns\n\n```\n#分别在每个虚机使用root用户执行\ncat >> /etc/hosts << EOF\n192.168.1.150 spring-cloud-01\n192.168.1.151 spring-cloud-02\nEOF\n```\n\n### 3.2.2使用maven打包各服务\n\n```\n#打包注册中心Eureka:\ncd <下载的目录>/spring-cloud-frame/base-eureka\nmvn install\n#打包网关Zuul\ncd <下载的目录>/spring-cloud-frame/base-zuul\nmvn install\n#打包HelloWorld服务\ncd <下载的目录>/spring-cloud-frame/service-helloworld\nmvn install\n```\n\n以上步骤能得到base-eureka-1.0.jar/base-zuul-1.0.jar/service-helloworld-1.0.jar三个jar包\n\n把对应的jar包上传到对应resource目录,工程中的可执行文件run.sh上传到bin目录\n\n```\n#分别在每个虚机创建对应目录\nmkdir -p /home/fiendo/spring-cloud-frame/eureka/resource\nmkdir -p /home/fiendo/spring-cloud-frame/eureka/bin\nmkdir -p /home/fiendo/spring-cloud-frame/zuul/resource\nmkdir -p /home/fiendo/spring-cloud-frame/zuul/bin\nmkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/resource\nmkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/bin\n```\n\n**采用scp命令把各个基础jar包传到准备好的虚机上，目录保持一致**\n\n```\nscp /home/fiendo/spring-cloud-frame/eureka/resource/base-eureka-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/resource\nscp /home/fiendo/spring-cloud-frame/zuul/resource/base-zuul-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/resource\nscp /home/fiendo/spring-cloud-frame/service-helloworld/resource/service-helloworld-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/resource\n```\n\n**用root给各个虚机上run.sh加上可执行权限**\n\n```\nchmod +x /home/fiendo/spring-cloud-frame/eureka/bin/run.sh\nchmod +x /home/fiendo/spring-cloud-frame/zuul/bin/run.sh\nchmod +x /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh\n```\n\n**解决windows环境下run.sh出现的编码问题**\n\n```\n#直接执行./run.sh会由于windows下回车的编码问题报错，采用sed命令替换处理后可正常执行\nsed -i 's/\\r//' /home/fiendo/spring-cloud-frame/eureka/bin/run.sh\nsed -i 's/\\r//' /home/fiendo/spring-cloud-frame/zuul/bin/run.sh\nsed -i 's/\\r//' /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh\n```\n\n**采用scp命令把处理ok的可执行文件传到其他节点**\n\n```\nscp /home/fiendo/spring-cloud-frame/eureka/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/bin\nscp /home/fiendo/spring-cloud-frame/zuul/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/bin\nscp /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/bin\n```\n\n### 3.2.3按照一定顺序执行run.sh\n\n### 3.2.3.1启动注册中心\n\n**对不同虚机的eureka目录run.sh进行编辑**\n\n确定虚机对应的server文件\n\n|参数  | 说明 |\n| :----------:| :-----------:| \n|spring-cloud-01   |[server1](https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server1.yml)      |\n|spring-cloud-02   |[server2](https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server2.yml)      |\n\n```\n#登陆spring-cloud-01启动eureka\ncd /home/fiendo/spring-cloud-frame/eureka/bin\n./run.sh start --spring.profiles.active=server1\n#登陆spring-cloud-02启动eureka\ncd /home/fiendo/spring-cloud-frame/eureka/bin\n./run.sh start --spring.profiles.active=server2\n```\n\n**验证结果**\n\n登陆server1的[Eureka](http://192.168.1.150:12001/)，由于配置了Security，需要用户名密码，可以在配置文件查看 [点击查看](https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/application.yml)\n\n若无异常会看到有两个Eureka节点已经启动\n\n![Eureka](/img/article/springcloudeureka01.png)\n\n### 3.2.3.2启动Zuul网关\n\n**登陆各虚机启动Zuul**\n\n```\n#登陆spring-cloud-01启动zuul\ncd /home/fiendo/spring-cloud-frame/zuul/bin\n./run.sh start\n#登陆spring-cloud-02启动zuul\ncd /home/fiendo/spring-cloud-frame/zuul/bin\n./run.sh start\n```\n\n**验证结果**\n\n若无异常会看到有两个Zuul节点已经启动\n\n![Eureka](/img/article/springcloudzuul01.png)\n\n### 3.2.3.3启动HelloWorld服务\n\n```\n#登陆spring-cloud-01启动service-helloworld\ncd /home/fiendo/spring-cloud-frame/service-helloworld/bin\n./run.sh start\n#登陆spring-cloud-02启动service-helloworld\ncd /home/fiendo/spring-cloud-frame/service-helloworld/bin\n./run.sh start\n```\n\n**验证结果**\n\n若无异常会看到有两个service-helloworld节点已经启动\n\n![Eureka](/img/article/springcloudhelloworld01.png)\n\n**通过Zuul网关访问Hello-World微服务**\n\n本文采用Zuul网关来控制各个服务的访问，路由采用默认配置，也就是说访问url为：http://<网关host>/<服务名>/<api>\n\n访问具体服务 http://192.168.1.150:12002/service-helloworld/helloworld\n\n![HelloWorld](/img/article/springcloudhelloworld02.png)\n\n**至此我们就已经搭建完毕一套分布式的微服务基础框架**\n\n## 4.相关说明</h2>\n\n本文基于springboot1搭建的微服务，最初spring-cloud官方给出的方案就是eureka+zuul,本文也是根据最初的方案进行搭建。直到spring-boot2之后迟迟等不到zuul2的更新，才开始出现的gateway，具体springboot2搭建，移步[传送门](https://fiendoghx.github.io/2019/10/20/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA-springboot2/)\n\n## 5.FQA\n\n### 5.1Eureka在不同虚机为什么要采用不同配置?\n\n由于注册中心本身是相互注册的，不会注册到自己本身，所以不同配置其实是除去了自身，添加其他的注册中心地址而已，类似Zookeeper。\n\n**非常欢迎提问，所有的提问会总结写入FQA之中**","slug":"Spring-Cloud基础微服务搭建","published":1,"updated":"2020-02-10T07:35:40.256Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55g6000bogvkk5yneh37","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-目的\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a><ul>\n<li><a href=\"#3-2-1设置虚机dns\">3.2.1 设置虚机dns</a></li>\n<li><a href=\"#3-2-2使用maven打包各服务\">3.2.2 使用maven打包各服务</a></li>\n<li><a href=\"#3-2-3按照一定顺序执行run-sh\">3.2.3 按照一定顺序执行run.sh</a><ul>\n<li><a href=\"#3-2-3-1启动注册中心\">3.2.3.1 启动注册中心</a></li>\n<li><a href=\"#3-2-3-2启动Zuul网关\">3.2.3.2 启动Zuul网关</a></li>\n<li><a href=\"#3-2-3-3启动HelloWorld服务\">3.2.3.3 启动HelloWorld服务</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#4-相关说明\">4.相关说明</a></li>\n<li><a href=\"#5-FQA\">5.FQA</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>身边有小伙伴需要一套spring-cloud微服务基础服务搭建的方法，自己也需要重新整理一下今年遇到的一些问题</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><p>spring-boot版本：1.5.19.RELEASE</p>\n<h2 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h2><ul>\n<li>centos虚拟服务器2台: 192.168.1.150/151<br><a href=\"https://wiki.centos.org/Download\" target=\"_blank\" rel=\"noopener\">centos_download</a></li>\n<li>centos虚拟服务器<br><a href=\"https://www.oracle.com/technetwork/java/archive-139210.html\" target=\"_blank\" rel=\"noopener\">Jdk8</a></li>\n<li>开发环境工具：<br><a href=\"https://maven.apache.org/\" target=\"_blank\" rel=\"noopener\">maven3+</a> \\ <a href=\"https://git-scm.com/\" target=\"_blank\" rel=\"noopener\">Git</a></li>\n<li>spring-cloud-frame工程:<br><a href=\"https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot1\" target=\"_blank\" rel=\"noopener\">下载demo工程</a></li>\n</ul>\n<p>PS: demo工程配置了哪些内容：</p>\n<ol>\n<li>网关服务和具体服务访问eureka注册中心Security用户名密码校验</li>\n<li>服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置</li>\n<li>网关服务的总连接数，路由连接数及采用策略配置</li>\n<li>各服务于注册中心的心跳和续约时间，超期及时剔除服务配置</li>\n<li>配置了logback日志info于warn、error分开按日期存放</li>\n</ol>\n<p>服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备</p>\n<h2 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h2><h3 id=\"3-2-1设置虚机dns\"><a href=\"#3-2-1设置虚机dns\" class=\"headerlink\" title=\"3.2.1设置虚机dns\"></a>3.2.1设置虚机dns</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#分别在每个虚机使用root用户执行</span><br><span class=\"line\">cat &gt;&gt; /etc/hosts &lt;&lt; EOF</span><br><span class=\"line\">192.168.1.150 spring-cloud-01</span><br><span class=\"line\">192.168.1.151 spring-cloud-02</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2-2使用maven打包各服务\"><a href=\"#3-2-2使用maven打包各服务\" class=\"headerlink\" title=\"3.2.2使用maven打包各服务\"></a>3.2.2使用maven打包各服务</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#打包注册中心Eureka:</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-eureka</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包网关Zuul</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-zuul</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包HelloWorld服务</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/service-helloworld</span><br><span class=\"line\">mvn install</span><br></pre></td></tr></table></figure>\n\n<p>以上步骤能得到base-eureka-1.0.jar/base-zuul-1.0.jar/service-helloworld-1.0.jar三个jar包</p>\n<p>把对应的jar包上传到对应resource目录,工程中的可执行文件run.sh上传到bin目录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#分别在每个虚机创建对应目录</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/eureka/resource</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/zuul/resource</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/resource</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br></pre></td></tr></table></figure>\n\n<p><strong>采用scp命令把各个基础jar包传到准备好的虚机上，目录保持一致</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp /home/fiendo/spring-cloud-frame/eureka/resource/base-eureka-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/resource</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/zuul/resource/base-zuul-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/resource</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/service-helloworld/resource/service-helloworld-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/resource</span><br></pre></td></tr></table></figure>\n\n<p><strong>用root给各个虚机上run.sh加上可执行权限</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod +x /home/fiendo/spring-cloud-frame/eureka/bin/run.sh</span><br><span class=\"line\">chmod +x /home/fiendo/spring-cloud-frame/zuul/bin/run.sh</span><br><span class=\"line\">chmod +x /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh</span><br></pre></td></tr></table></figure>\n\n<p><strong>解决windows环境下run.sh出现的编码问题</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#直接执行./run.sh会由于windows下回车的编码问题报错，采用sed命令替换处理后可正常执行</span><br><span class=\"line\">sed -i &apos;s/\\r//&apos; /home/fiendo/spring-cloud-frame/eureka/bin/run.sh</span><br><span class=\"line\">sed -i &apos;s/\\r//&apos; /home/fiendo/spring-cloud-frame/zuul/bin/run.sh</span><br><span class=\"line\">sed -i &apos;s/\\r//&apos; /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh</span><br></pre></td></tr></table></figure>\n\n<p><strong>采用scp命令把处理ok的可执行文件传到其他节点</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp /home/fiendo/spring-cloud-frame/eureka/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/zuul/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2-3按照一定顺序执行run-sh\"><a href=\"#3-2-3按照一定顺序执行run-sh\" class=\"headerlink\" title=\"3.2.3按照一定顺序执行run.sh\"></a>3.2.3按照一定顺序执行run.sh</h3><h3 id=\"3-2-3-1启动注册中心\"><a href=\"#3-2-3-1启动注册中心\" class=\"headerlink\" title=\"3.2.3.1启动注册中心\"></a>3.2.3.1启动注册中心</h3><p><strong>对不同虚机的eureka目录run.sh进行编辑</strong></p>\n<p>确定虚机对应的server文件</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">参数</th>\n<th align=\"center\">说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">spring-cloud-01</td>\n<td align=\"center\"><a href=\"https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server1.yml\" target=\"_blank\" rel=\"noopener\">server1</a></td>\n</tr>\n<tr>\n<td align=\"center\">spring-cloud-02</td>\n<td align=\"center\"><a href=\"https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server2.yml\" target=\"_blank\" rel=\"noopener\">server2</a></td>\n</tr>\n</tbody></table>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#登陆spring-cloud-01启动eureka</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">./run.sh start --spring.profiles.active=server1</span><br><span class=\"line\">#登陆spring-cloud-02启动eureka</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">./run.sh start --spring.profiles.active=server2</span><br></pre></td></tr></table></figure>\n\n<p><strong>验证结果</strong></p>\n<p>登陆server1的<a href=\"http://192.168.1.150:12001/\" target=\"_blank\" rel=\"noopener\">Eureka</a>，由于配置了Security，需要用户名密码，可以在配置文件查看 <a href=\"https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/application.yml\" target=\"_blank\" rel=\"noopener\">点击查看</a></p>\n<p>若无异常会看到有两个Eureka节点已经启动</p>\n<p><img src=\"/img/article/springcloudeureka01.png\" alt=\"Eureka\"></p>\n<h3 id=\"3-2-3-2启动Zuul网关\"><a href=\"#3-2-3-2启动Zuul网关\" class=\"headerlink\" title=\"3.2.3.2启动Zuul网关\"></a>3.2.3.2启动Zuul网关</h3><p><strong>登陆各虚机启动Zuul</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#登陆spring-cloud-01启动zuul</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">./run.sh start</span><br><span class=\"line\">#登陆spring-cloud-02启动zuul</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">./run.sh start</span><br></pre></td></tr></table></figure>\n\n<p><strong>验证结果</strong></p>\n<p>若无异常会看到有两个Zuul节点已经启动</p>\n<p><img src=\"/img/article/springcloudzuul01.png\" alt=\"Eureka\"></p>\n<h3 id=\"3-2-3-3启动HelloWorld服务\"><a href=\"#3-2-3-3启动HelloWorld服务\" class=\"headerlink\" title=\"3.2.3.3启动HelloWorld服务\"></a>3.2.3.3启动HelloWorld服务</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#登陆spring-cloud-01启动service-helloworld</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br><span class=\"line\">./run.sh start</span><br><span class=\"line\">#登陆spring-cloud-02启动service-helloworld</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br><span class=\"line\">./run.sh start</span><br></pre></td></tr></table></figure>\n\n<p><strong>验证结果</strong></p>\n<p>若无异常会看到有两个service-helloworld节点已经启动</p>\n<p><img src=\"/img/article/springcloudhelloworld01.png\" alt=\"Eureka\"></p>\n<p><strong>通过Zuul网关访问Hello-World微服务</strong></p>\n<p>本文采用Zuul网关来控制各个服务的访问，路由采用默认配置，也就是说访问url为：http://&lt;网关host&gt;/&lt;服务名&gt;/<api></api></p>\n<p>访问具体服务 <a href=\"http://192.168.1.150:12002/service-helloworld/helloworld\" target=\"_blank\" rel=\"noopener\">http://192.168.1.150:12002/service-helloworld/helloworld</a></p>\n<p><img src=\"/img/article/springcloudhelloworld02.png\" alt=\"HelloWorld\"></p>\n<p><strong>至此我们就已经搭建完毕一套分布式的微服务基础框架</strong></p>\n<h2 id=\"4-相关说明\"><a href=\"#4-相关说明\" class=\"headerlink\" title=\"4.相关说明\"></a>4.相关说明</h2><p>本文基于springboot1搭建的微服务，最初spring-cloud官方给出的方案就是eureka+zuul,本文也是根据最初的方案进行搭建。直到spring-boot2之后迟迟等不到zuul2的更新，才开始出现的gateway，具体springboot2搭建，移步<a href=\"https://fiendoghx.github.io/2019/10/20/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA-springboot2/\">传送门</a></p>\n<h2 id=\"5-FQA\"><a href=\"#5-FQA\" class=\"headerlink\" title=\"5.FQA\"></a>5.FQA</h2><h3 id=\"5-1Eureka在不同虚机为什么要采用不同配置\"><a href=\"#5-1Eureka在不同虚机为什么要采用不同配置\" class=\"headerlink\" title=\"5.1Eureka在不同虚机为什么要采用不同配置?\"></a>5.1Eureka在不同虚机为什么要采用不同配置?</h3><p>由于注册中心本身是相互注册的，不会注册到自己本身，所以不同配置其实是除去了自身，添加其他的注册中心地址而已，类似Zookeeper。</p>\n<p><strong>非常欢迎提问，所有的提问会总结写入FQA之中</strong></p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-目的\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a><ul>\n<li><a href=\"#3-2-1设置虚机dns\">3.2.1 设置虚机dns</a></li>\n<li><a href=\"#3-2-2使用maven打包各服务\">3.2.2 使用maven打包各服务</a></li>\n<li><a href=\"#3-2-3按照一定顺序执行run-sh\">3.2.3 按照一定顺序执行run.sh</a><ul>\n<li><a href=\"#3-2-3-1启动注册中心\">3.2.3.1 启动注册中心</a></li>\n<li><a href=\"#3-2-3-2启动Zuul网关\">3.2.3.2 启动Zuul网关</a></li>\n<li><a href=\"#3-2-3-3启动HelloWorld服务\">3.2.3.3 启动HelloWorld服务</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#4-相关说明\">4.相关说明</a></li>\n<li><a href=\"#5-FQA\">5.FQA</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>身边有小伙伴需要一套spring-cloud微服务基础服务搭建的方法，自己也需要重新整理一下今年遇到的一些问题</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能够根据文档搭建一套简单的微服务框架，并成功访问具体微服务。</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><p>spring-boot版本：1.5.19.RELEASE</p>\n<h2 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h2><ul>\n<li>centos虚拟服务器2台: 192.168.1.150/151<br><a href=\"https://wiki.centos.org/Download\" target=\"_blank\" rel=\"noopener\">centos_download</a></li>\n<li>centos虚拟服务器<br><a href=\"https://www.oracle.com/technetwork/java/archive-139210.html\" target=\"_blank\" rel=\"noopener\">Jdk8</a></li>\n<li>开发环境工具：<br><a href=\"https://maven.apache.org/\" target=\"_blank\" rel=\"noopener\">maven3+</a> \\ <a href=\"https://git-scm.com/\" target=\"_blank\" rel=\"noopener\">Git</a></li>\n<li>spring-cloud-frame工程:<br><a href=\"https://github.com/fiendoghx/spring-cloud-frame/tree/base-springboot1\" target=\"_blank\" rel=\"noopener\">下载demo工程</a></li>\n</ul>\n<p>PS: demo工程配置了哪些内容：</p>\n<ol>\n<li>网关服务和具体服务访问eureka注册中心Security用户名密码校验</li>\n<li>服务里的负载ribbon超时重试，以及hystrix熔断配置，以及短路配置</li>\n<li>网关服务的总连接数，路由连接数及采用策略配置</li>\n<li>各服务于注册中心的心跳和续约时间，超期及时剔除服务配置</li>\n<li>配置了logback日志info于warn、error分开按日期存放</li>\n</ol>\n<p>服务器以及构建工具的事前准备不在本文讨论范围，请自行搜索准备</p>\n<h2 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h2><h3 id=\"3-2-1设置虚机dns\"><a href=\"#3-2-1设置虚机dns\" class=\"headerlink\" title=\"3.2.1设置虚机dns\"></a>3.2.1设置虚机dns</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#分别在每个虚机使用root用户执行</span><br><span class=\"line\">cat &gt;&gt; /etc/hosts &lt;&lt; EOF</span><br><span class=\"line\">192.168.1.150 spring-cloud-01</span><br><span class=\"line\">192.168.1.151 spring-cloud-02</span><br><span class=\"line\">EOF</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2-2使用maven打包各服务\"><a href=\"#3-2-2使用maven打包各服务\" class=\"headerlink\" title=\"3.2.2使用maven打包各服务\"></a>3.2.2使用maven打包各服务</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#打包注册中心Eureka:</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-eureka</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包网关Zuul</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/base-zuul</span><br><span class=\"line\">mvn install</span><br><span class=\"line\">#打包HelloWorld服务</span><br><span class=\"line\">cd &lt;下载的目录&gt;/spring-cloud-frame/service-helloworld</span><br><span class=\"line\">mvn install</span><br></pre></td></tr></table></figure>\n\n<p>以上步骤能得到base-eureka-1.0.jar/base-zuul-1.0.jar/service-helloworld-1.0.jar三个jar包</p>\n<p>把对应的jar包上传到对应resource目录,工程中的可执行文件run.sh上传到bin目录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#分别在每个虚机创建对应目录</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/eureka/resource</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/zuul/resource</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/resource</span><br><span class=\"line\">mkdir -p /home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br></pre></td></tr></table></figure>\n\n<p><strong>采用scp命令把各个基础jar包传到准备好的虚机上，目录保持一致</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp /home/fiendo/spring-cloud-frame/eureka/resource/base-eureka-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/resource</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/zuul/resource/base-zuul-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/resource</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/service-helloworld/resource/service-helloworld-1.0.jar root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/resource</span><br></pre></td></tr></table></figure>\n\n<p><strong>用root给各个虚机上run.sh加上可执行权限</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod +x /home/fiendo/spring-cloud-frame/eureka/bin/run.sh</span><br><span class=\"line\">chmod +x /home/fiendo/spring-cloud-frame/zuul/bin/run.sh</span><br><span class=\"line\">chmod +x /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh</span><br></pre></td></tr></table></figure>\n\n<p><strong>解决windows环境下run.sh出现的编码问题</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#直接执行./run.sh会由于windows下回车的编码问题报错，采用sed命令替换处理后可正常执行</span><br><span class=\"line\">sed -i &apos;s/\\r//&apos; /home/fiendo/spring-cloud-frame/eureka/bin/run.sh</span><br><span class=\"line\">sed -i &apos;s/\\r//&apos; /home/fiendo/spring-cloud-frame/zuul/bin/run.sh</span><br><span class=\"line\">sed -i &apos;s/\\r//&apos; /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh</span><br></pre></td></tr></table></figure>\n\n<p><strong>采用scp命令把处理ok的可执行文件传到其他节点</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp /home/fiendo/spring-cloud-frame/eureka/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/zuul/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">scp /home/fiendo/spring-cloud-frame/service-helloworld/bin/run.sh root@spring-cloud-02:/home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2-3按照一定顺序执行run-sh\"><a href=\"#3-2-3按照一定顺序执行run-sh\" class=\"headerlink\" title=\"3.2.3按照一定顺序执行run.sh\"></a>3.2.3按照一定顺序执行run.sh</h3><h3 id=\"3-2-3-1启动注册中心\"><a href=\"#3-2-3-1启动注册中心\" class=\"headerlink\" title=\"3.2.3.1启动注册中心\"></a>3.2.3.1启动注册中心</h3><p><strong>对不同虚机的eureka目录run.sh进行编辑</strong></p>\n<p>确定虚机对应的server文件</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">参数</th>\n<th align=\"center\">说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">spring-cloud-01</td>\n<td align=\"center\"><a href=\"https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server1.yml\" target=\"_blank\" rel=\"noopener\">server1</a></td>\n</tr>\n<tr>\n<td align=\"center\">spring-cloud-02</td>\n<td align=\"center\"><a href=\"https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/config/application-server2.yml\" target=\"_blank\" rel=\"noopener\">server2</a></td>\n</tr>\n</tbody></table>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#登陆spring-cloud-01启动eureka</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">./run.sh start --spring.profiles.active=server1</span><br><span class=\"line\">#登陆spring-cloud-02启动eureka</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/eureka/bin</span><br><span class=\"line\">./run.sh start --spring.profiles.active=server2</span><br></pre></td></tr></table></figure>\n\n<p><strong>验证结果</strong></p>\n<p>登陆server1的<a href=\"http://192.168.1.150:12001/\" target=\"_blank\" rel=\"noopener\">Eureka</a>，由于配置了Security，需要用户名密码，可以在配置文件查看 <a href=\"https://github.com/fiendoghx/spring-cloud-frame/blob/base-springboot1/base-eureka/src/main/resources/application.yml\" target=\"_blank\" rel=\"noopener\">点击查看</a></p>\n<p>若无异常会看到有两个Eureka节点已经启动</p>\n<p><img src=\"/img/article/springcloudeureka01.png\" alt=\"Eureka\"></p>\n<h3 id=\"3-2-3-2启动Zuul网关\"><a href=\"#3-2-3-2启动Zuul网关\" class=\"headerlink\" title=\"3.2.3.2启动Zuul网关\"></a>3.2.3.2启动Zuul网关</h3><p><strong>登陆各虚机启动Zuul</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#登陆spring-cloud-01启动zuul</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">./run.sh start</span><br><span class=\"line\">#登陆spring-cloud-02启动zuul</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/zuul/bin</span><br><span class=\"line\">./run.sh start</span><br></pre></td></tr></table></figure>\n\n<p><strong>验证结果</strong></p>\n<p>若无异常会看到有两个Zuul节点已经启动</p>\n<p><img src=\"/img/article/springcloudzuul01.png\" alt=\"Eureka\"></p>\n<h3 id=\"3-2-3-3启动HelloWorld服务\"><a href=\"#3-2-3-3启动HelloWorld服务\" class=\"headerlink\" title=\"3.2.3.3启动HelloWorld服务\"></a>3.2.3.3启动HelloWorld服务</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#登陆spring-cloud-01启动service-helloworld</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br><span class=\"line\">./run.sh start</span><br><span class=\"line\">#登陆spring-cloud-02启动service-helloworld</span><br><span class=\"line\">cd /home/fiendo/spring-cloud-frame/service-helloworld/bin</span><br><span class=\"line\">./run.sh start</span><br></pre></td></tr></table></figure>\n\n<p><strong>验证结果</strong></p>\n<p>若无异常会看到有两个service-helloworld节点已经启动</p>\n<p><img src=\"/img/article/springcloudhelloworld01.png\" alt=\"Eureka\"></p>\n<p><strong>通过Zuul网关访问Hello-World微服务</strong></p>\n<p>本文采用Zuul网关来控制各个服务的访问，路由采用默认配置，也就是说访问url为：http://&lt;网关host&gt;/&lt;服务名&gt;/<api></api></p>\n<p>访问具体服务 <a href=\"http://192.168.1.150:12002/service-helloworld/helloworld\" target=\"_blank\" rel=\"noopener\">http://192.168.1.150:12002/service-helloworld/helloworld</a></p>\n<p><img src=\"/img/article/springcloudhelloworld02.png\" alt=\"HelloWorld\"></p>\n<p><strong>至此我们就已经搭建完毕一套分布式的微服务基础框架</strong></p>\n<h2 id=\"4-相关说明\"><a href=\"#4-相关说明\" class=\"headerlink\" title=\"4.相关说明\"></a>4.相关说明</h2><p>本文基于springboot1搭建的微服务，最初spring-cloud官方给出的方案就是eureka+zuul,本文也是根据最初的方案进行搭建。直到spring-boot2之后迟迟等不到zuul2的更新，才开始出现的gateway，具体springboot2搭建，移步<a href=\"https://fiendoghx.github.io/2019/10/20/Spring-Cloud%E5%9F%BA%E7%A1%80%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA-springboot2/\">传送门</a></p>\n<h2 id=\"5-FQA\"><a href=\"#5-FQA\" class=\"headerlink\" title=\"5.FQA\"></a>5.FQA</h2><h3 id=\"5-1Eureka在不同虚机为什么要采用不同配置\"><a href=\"#5-1Eureka在不同虚机为什么要采用不同配置\" class=\"headerlink\" title=\"5.1Eureka在不同虚机为什么要采用不同配置?\"></a>5.1Eureka在不同虚机为什么要采用不同配置?</h3><p>由于注册中心本身是相互注册的，不会注册到自己本身，所以不同配置其实是除去了自身，添加其他的注册中心地址而已，类似Zookeeper。</p>\n<p><strong>非常欢迎提问，所有的提问会总结写入FQA之中</strong></p>\n"},{"title":"jdk8并发编程神器CompletableFuture初探","date":"2019-10-26T08:22:52.000Z","_content":"\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n\t\t* [3.2.1 并发打印helloworld](#3-2-1并发打印helloworld)\n\t\t* [3.2.2 并发协作](#3-2-2并发协作)\n* [4.为什么采用以上方式](#4-为什么采用以上方式)\n\n## 1.缘由\n\n最近在开始整理jdk8的新特性新功能。发现多线程处理这块出了一个超级好用的工具类--CompletableFuture。\n之前写并发程序总是采用Thread，Runnable，Callable等源生写法，实现起来比较复杂，稍有不慎就导致bug不断且排查困难。于是准备以几个案例来记录下CompletableFuture的大致用法。\n\n\n## 2.目的\n\n能够根据案例正确的使用CompletableFuture来解决相关并发问题。\n\n## 3.具体实施\n\n### 3.1事前准备\n\n* 了解线程基础知识\n* 了解lambda表达式\n* 了解函数式编程\n* 了解CountDownLatch\n\n### 3.2实施并验证\n\n**基础方法**\n\n|方法  | 说明 | 线程有无返回值|\n| :----------:| :-----------:| :-----------:|\n| runAsync() | 异步运行一个线程 | 无 |\n| supplyAsync() | 异步运行一个线程 | 有 |\n| thenAcceptAsync()() |以上个线程的执行结果作为参数，异步运行一个线程 | 无 |\n| thenApplyAsync()() |以上个线程的执行结果作为参数，异步运行一个线程 | 有 |\n\n\n#### 3.2.1并发打印helloworld\n\n采用CountDownLatch挂起主线程，等所有HelloWorld都打印完毕才结束\n\n```\nfinal int times = 10;\nfinal CountDownLatch countDownLatch = new CountDownLatch(times);\nfor (int i = 0; i < 10; i++) {\n\tCompletableFuture.runAsync(()->{\n\t\tSystem.out.println(\"Hello World. \" + Thread.currentThread().getName() + \": \" \n\t\t\t\t+ Thread.currentThread().getId() + \" \" + LocalTime.now());\n\t\tcountDownLatch.countDown();\n\t});\n}\ncountDownLatch.await();\n```\n\n运行可得到:\n\n```\nHello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.922\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.922\nHello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.922\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923\n```\n\n#### 3.2.2并发协作\n\n\n## 4.为什么采用以上方式\n\n\n\n\n","source":"_posts/jdk8并发编程神器CompletableFuture初探.md","raw":"---\ntitle: jdk8并发编程神器CompletableFuture初探\ndate: 2019-10-26 16:22:52\ncategories:\n- Java\ntags:\n- CompletableFuture\n- jdk8\n- 并发编程\n---\n\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n\t\t* [3.2.1 并发打印helloworld](#3-2-1并发打印helloworld)\n\t\t* [3.2.2 并发协作](#3-2-2并发协作)\n* [4.为什么采用以上方式](#4-为什么采用以上方式)\n\n## 1.缘由\n\n最近在开始整理jdk8的新特性新功能。发现多线程处理这块出了一个超级好用的工具类--CompletableFuture。\n之前写并发程序总是采用Thread，Runnable，Callable等源生写法，实现起来比较复杂，稍有不慎就导致bug不断且排查困难。于是准备以几个案例来记录下CompletableFuture的大致用法。\n\n\n## 2.目的\n\n能够根据案例正确的使用CompletableFuture来解决相关并发问题。\n\n## 3.具体实施\n\n### 3.1事前准备\n\n* 了解线程基础知识\n* 了解lambda表达式\n* 了解函数式编程\n* 了解CountDownLatch\n\n### 3.2实施并验证\n\n**基础方法**\n\n|方法  | 说明 | 线程有无返回值|\n| :----------:| :-----------:| :-----------:|\n| runAsync() | 异步运行一个线程 | 无 |\n| supplyAsync() | 异步运行一个线程 | 有 |\n| thenAcceptAsync()() |以上个线程的执行结果作为参数，异步运行一个线程 | 无 |\n| thenApplyAsync()() |以上个线程的执行结果作为参数，异步运行一个线程 | 有 |\n\n\n#### 3.2.1并发打印helloworld\n\n采用CountDownLatch挂起主线程，等所有HelloWorld都打印完毕才结束\n\n```\nfinal int times = 10;\nfinal CountDownLatch countDownLatch = new CountDownLatch(times);\nfor (int i = 0; i < 10; i++) {\n\tCompletableFuture.runAsync(()->{\n\t\tSystem.out.println(\"Hello World. \" + Thread.currentThread().getName() + \": \" \n\t\t\t\t+ Thread.currentThread().getId() + \" \" + LocalTime.now());\n\t\tcountDownLatch.countDown();\n\t});\n}\ncountDownLatch.await();\n```\n\n运行可得到:\n\n```\nHello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.922\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.922\nHello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.922\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923\nHello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923\n```\n\n#### 3.2.2并发协作\n\n\n## 4.为什么采用以上方式\n\n\n\n\n","slug":"jdk8并发编程神器CompletableFuture初探","published":1,"updated":"2020-02-10T07:35:40.256Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55g8000fogvkq11veh2l","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a><ul>\n<li><a href=\"#3-2-1并发打印helloworld\">3.2.1 并发打印helloworld</a></li>\n<li><a href=\"#3-2-2并发协作\">3.2.2 并发协作</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#4-为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>最近在开始整理jdk8的新特性新功能。发现多线程处理这块出了一个超级好用的工具类–CompletableFuture。<br>之前写并发程序总是采用Thread，Runnable，Callable等源生写法，实现起来比较复杂，稍有不慎就导致bug不断且排查困难。于是准备以几个案例来记录下CompletableFuture的大致用法。</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能够根据案例正确的使用CompletableFuture来解决相关并发问题。</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><ul>\n<li>了解线程基础知识</li>\n<li>了解lambda表达式</li>\n<li>了解函数式编程</li>\n<li>了解CountDownLatch</li>\n</ul>\n<h3 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h3><p><strong>基础方法</strong></p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">方法</th>\n<th align=\"center\">说明</th>\n<th align=\"center\">线程有无返回值</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">runAsync()</td>\n<td align=\"center\">异步运行一个线程</td>\n<td align=\"center\">无</td>\n</tr>\n<tr>\n<td align=\"center\">supplyAsync()</td>\n<td align=\"center\">异步运行一个线程</td>\n<td align=\"center\">有</td>\n</tr>\n<tr>\n<td align=\"center\">thenAcceptAsync()()</td>\n<td align=\"center\">以上个线程的执行结果作为参数，异步运行一个线程</td>\n<td align=\"center\">无</td>\n</tr>\n<tr>\n<td align=\"center\">thenApplyAsync()()</td>\n<td align=\"center\">以上个线程的执行结果作为参数，异步运行一个线程</td>\n<td align=\"center\">有</td>\n</tr>\n</tbody></table>\n<h4 id=\"3-2-1并发打印helloworld\"><a href=\"#3-2-1并发打印helloworld\" class=\"headerlink\" title=\"3.2.1并发打印helloworld\"></a>3.2.1并发打印helloworld</h4><p>采用CountDownLatch挂起主线程，等所有HelloWorld都打印完毕才结束</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">final int times = 10;</span><br><span class=\"line\">final CountDownLatch countDownLatch = new CountDownLatch(times);</span><br><span class=\"line\">for (int i = 0; i &lt; 10; i++) &#123;</span><br><span class=\"line\">\tCompletableFuture.runAsync(()-&gt;&#123;</span><br><span class=\"line\">\t\tSystem.out.println(&quot;Hello World. &quot; + Thread.currentThread().getName() + &quot;: &quot; </span><br><span class=\"line\">\t\t\t\t+ Thread.currentThread().getId() + &quot; &quot; + LocalTime.now());</span><br><span class=\"line\">\t\tcountDownLatch.countDown();</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">countDownLatch.await();</span><br></pre></td></tr></table></figure>\n\n<p>运行可得到:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.922</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.922</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.922</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3-2-2并发协作\"><a href=\"#3-2-2并发协作\" class=\"headerlink\" title=\"3.2.2并发协作\"></a>3.2.2并发协作</h4><h2 id=\"4-为什么采用以上方式\"><a href=\"#4-为什么采用以上方式\" class=\"headerlink\" title=\"4.为什么采用以上方式\"></a>4.为什么采用以上方式</h2>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a><ul>\n<li><a href=\"#3-2-1并发打印helloworld\">3.2.1 并发打印helloworld</a></li>\n<li><a href=\"#3-2-2并发协作\">3.2.2 并发协作</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#4-为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>最近在开始整理jdk8的新特性新功能。发现多线程处理这块出了一个超级好用的工具类–CompletableFuture。<br>之前写并发程序总是采用Thread，Runnable，Callable等源生写法，实现起来比较复杂，稍有不慎就导致bug不断且排查困难。于是准备以几个案例来记录下CompletableFuture的大致用法。</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>能够根据案例正确的使用CompletableFuture来解决相关并发问题。</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><ul>\n<li>了解线程基础知识</li>\n<li>了解lambda表达式</li>\n<li>了解函数式编程</li>\n<li>了解CountDownLatch</li>\n</ul>\n<h3 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h3><p><strong>基础方法</strong></p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">方法</th>\n<th align=\"center\">说明</th>\n<th align=\"center\">线程有无返回值</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">runAsync()</td>\n<td align=\"center\">异步运行一个线程</td>\n<td align=\"center\">无</td>\n</tr>\n<tr>\n<td align=\"center\">supplyAsync()</td>\n<td align=\"center\">异步运行一个线程</td>\n<td align=\"center\">有</td>\n</tr>\n<tr>\n<td align=\"center\">thenAcceptAsync()()</td>\n<td align=\"center\">以上个线程的执行结果作为参数，异步运行一个线程</td>\n<td align=\"center\">无</td>\n</tr>\n<tr>\n<td align=\"center\">thenApplyAsync()()</td>\n<td align=\"center\">以上个线程的执行结果作为参数，异步运行一个线程</td>\n<td align=\"center\">有</td>\n</tr>\n</tbody></table>\n<h4 id=\"3-2-1并发打印helloworld\"><a href=\"#3-2-1并发打印helloworld\" class=\"headerlink\" title=\"3.2.1并发打印helloworld\"></a>3.2.1并发打印helloworld</h4><p>采用CountDownLatch挂起主线程，等所有HelloWorld都打印完毕才结束</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">final int times = 10;</span><br><span class=\"line\">final CountDownLatch countDownLatch = new CountDownLatch(times);</span><br><span class=\"line\">for (int i = 0; i &lt; 10; i++) &#123;</span><br><span class=\"line\">\tCompletableFuture.runAsync(()-&gt;&#123;</span><br><span class=\"line\">\t\tSystem.out.println(&quot;Hello World. &quot; + Thread.currentThread().getName() + &quot;: &quot; </span><br><span class=\"line\">\t\t\t\t+ Thread.currentThread().getId() + &quot; &quot; + LocalTime.now());</span><br><span class=\"line\">\t\tcountDownLatch.countDown();</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">countDownLatch.await();</span><br></pre></td></tr></table></figure>\n\n<p>运行可得到:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.922</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.922</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.922</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-3: 13 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-1: 11 17:11:48.923</span><br><span class=\"line\">Hello World. ForkJoinPool.commonPool-worker-2: 12 17:11:48.923</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3-2-2并发协作\"><a href=\"#3-2-2并发协作\" class=\"headerlink\" title=\"3.2.2并发协作\"></a>3.2.2并发协作</h4><h2 id=\"4-为什么采用以上方式\"><a href=\"#4-为什么采用以上方式\" class=\"headerlink\" title=\"4.为什么采用以上方式\"></a>4.为什么采用以上方式</h2>"},{"title":"一次mysql死锁记录","date":"2019-11-24T08:51:49.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体过程](#3-具体过程)\n\n## 1.缘由\n\n由于一次数据库迁移，新的数据库以5.7.25版本安装，但以前的入库程序每次跑不了一天，一定会出现挂死的情况，排查后发现死锁，尝试了几种解决办法，做下记录\n\n## 2.目的\n\n提醒自己以后在使用Mysql时，要考虑到各个版本和锁机制的使用，避免出现死锁的情况\n\n## 3.具体过程\n\nMysql版本: 5.7.25\n\n发生死锁的表：\n```\nCREATE TABLE `table_example` (\n  `dname` varchar(100) DEFAULT '',\n  `subname` varchar(100) DEFAULT '',\n  `data2` varchar(100) DEFAULT '',\n  `data3` varchar(100) DEFAULT '',\n  `capturetime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  KEY `subname` (`subname`),\n  KEY `capturetime` (`capturetime`),\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 \n```\n\n产生死锁的语句：\n```\nLOAD DATA LOCAL INFILE '/data/20191124/data.tmp'  INTO TABLE table_example \nFIELDS TERMINATED BY ';' (dname,subname,data2,data3,capturetime)\n```\n\n**怎么发现死锁的**\n\n执行sql运行情况检索非sleep状态的sql\n```\nshow OPEN TABLES where In_use > 0;\nselect id, db, user, host, command, time, state, info from \ninformation_schema.processlist where command != 'Sleep'  order by time desc;\n```\n\n检查到很多执行时间很长的sql\n\n再执行Innodb死锁检测\n```\nshow engine innodb status;\n```\n\n查到LATEST DETECTED DEADLOCK可以看到最近一次死锁记录\n\n```\n------------------------\nLATEST DETECTED DEADLOCK\n------------------------\n2019-11-18 15:38:35 0x7fca119b8700\n*** (1) TRANSACTION:\nTRANSACTION 72276684, ACTIVE 0 sec inserting\nmysql tables in use 1, locked 1\nLOCK WAIT 18 lock struct(s), heap size 1136, 4 row lock(s)\nMySQL thread id 813, OS thread handle 140505857419008, query id 46012 127.0.0.1 test executing\nLOAD DATA LOCAL INFILE '/data/20191124/data.tmp'  INTO TABLE table_example \nFIELDS TERMINATED BY ';' (dname,subname,data2,data3,capturetime)\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276684 lock_mode X insert intention waiting\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n\n*** (2) TRANSACTION:\nTRANSACTION 72276687, ACTIVE 0 sec inserting\nmysql tables in use 1, locked 1\n16 lock struct(s), heap size 1136, 4 row lock(s)\nMySQL thread id 977, OS thread handle 140505855526656, query id 46014 127.0.0.1 test executing\nLOAD DATA LOCAL INFILE '/data/20191124/data2.tmp'  INTO TABLE table_example \nFIELDS TERMINATED BY ';' (dname,subname,data2,data3,capturetime)\n*** (2) HOLDS THE LOCK(S):\nRECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n\n*** (2) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X insert intention waiting\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n```\n\n**分析死锁原因**\n\n从死锁记录能够看出，主要问题是两个事务相互等待GEN_CLUST_INDEX的S(共享)锁和IX(意向插入)锁导致死锁。\n\n![](./img/article/dead_lock01.png)\n\n由于S锁和IX锁是互斥的，所以发生申请IX锁时会进入队列，而两个事务申请先后不同，事务2先获取了S锁，所以事务1在申请IX锁时需要事务2释放S锁，而事务2又因为申请IX锁需要等待事务1先释放IX锁，形成了相互等待的情况，于是死锁。\n\n**锁类型是否能共存**\n\n| type | X | IX | S | IS |\n| :----------:| :-----------:|  :-----------:|  :-----------:|  :-----------:| \n| X | × | × | × | × |\n| IX | × | √ | × | √ |\n| S | × | × | √ | √ |\n| IS | × | √ | √ | √ |\n\nGEN_CLUST_INDEX 是在对一张表进行update操作，没能找到对应唯一主键时，mysql生成的一张隐式索引表，我们这里遇到的就是这种情况，没有唯一主键。\n\n**解决**\n\n1.由于这张表平时并发入库并不多，主要是用作查询，最后把引擎换成MyISAM之后就解决了。\n\n2.还有一种解决方式是降低了mysql版本到5.6.37。具体为什么降低到5.6.37之后没有死锁问题，没有具体深究。\n\n\n","source":"_posts/一次mysql死锁记录.md","raw":"---\ntitle: 一次mysql死锁记录\ncategories:\n  - Mysql\ntags:\n  - Mysql\n  - 死锁\ndate: 2019-11-24 16:51:49\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体过程](#3-具体过程)\n\n## 1.缘由\n\n由于一次数据库迁移，新的数据库以5.7.25版本安装，但以前的入库程序每次跑不了一天，一定会出现挂死的情况，排查后发现死锁，尝试了几种解决办法，做下记录\n\n## 2.目的\n\n提醒自己以后在使用Mysql时，要考虑到各个版本和锁机制的使用，避免出现死锁的情况\n\n## 3.具体过程\n\nMysql版本: 5.7.25\n\n发生死锁的表：\n```\nCREATE TABLE `table_example` (\n  `dname` varchar(100) DEFAULT '',\n  `subname` varchar(100) DEFAULT '',\n  `data2` varchar(100) DEFAULT '',\n  `data3` varchar(100) DEFAULT '',\n  `capturetime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  KEY `subname` (`subname`),\n  KEY `capturetime` (`capturetime`),\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 \n```\n\n产生死锁的语句：\n```\nLOAD DATA LOCAL INFILE '/data/20191124/data.tmp'  INTO TABLE table_example \nFIELDS TERMINATED BY ';' (dname,subname,data2,data3,capturetime)\n```\n\n**怎么发现死锁的**\n\n执行sql运行情况检索非sleep状态的sql\n```\nshow OPEN TABLES where In_use > 0;\nselect id, db, user, host, command, time, state, info from \ninformation_schema.processlist where command != 'Sleep'  order by time desc;\n```\n\n检查到很多执行时间很长的sql\n\n再执行Innodb死锁检测\n```\nshow engine innodb status;\n```\n\n查到LATEST DETECTED DEADLOCK可以看到最近一次死锁记录\n\n```\n------------------------\nLATEST DETECTED DEADLOCK\n------------------------\n2019-11-18 15:38:35 0x7fca119b8700\n*** (1) TRANSACTION:\nTRANSACTION 72276684, ACTIVE 0 sec inserting\nmysql tables in use 1, locked 1\nLOCK WAIT 18 lock struct(s), heap size 1136, 4 row lock(s)\nMySQL thread id 813, OS thread handle 140505857419008, query id 46012 127.0.0.1 test executing\nLOAD DATA LOCAL INFILE '/data/20191124/data.tmp'  INTO TABLE table_example \nFIELDS TERMINATED BY ';' (dname,subname,data2,data3,capturetime)\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276684 lock_mode X insert intention waiting\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n\n*** (2) TRANSACTION:\nTRANSACTION 72276687, ACTIVE 0 sec inserting\nmysql tables in use 1, locked 1\n16 lock struct(s), heap size 1136, 4 row lock(s)\nMySQL thread id 977, OS thread handle 140505855526656, query id 46014 127.0.0.1 test executing\nLOAD DATA LOCAL INFILE '/data/20191124/data2.tmp'  INTO TABLE table_example \nFIELDS TERMINATED BY ';' (dname,subname,data2,data3,capturetime)\n*** (2) HOLDS THE LOCK(S):\nRECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n\n*** (2) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X insert intention waiting\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n```\n\n**分析死锁原因**\n\n从死锁记录能够看出，主要问题是两个事务相互等待GEN_CLUST_INDEX的S(共享)锁和IX(意向插入)锁导致死锁。\n\n![](./img/article/dead_lock01.png)\n\n由于S锁和IX锁是互斥的，所以发生申请IX锁时会进入队列，而两个事务申请先后不同，事务2先获取了S锁，所以事务1在申请IX锁时需要事务2释放S锁，而事务2又因为申请IX锁需要等待事务1先释放IX锁，形成了相互等待的情况，于是死锁。\n\n**锁类型是否能共存**\n\n| type | X | IX | S | IS |\n| :----------:| :-----------:|  :-----------:|  :-----------:|  :-----------:| \n| X | × | × | × | × |\n| IX | × | √ | × | √ |\n| S | × | × | √ | √ |\n| IS | × | √ | √ | √ |\n\nGEN_CLUST_INDEX 是在对一张表进行update操作，没能找到对应唯一主键时，mysql生成的一张隐式索引表，我们这里遇到的就是这种情况，没有唯一主键。\n\n**解决**\n\n1.由于这张表平时并发入库并不多，主要是用作查询，最后把引擎换成MyISAM之后就解决了。\n\n2.还有一种解决方式是降低了mysql版本到5.6.37。具体为什么降低到5.6.37之后没有死锁问题，没有具体深究。\n\n\n","slug":"一次mysql死锁记录","published":1,"updated":"2020-02-10T07:35:40.256Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55ga000hogvkxho7edqv","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体过程\">3.具体过程</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>由于一次数据库迁移，新的数据库以5.7.25版本安装，但以前的入库程序每次跑不了一天，一定会出现挂死的情况，排查后发现死锁，尝试了几种解决办法，做下记录</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>提醒自己以后在使用Mysql时，要考虑到各个版本和锁机制的使用，避免出现死锁的情况</p>\n<h2 id=\"3-具体过程\"><a href=\"#3-具体过程\" class=\"headerlink\" title=\"3.具体过程\"></a>3.具体过程</h2><p>Mysql版本: 5.7.25</p>\n<p>发生死锁的表：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE TABLE `table_example` (</span><br><span class=\"line\">  `dname` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `subname` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `data2` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `data3` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `capturetime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,</span><br><span class=\"line\">  KEY `subname` (`subname`),</span><br><span class=\"line\">  KEY `capturetime` (`capturetime`),</span><br><span class=\"line\">) ENGINE=InnoDB DEFAULT CHARSET=utf8</span><br></pre></td></tr></table></figure>\n\n<p>产生死锁的语句：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">LOAD DATA LOCAL INFILE &apos;/data/20191124/data.tmp&apos;  INTO TABLE table_example </span><br><span class=\"line\">FIELDS TERMINATED BY &apos;;&apos; (dname,subname,data2,data3,capturetime)</span><br></pre></td></tr></table></figure>\n\n<p><strong>怎么发现死锁的</strong></p>\n<p>执行sql运行情况检索非sleep状态的sql</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show OPEN TABLES where In_use &gt; 0;</span><br><span class=\"line\">select id, db, user, host, command, time, state, info from </span><br><span class=\"line\">information_schema.processlist where command != &apos;Sleep&apos;  order by time desc;</span><br></pre></td></tr></table></figure>\n\n<p>检查到很多执行时间很长的sql</p>\n<p>再执行Innodb死锁检测</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show engine innodb status;</span><br></pre></td></tr></table></figure>\n\n<p>查到LATEST DETECTED DEADLOCK可以看到最近一次死锁记录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">------------------------</span><br><span class=\"line\">LATEST DETECTED DEADLOCK</span><br><span class=\"line\">------------------------</span><br><span class=\"line\">2019-11-18 15:38:35 0x7fca119b8700</span><br><span class=\"line\">*** (1) TRANSACTION:</span><br><span class=\"line\">TRANSACTION 72276684, ACTIVE 0 sec inserting</span><br><span class=\"line\">mysql tables in use 1, locked 1</span><br><span class=\"line\">LOCK WAIT 18 lock struct(s), heap size 1136, 4 row lock(s)</span><br><span class=\"line\">MySQL thread id 813, OS thread handle 140505857419008, query id 46012 127.0.0.1 test executing</span><br><span class=\"line\">LOAD DATA LOCAL INFILE &apos;/data/20191124/data.tmp&apos;  INTO TABLE table_example </span><br><span class=\"line\">FIELDS TERMINATED BY &apos;;&apos; (dname,subname,data2,data3,capturetime)</span><br><span class=\"line\">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</span><br><span class=\"line\">RECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276684 lock_mode X insert intention waiting</span><br><span class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</span><br><span class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</span><br><span class=\"line\"></span><br><span class=\"line\">*** (2) TRANSACTION:</span><br><span class=\"line\">TRANSACTION 72276687, ACTIVE 0 sec inserting</span><br><span class=\"line\">mysql tables in use 1, locked 1</span><br><span class=\"line\">16 lock struct(s), heap size 1136, 4 row lock(s)</span><br><span class=\"line\">MySQL thread id 977, OS thread handle 140505855526656, query id 46014 127.0.0.1 test executing</span><br><span class=\"line\">LOAD DATA LOCAL INFILE &apos;/data/20191124/data2.tmp&apos;  INTO TABLE table_example </span><br><span class=\"line\">FIELDS TERMINATED BY &apos;;&apos; (dname,subname,data2,data3,capturetime)</span><br><span class=\"line\">*** (2) HOLDS THE LOCK(S):</span><br><span class=\"line\">RECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X</span><br><span class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</span><br><span class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</span><br><span class=\"line\"></span><br><span class=\"line\">*** (2) WAITING FOR THIS LOCK TO BE GRANTED:</span><br><span class=\"line\">RECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X insert intention waiting</span><br><span class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</span><br><span class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</span><br></pre></td></tr></table></figure>\n\n<p><strong>分析死锁原因</strong></p>\n<p>从死锁记录能够看出，主要问题是两个事务相互等待GEN_CLUST_INDEX的S(共享)锁和IX(意向插入)锁导致死锁。</p>\n<p><img src=\"./img/article/dead_lock01.png\" alt></p>\n<p>由于S锁和IX锁是互斥的，所以发生申请IX锁时会进入队列，而两个事务申请先后不同，事务2先获取了S锁，所以事务1在申请IX锁时需要事务2释放S锁，而事务2又因为申请IX锁需要等待事务1先释放IX锁，形成了相互等待的情况，于是死锁。</p>\n<p><strong>锁类型是否能共存</strong></p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">type</th>\n<th align=\"center\">X</th>\n<th align=\"center\">IX</th>\n<th align=\"center\">S</th>\n<th align=\"center\">IS</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">X</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n</tr>\n<tr>\n<td align=\"center\">IX</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n</tr>\n<tr>\n<td align=\"center\">S</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n<td align=\"center\">√</td>\n</tr>\n<tr>\n<td align=\"center\">IS</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n<td align=\"center\">√</td>\n<td align=\"center\">√</td>\n</tr>\n</tbody></table>\n<p>GEN_CLUST_INDEX 是在对一张表进行update操作，没能找到对应唯一主键时，mysql生成的一张隐式索引表，我们这里遇到的就是这种情况，没有唯一主键。</p>\n<p><strong>解决</strong></p>\n<p>1.由于这张表平时并发入库并不多，主要是用作查询，最后把引擎换成MyISAM之后就解决了。</p>\n<p>2.还有一种解决方式是降低了mysql版本到5.6.37。具体为什么降低到5.6.37之后没有死锁问题，没有具体深究。</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体过程\">3.具体过程</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>由于一次数据库迁移，新的数据库以5.7.25版本安装，但以前的入库程序每次跑不了一天，一定会出现挂死的情况，排查后发现死锁，尝试了几种解决办法，做下记录</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>提醒自己以后在使用Mysql时，要考虑到各个版本和锁机制的使用，避免出现死锁的情况</p>\n<h2 id=\"3-具体过程\"><a href=\"#3-具体过程\" class=\"headerlink\" title=\"3.具体过程\"></a>3.具体过程</h2><p>Mysql版本: 5.7.25</p>\n<p>发生死锁的表：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE TABLE `table_example` (</span><br><span class=\"line\">  `dname` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `subname` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `data2` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `data3` varchar(100) DEFAULT &apos;&apos;,</span><br><span class=\"line\">  `capturetime` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,</span><br><span class=\"line\">  KEY `subname` (`subname`),</span><br><span class=\"line\">  KEY `capturetime` (`capturetime`),</span><br><span class=\"line\">) ENGINE=InnoDB DEFAULT CHARSET=utf8</span><br></pre></td></tr></table></figure>\n\n<p>产生死锁的语句：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">LOAD DATA LOCAL INFILE &apos;/data/20191124/data.tmp&apos;  INTO TABLE table_example </span><br><span class=\"line\">FIELDS TERMINATED BY &apos;;&apos; (dname,subname,data2,data3,capturetime)</span><br></pre></td></tr></table></figure>\n\n<p><strong>怎么发现死锁的</strong></p>\n<p>执行sql运行情况检索非sleep状态的sql</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show OPEN TABLES where In_use &gt; 0;</span><br><span class=\"line\">select id, db, user, host, command, time, state, info from </span><br><span class=\"line\">information_schema.processlist where command != &apos;Sleep&apos;  order by time desc;</span><br></pre></td></tr></table></figure>\n\n<p>检查到很多执行时间很长的sql</p>\n<p>再执行Innodb死锁检测</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show engine innodb status;</span><br></pre></td></tr></table></figure>\n\n<p>查到LATEST DETECTED DEADLOCK可以看到最近一次死锁记录</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">------------------------</span><br><span class=\"line\">LATEST DETECTED DEADLOCK</span><br><span class=\"line\">------------------------</span><br><span class=\"line\">2019-11-18 15:38:35 0x7fca119b8700</span><br><span class=\"line\">*** (1) TRANSACTION:</span><br><span class=\"line\">TRANSACTION 72276684, ACTIVE 0 sec inserting</span><br><span class=\"line\">mysql tables in use 1, locked 1</span><br><span class=\"line\">LOCK WAIT 18 lock struct(s), heap size 1136, 4 row lock(s)</span><br><span class=\"line\">MySQL thread id 813, OS thread handle 140505857419008, query id 46012 127.0.0.1 test executing</span><br><span class=\"line\">LOAD DATA LOCAL INFILE &apos;/data/20191124/data.tmp&apos;  INTO TABLE table_example </span><br><span class=\"line\">FIELDS TERMINATED BY &apos;;&apos; (dname,subname,data2,data3,capturetime)</span><br><span class=\"line\">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</span><br><span class=\"line\">RECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276684 lock_mode X insert intention waiting</span><br><span class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</span><br><span class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</span><br><span class=\"line\"></span><br><span class=\"line\">*** (2) TRANSACTION:</span><br><span class=\"line\">TRANSACTION 72276687, ACTIVE 0 sec inserting</span><br><span class=\"line\">mysql tables in use 1, locked 1</span><br><span class=\"line\">16 lock struct(s), heap size 1136, 4 row lock(s)</span><br><span class=\"line\">MySQL thread id 977, OS thread handle 140505855526656, query id 46014 127.0.0.1 test executing</span><br><span class=\"line\">LOAD DATA LOCAL INFILE &apos;/data/20191124/data2.tmp&apos;  INTO TABLE table_example </span><br><span class=\"line\">FIELDS TERMINATED BY &apos;;&apos; (dname,subname,data2,data3,capturetime)</span><br><span class=\"line\">*** (2) HOLDS THE LOCK(S):</span><br><span class=\"line\">RECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X</span><br><span class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</span><br><span class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</span><br><span class=\"line\"></span><br><span class=\"line\">*** (2) WAITING FOR THIS LOCK TO BE GRANTED:</span><br><span class=\"line\">RECORD LOCKS space id 5819 page no 171968 n bits 200 index GEN_CLUST_INDEX of table `voltedata_volte`.`volte_rrd_data_20191118` trx id 72276687 lock_mode X insert intention waiting</span><br><span class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</span><br><span class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</span><br></pre></td></tr></table></figure>\n\n<p><strong>分析死锁原因</strong></p>\n<p>从死锁记录能够看出，主要问题是两个事务相互等待GEN_CLUST_INDEX的S(共享)锁和IX(意向插入)锁导致死锁。</p>\n<p><img src=\"./img/article/dead_lock01.png\" alt></p>\n<p>由于S锁和IX锁是互斥的，所以发生申请IX锁时会进入队列，而两个事务申请先后不同，事务2先获取了S锁，所以事务1在申请IX锁时需要事务2释放S锁，而事务2又因为申请IX锁需要等待事务1先释放IX锁，形成了相互等待的情况，于是死锁。</p>\n<p><strong>锁类型是否能共存</strong></p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">type</th>\n<th align=\"center\">X</th>\n<th align=\"center\">IX</th>\n<th align=\"center\">S</th>\n<th align=\"center\">IS</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">X</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n</tr>\n<tr>\n<td align=\"center\">IX</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n</tr>\n<tr>\n<td align=\"center\">S</td>\n<td align=\"center\">×</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n<td align=\"center\">√</td>\n</tr>\n<tr>\n<td align=\"center\">IS</td>\n<td align=\"center\">×</td>\n<td align=\"center\">√</td>\n<td align=\"center\">√</td>\n<td align=\"center\">√</td>\n</tr>\n</tbody></table>\n<p>GEN_CLUST_INDEX 是在对一张表进行update操作，没能找到对应唯一主键时，mysql生成的一张隐式索引表，我们这里遇到的就是这种情况，没有唯一主键。</p>\n<p><strong>解决</strong></p>\n<p>1.由于这张表平时并发入库并不多，主要是用作查询，最后把引擎换成MyISAM之后就解决了。</p>\n<p>2.还有一种解决方式是降低了mysql版本到5.6.37。具体为什么降低到5.6.37之后没有死锁问题，没有具体深究。</p>\n"},{"title":"临时学习记录","date":"2020-02-12T14:32:12.000Z","_content":"\n### 目录\n* [1.目的](#1-目的)\n* [2.具体记录](#2-具体记录)\n\n\n\n## 1.目的\n\n临时记录学习的点，后续需要整理形成文档。\n\n//TODO-LIST\n\n* 网络基础易忘点记录\n* 数据库易忘点记录\n\n## 2.具体记录\n\n### 网络基础知识\n\n```\nTCP4次挥手完毕后，client并不会马上关闭连接，而是会等待2MSL的时间才会进行关闭。2MSL超时设置在linux中设置为30s。\n理由：1.确保server有足够的时间收到ACK。2.避免新旧连接混淆，部分路由器会缓存ip数据包，可能出现旧数据包发送到新连接中。\n\nCLOSE_WAIT 状态对应程序中不正确释放连接。过多CLOSE_WAIT 会造成too many files open \n\n\nTCP/UDP\n\n1.面向连接/无连接\n2.可靠/不可靠\n3.有序/无序\n4.速度较慢/较快\n5.重量级/轻量级 (头部20字节/8字节头)\n\nTCP的滑动窗口(传输可靠性的原理)\n\nRTT: 发送包到ACK之间的时间\nRTO：重传时间间隔\n\nTCP发送方会话中间状态：\n\n1.Sent and ack 已发送，已确认\n2.Sent but not yet ACK 已发送，未确认\n3.Not Sent Recipient Ready to Receive 未发送，但允许发送的\n4.Not Sent Recipient Not Ready to Receive 未发送，达到窗口大小，不允许发送的\n\n接收方状态\n\n1.Rcd and ack 已接收完毕且发送ACK的窗口\n2.Not yet rcvd 正在接收且还未接收完毕的窗口\n3.Not yet rcvd 可能收到的数据且不会发送ack的窗口\n\n通过指定一个滑动窗口，发送方确定发送数据已发送，接收方确定接收数据已接收\n\n问题：java中怎么设置滑动窗口的大小？\n\n\nHTTP\n\nclient/server 模式、简单快速、灵活、无连接、无状态\n1.1比1.0多了keep-alived模式\n\n```\n\n\n### 数据库\n\n知识点：架构、索引、锁、语法、理论范式\n\n```\n\n\n\n1.如何设计一个关系型数据库？\n<1>存储(文件系统)\n<2>程序实例：存储管理、缓存机制(LRU等，利用内存减少硬盘IO)、SQL解析、日志管理、权限划分、容灾机制、【索引管理、锁管理】\n\n\n索引优化\n\n核心思想：减少IO、降低时间复杂度\n\nB Tree\n\n<1>根节点至少包括两个child\n<2>树中每个节点最多含有m个child (m >= 2)\n<3>除根节点和叶节点外，其他每个节点至少有ceil(m/2)个child\n<4>所有叶子节点都位于同一层\n<5>假设每个非终端节点中包含有n个关键字信息，其中\na)Ki(i=1...n)为关键字，且关键字按顺序升序排列K(i-1) < Ki\nb)关键字的个数n必须满足：[ceil(m/2) - 1] <= n <= m - 1\nc)非叶子节点的指针:P[1],P[2],...,P[M]；其中P[1]指向关键字小于K[1]的子树，P[M]指向关键字大于K[M-1]的子树，其他P[i]指向关键字属于(K[i-1],K[i])的子树\n\n\nB+ Tree\n\nB树的变体\n\n和B树不同点：\na)非叶子节点的子树指针与关键字个数相同\nb)非叶子节点的子树指针P[i]，指向关键字值[K[i],K[i+1])的子树\nc)非叶子节点仅用来索引，数据都保存在叶子节点中  (减少IO，时间复杂度稳定为O(logn))\nd)所有叶子节点均有一个链指针指向下一个叶子节点 (利于数据库的扫描)\n\n\nHash索引\n\n缺点：\n只能\"=\",\"in\" 不能范围查询\n无法避免数据的排序操作\n不能利用部分索引键查询 (组合索引中部分索引无法利用)\n不能避免表扫描 (Hash碰撞后实际仍然要访问数据)\n遇到大量Hash值相等，性能不一定比B树高\n\n\nBitMap索引\n\n适合统计值为固定的数据，由于是bit中具体位是否为1来表示是否是对应值，所以在做统计时几乎是cpu叠加操作，速度非常快\n\n缺点：锁的粒度非常大，因为具体一个值的某行进行变化时，出现逻辑顺序的变化。适用于并发低，查询少，统计多的OLAP系统，不适合OLTP系统\n\n\n\n密集索引和稀疏索引\n\nInnoDB(主键和辅助主键)\n主键作为唯一密集索引\n没主键，唯一非空索引作为.\n都不满足，隐藏主键\n\n\nforce index (primary)  强制走主键索引  mysql查询优化器决定使用什么索引(密集索引和稀疏索引)，但有时不一定是最优的，具体情况可以使用force index来使查询最优。 \n\n\n联合索引的最左匹配原则成因\n\n1.mysql会一直向右匹配直到遇到范围查询(>、<、between、like)就停止匹配\n2.=和in可以乱序，mysql查询优化器会帮助优化成索引可以识别的形式\n\n最左匹配原则会根据第一个索引进行B+树排序，之后的匹配会根据第一个索引匹配到的数据再检索第二个字段排列检索，依次类推\n\nlock tables\nunlock tables\nfor update\nlock in share mode\n\nInnoDB sql不走索引时，走的是表级锁\n\n事务特性 ACID\n原子性Atomic\n一致性Consistency\n隔离性Isolation\n持久性Durability\n\nstart transaction / set autocommit = 0\n\n查询mysql事务隔离级别 select @@tx_isolation; \n设置当前事务隔离级别 set session transaction isolation level <具体级别>\n\n具体级别：\nread uncommitted (允许读取未提交的数据)\nread committed (只允许读取提交后的数据-避免脏读)\nrepeatable read (可重复读-避免不可重复读，即多个事务修改同一数据，没有按照前后顺序依次进行操作)\nserializable (序列化-避免幻读，即有事务在做update时，更新到了其他事务插入的数据)\n\nInnoDB repeatable read模式下如何避免幻读\n\n当前读(lock in share mode，for update)和快照读\n\n事务首次调用快照读的时机非常重要，若在update操作之后再进行快照读，即可以拿到最新的数据\n\nRC、RR级别下的InnDB的非阻塞读如何实现\n1.数据行里的DB_TRX_ID、DB_ROLL_PTR、DB_ROW_ID字段(mysql中的隐藏字段)\n2.undo日志\nX锁锁住修改行，拷贝一份修改之前的数据到undo log，再修改对应值，PTR指针指向undolog中的拷贝数据，多次操作时，就有多个版本依次指向。\n快照时就获取到undo\n\n3.read view\n遵循一个可见性算法，主要根据当前数据的DB_TRX_ID取出和当前系统中其他活跃事务的ID进行对比，若大于事务中的ID，则通过DB_ROLL_PTR去取出undolog中上一层的DB_TRX_ID，直到小于这些活跃事务ID为止。这样就能够保证当前事务获取到的数据时当前最稳定的版本。伪MVCC机制，因为没有实现真正的多版本共存，只是串行记录了多个版本的记录。\n\n具体算法涉及mysql源码，不做过多深究。\n\n其他可探究的内容：redolog undolog binlog\n\n```\n\n\n\n","source":"_posts/临时学习记录.md","raw":"---\ntitle: 临时学习记录\ncategories:\n  - 待整理\ntags:\n  - 学习记录\ndate: 2020-02-12 22:32:12\n---\n\n### 目录\n* [1.目的](#1-目的)\n* [2.具体记录](#2-具体记录)\n\n\n\n## 1.目的\n\n临时记录学习的点，后续需要整理形成文档。\n\n//TODO-LIST\n\n* 网络基础易忘点记录\n* 数据库易忘点记录\n\n## 2.具体记录\n\n### 网络基础知识\n\n```\nTCP4次挥手完毕后，client并不会马上关闭连接，而是会等待2MSL的时间才会进行关闭。2MSL超时设置在linux中设置为30s。\n理由：1.确保server有足够的时间收到ACK。2.避免新旧连接混淆，部分路由器会缓存ip数据包，可能出现旧数据包发送到新连接中。\n\nCLOSE_WAIT 状态对应程序中不正确释放连接。过多CLOSE_WAIT 会造成too many files open \n\n\nTCP/UDP\n\n1.面向连接/无连接\n2.可靠/不可靠\n3.有序/无序\n4.速度较慢/较快\n5.重量级/轻量级 (头部20字节/8字节头)\n\nTCP的滑动窗口(传输可靠性的原理)\n\nRTT: 发送包到ACK之间的时间\nRTO：重传时间间隔\n\nTCP发送方会话中间状态：\n\n1.Sent and ack 已发送，已确认\n2.Sent but not yet ACK 已发送，未确认\n3.Not Sent Recipient Ready to Receive 未发送，但允许发送的\n4.Not Sent Recipient Not Ready to Receive 未发送，达到窗口大小，不允许发送的\n\n接收方状态\n\n1.Rcd and ack 已接收完毕且发送ACK的窗口\n2.Not yet rcvd 正在接收且还未接收完毕的窗口\n3.Not yet rcvd 可能收到的数据且不会发送ack的窗口\n\n通过指定一个滑动窗口，发送方确定发送数据已发送，接收方确定接收数据已接收\n\n问题：java中怎么设置滑动窗口的大小？\n\n\nHTTP\n\nclient/server 模式、简单快速、灵活、无连接、无状态\n1.1比1.0多了keep-alived模式\n\n```\n\n\n### 数据库\n\n知识点：架构、索引、锁、语法、理论范式\n\n```\n\n\n\n1.如何设计一个关系型数据库？\n<1>存储(文件系统)\n<2>程序实例：存储管理、缓存机制(LRU等，利用内存减少硬盘IO)、SQL解析、日志管理、权限划分、容灾机制、【索引管理、锁管理】\n\n\n索引优化\n\n核心思想：减少IO、降低时间复杂度\n\nB Tree\n\n<1>根节点至少包括两个child\n<2>树中每个节点最多含有m个child (m >= 2)\n<3>除根节点和叶节点外，其他每个节点至少有ceil(m/2)个child\n<4>所有叶子节点都位于同一层\n<5>假设每个非终端节点中包含有n个关键字信息，其中\na)Ki(i=1...n)为关键字，且关键字按顺序升序排列K(i-1) < Ki\nb)关键字的个数n必须满足：[ceil(m/2) - 1] <= n <= m - 1\nc)非叶子节点的指针:P[1],P[2],...,P[M]；其中P[1]指向关键字小于K[1]的子树，P[M]指向关键字大于K[M-1]的子树，其他P[i]指向关键字属于(K[i-1],K[i])的子树\n\n\nB+ Tree\n\nB树的变体\n\n和B树不同点：\na)非叶子节点的子树指针与关键字个数相同\nb)非叶子节点的子树指针P[i]，指向关键字值[K[i],K[i+1])的子树\nc)非叶子节点仅用来索引，数据都保存在叶子节点中  (减少IO，时间复杂度稳定为O(logn))\nd)所有叶子节点均有一个链指针指向下一个叶子节点 (利于数据库的扫描)\n\n\nHash索引\n\n缺点：\n只能\"=\",\"in\" 不能范围查询\n无法避免数据的排序操作\n不能利用部分索引键查询 (组合索引中部分索引无法利用)\n不能避免表扫描 (Hash碰撞后实际仍然要访问数据)\n遇到大量Hash值相等，性能不一定比B树高\n\n\nBitMap索引\n\n适合统计值为固定的数据，由于是bit中具体位是否为1来表示是否是对应值，所以在做统计时几乎是cpu叠加操作，速度非常快\n\n缺点：锁的粒度非常大，因为具体一个值的某行进行变化时，出现逻辑顺序的变化。适用于并发低，查询少，统计多的OLAP系统，不适合OLTP系统\n\n\n\n密集索引和稀疏索引\n\nInnoDB(主键和辅助主键)\n主键作为唯一密集索引\n没主键，唯一非空索引作为.\n都不满足，隐藏主键\n\n\nforce index (primary)  强制走主键索引  mysql查询优化器决定使用什么索引(密集索引和稀疏索引)，但有时不一定是最优的，具体情况可以使用force index来使查询最优。 \n\n\n联合索引的最左匹配原则成因\n\n1.mysql会一直向右匹配直到遇到范围查询(>、<、between、like)就停止匹配\n2.=和in可以乱序，mysql查询优化器会帮助优化成索引可以识别的形式\n\n最左匹配原则会根据第一个索引进行B+树排序，之后的匹配会根据第一个索引匹配到的数据再检索第二个字段排列检索，依次类推\n\nlock tables\nunlock tables\nfor update\nlock in share mode\n\nInnoDB sql不走索引时，走的是表级锁\n\n事务特性 ACID\n原子性Atomic\n一致性Consistency\n隔离性Isolation\n持久性Durability\n\nstart transaction / set autocommit = 0\n\n查询mysql事务隔离级别 select @@tx_isolation; \n设置当前事务隔离级别 set session transaction isolation level <具体级别>\n\n具体级别：\nread uncommitted (允许读取未提交的数据)\nread committed (只允许读取提交后的数据-避免脏读)\nrepeatable read (可重复读-避免不可重复读，即多个事务修改同一数据，没有按照前后顺序依次进行操作)\nserializable (序列化-避免幻读，即有事务在做update时，更新到了其他事务插入的数据)\n\nInnoDB repeatable read模式下如何避免幻读\n\n当前读(lock in share mode，for update)和快照读\n\n事务首次调用快照读的时机非常重要，若在update操作之后再进行快照读，即可以拿到最新的数据\n\nRC、RR级别下的InnDB的非阻塞读如何实现\n1.数据行里的DB_TRX_ID、DB_ROLL_PTR、DB_ROW_ID字段(mysql中的隐藏字段)\n2.undo日志\nX锁锁住修改行，拷贝一份修改之前的数据到undo log，再修改对应值，PTR指针指向undolog中的拷贝数据，多次操作时，就有多个版本依次指向。\n快照时就获取到undo\n\n3.read view\n遵循一个可见性算法，主要根据当前数据的DB_TRX_ID取出和当前系统中其他活跃事务的ID进行对比，若大于事务中的ID，则通过DB_ROLL_PTR去取出undolog中上一层的DB_TRX_ID，直到小于这些活跃事务ID为止。这样就能够保证当前事务获取到的数据时当前最稳定的版本。伪MVCC机制，因为没有实现真正的多版本共存，只是串行记录了多个版本的记录。\n\n具体算法涉及mysql源码，不做过多深究。\n\n其他可探究的内容：redolog undolog binlog\n\n```\n\n\n\n","slug":"临时学习记录","published":1,"updated":"2020-02-12T14:47:03.918Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55ge000mogvktzwm36r8","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-目的\">1.目的</a></li>\n<li><a href=\"#2-具体记录\">2.具体记录</a></li>\n</ul>\n<h2 id=\"1-目的\"><a href=\"#1-目的\" class=\"headerlink\" title=\"1.目的\"></a>1.目的</h2><p>临时记录学习的点，后续需要整理形成文档。</p>\n<p>//TODO-LIST</p>\n<ul>\n<li>网络基础易忘点记录</li>\n<li>数据库易忘点记录</li>\n</ul>\n<h2 id=\"2-具体记录\"><a href=\"#2-具体记录\" class=\"headerlink\" title=\"2.具体记录\"></a>2.具体记录</h2><h3 id=\"网络基础知识\"><a href=\"#网络基础知识\" class=\"headerlink\" title=\"网络基础知识\"></a>网络基础知识</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TCP4次挥手完毕后，client并不会马上关闭连接，而是会等待2MSL的时间才会进行关闭。2MSL超时设置在linux中设置为30s。</span><br><span class=\"line\">理由：1.确保server有足够的时间收到ACK。2.避免新旧连接混淆，部分路由器会缓存ip数据包，可能出现旧数据包发送到新连接中。</span><br><span class=\"line\"></span><br><span class=\"line\">CLOSE_WAIT 状态对应程序中不正确释放连接。过多CLOSE_WAIT 会造成too many files open </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">TCP/UDP</span><br><span class=\"line\"></span><br><span class=\"line\">1.面向连接/无连接</span><br><span class=\"line\">2.可靠/不可靠</span><br><span class=\"line\">3.有序/无序</span><br><span class=\"line\">4.速度较慢/较快</span><br><span class=\"line\">5.重量级/轻量级 (头部20字节/8字节头)</span><br><span class=\"line\"></span><br><span class=\"line\">TCP的滑动窗口(传输可靠性的原理)</span><br><span class=\"line\"></span><br><span class=\"line\">RTT: 发送包到ACK之间的时间</span><br><span class=\"line\">RTO：重传时间间隔</span><br><span class=\"line\"></span><br><span class=\"line\">TCP发送方会话中间状态：</span><br><span class=\"line\"></span><br><span class=\"line\">1.Sent and ack 已发送，已确认</span><br><span class=\"line\">2.Sent but not yet ACK 已发送，未确认</span><br><span class=\"line\">3.Not Sent Recipient Ready to Receive 未发送，但允许发送的</span><br><span class=\"line\">4.Not Sent Recipient Not Ready to Receive 未发送，达到窗口大小，不允许发送的</span><br><span class=\"line\"></span><br><span class=\"line\">接收方状态</span><br><span class=\"line\"></span><br><span class=\"line\">1.Rcd and ack 已接收完毕且发送ACK的窗口</span><br><span class=\"line\">2.Not yet rcvd 正在接收且还未接收完毕的窗口</span><br><span class=\"line\">3.Not yet rcvd 可能收到的数据且不会发送ack的窗口</span><br><span class=\"line\"></span><br><span class=\"line\">通过指定一个滑动窗口，发送方确定发送数据已发送，接收方确定接收数据已接收</span><br><span class=\"line\"></span><br><span class=\"line\">问题：java中怎么设置滑动窗口的大小？</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">HTTP</span><br><span class=\"line\"></span><br><span class=\"line\">client/server 模式、简单快速、灵活、无连接、无状态</span><br><span class=\"line\">1.1比1.0多了keep-alived模式</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"数据库\"><a href=\"#数据库\" class=\"headerlink\" title=\"数据库\"></a>数据库</h3><p>知识点：架构、索引、锁、语法、理论范式</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">1.如何设计一个关系型数据库？</span><br><span class=\"line\">&lt;1&gt;存储(文件系统)</span><br><span class=\"line\">&lt;2&gt;程序实例：存储管理、缓存机制(LRU等，利用内存减少硬盘IO)、SQL解析、日志管理、权限划分、容灾机制、【索引管理、锁管理】</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">索引优化</span><br><span class=\"line\"></span><br><span class=\"line\">核心思想：减少IO、降低时间复杂度</span><br><span class=\"line\"></span><br><span class=\"line\">B Tree</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;1&gt;根节点至少包括两个child</span><br><span class=\"line\">&lt;2&gt;树中每个节点最多含有m个child (m &gt;= 2)</span><br><span class=\"line\">&lt;3&gt;除根节点和叶节点外，其他每个节点至少有ceil(m/2)个child</span><br><span class=\"line\">&lt;4&gt;所有叶子节点都位于同一层</span><br><span class=\"line\">&lt;5&gt;假设每个非终端节点中包含有n个关键字信息，其中</span><br><span class=\"line\">a)Ki(i=1...n)为关键字，且关键字按顺序升序排列K(i-1) &lt; Ki</span><br><span class=\"line\">b)关键字的个数n必须满足：[ceil(m/2) - 1] &lt;= n &lt;= m - 1</span><br><span class=\"line\">c)非叶子节点的指针:P[1],P[2],...,P[M]；其中P[1]指向关键字小于K[1]的子树，P[M]指向关键字大于K[M-1]的子树，其他P[i]指向关键字属于(K[i-1],K[i])的子树</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">B+ Tree</span><br><span class=\"line\"></span><br><span class=\"line\">B树的变体</span><br><span class=\"line\"></span><br><span class=\"line\">和B树不同点：</span><br><span class=\"line\">a)非叶子节点的子树指针与关键字个数相同</span><br><span class=\"line\">b)非叶子节点的子树指针P[i]，指向关键字值[K[i],K[i+1])的子树</span><br><span class=\"line\">c)非叶子节点仅用来索引，数据都保存在叶子节点中  (减少IO，时间复杂度稳定为O(logn))</span><br><span class=\"line\">d)所有叶子节点均有一个链指针指向下一个叶子节点 (利于数据库的扫描)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">Hash索引</span><br><span class=\"line\"></span><br><span class=\"line\">缺点：</span><br><span class=\"line\">只能&quot;=&quot;,&quot;in&quot; 不能范围查询</span><br><span class=\"line\">无法避免数据的排序操作</span><br><span class=\"line\">不能利用部分索引键查询 (组合索引中部分索引无法利用)</span><br><span class=\"line\">不能避免表扫描 (Hash碰撞后实际仍然要访问数据)</span><br><span class=\"line\">遇到大量Hash值相等，性能不一定比B树高</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">BitMap索引</span><br><span class=\"line\"></span><br><span class=\"line\">适合统计值为固定的数据，由于是bit中具体位是否为1来表示是否是对应值，所以在做统计时几乎是cpu叠加操作，速度非常快</span><br><span class=\"line\"></span><br><span class=\"line\">缺点：锁的粒度非常大，因为具体一个值的某行进行变化时，出现逻辑顺序的变化。适用于并发低，查询少，统计多的OLAP系统，不适合OLTP系统</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">密集索引和稀疏索引</span><br><span class=\"line\"></span><br><span class=\"line\">InnoDB(主键和辅助主键)</span><br><span class=\"line\">主键作为唯一密集索引</span><br><span class=\"line\">没主键，唯一非空索引作为.</span><br><span class=\"line\">都不满足，隐藏主键</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">force index (primary)  强制走主键索引  mysql查询优化器决定使用什么索引(密集索引和稀疏索引)，但有时不一定是最优的，具体情况可以使用force index来使查询最优。 </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">联合索引的最左匹配原则成因</span><br><span class=\"line\"></span><br><span class=\"line\">1.mysql会一直向右匹配直到遇到范围查询(&gt;、&lt;、between、like)就停止匹配</span><br><span class=\"line\">2.=和in可以乱序，mysql查询优化器会帮助优化成索引可以识别的形式</span><br><span class=\"line\"></span><br><span class=\"line\">最左匹配原则会根据第一个索引进行B+树排序，之后的匹配会根据第一个索引匹配到的数据再检索第二个字段排列检索，依次类推</span><br><span class=\"line\"></span><br><span class=\"line\">lock tables</span><br><span class=\"line\">unlock tables</span><br><span class=\"line\">for update</span><br><span class=\"line\">lock in share mode</span><br><span class=\"line\"></span><br><span class=\"line\">InnoDB sql不走索引时，走的是表级锁</span><br><span class=\"line\"></span><br><span class=\"line\">事务特性 ACID</span><br><span class=\"line\">原子性Atomic</span><br><span class=\"line\">一致性Consistency</span><br><span class=\"line\">隔离性Isolation</span><br><span class=\"line\">持久性Durability</span><br><span class=\"line\"></span><br><span class=\"line\">start transaction / set autocommit = 0</span><br><span class=\"line\"></span><br><span class=\"line\">查询mysql事务隔离级别 select @@tx_isolation; </span><br><span class=\"line\">设置当前事务隔离级别 set session transaction isolation level &lt;具体级别&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">具体级别：</span><br><span class=\"line\">read uncommitted (允许读取未提交的数据)</span><br><span class=\"line\">read committed (只允许读取提交后的数据-避免脏读)</span><br><span class=\"line\">repeatable read (可重复读-避免不可重复读，即多个事务修改同一数据，没有按照前后顺序依次进行操作)</span><br><span class=\"line\">serializable (序列化-避免幻读，即有事务在做update时，更新到了其他事务插入的数据)</span><br><span class=\"line\"></span><br><span class=\"line\">InnoDB repeatable read模式下如何避免幻读</span><br><span class=\"line\"></span><br><span class=\"line\">当前读(lock in share mode，for update)和快照读</span><br><span class=\"line\"></span><br><span class=\"line\">事务首次调用快照读的时机非常重要，若在update操作之后再进行快照读，即可以拿到最新的数据</span><br><span class=\"line\"></span><br><span class=\"line\">RC、RR级别下的InnDB的非阻塞读如何实现</span><br><span class=\"line\">1.数据行里的DB_TRX_ID、DB_ROLL_PTR、DB_ROW_ID字段(mysql中的隐藏字段)</span><br><span class=\"line\">2.undo日志</span><br><span class=\"line\">X锁锁住修改行，拷贝一份修改之前的数据到undo log，再修改对应值，PTR指针指向undolog中的拷贝数据，多次操作时，就有多个版本依次指向。</span><br><span class=\"line\">快照时就获取到undo</span><br><span class=\"line\"></span><br><span class=\"line\">3.read view</span><br><span class=\"line\">遵循一个可见性算法，主要根据当前数据的DB_TRX_ID取出和当前系统中其他活跃事务的ID进行对比，若大于事务中的ID，则通过DB_ROLL_PTR去取出undolog中上一层的DB_TRX_ID，直到小于这些活跃事务ID为止。这样就能够保证当前事务获取到的数据时当前最稳定的版本。伪MVCC机制，因为没有实现真正的多版本共存，只是串行记录了多个版本的记录。</span><br><span class=\"line\"></span><br><span class=\"line\">具体算法涉及mysql源码，不做过多深究。</span><br><span class=\"line\"></span><br><span class=\"line\">其他可探究的内容：redolog undolog binlog</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-目的\">1.目的</a></li>\n<li><a href=\"#2-具体记录\">2.具体记录</a></li>\n</ul>\n<h2 id=\"1-目的\"><a href=\"#1-目的\" class=\"headerlink\" title=\"1.目的\"></a>1.目的</h2><p>临时记录学习的点，后续需要整理形成文档。</p>\n<p>//TODO-LIST</p>\n<ul>\n<li>网络基础易忘点记录</li>\n<li>数据库易忘点记录</li>\n</ul>\n<h2 id=\"2-具体记录\"><a href=\"#2-具体记录\" class=\"headerlink\" title=\"2.具体记录\"></a>2.具体记录</h2><h3 id=\"网络基础知识\"><a href=\"#网络基础知识\" class=\"headerlink\" title=\"网络基础知识\"></a>网络基础知识</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">TCP4次挥手完毕后，client并不会马上关闭连接，而是会等待2MSL的时间才会进行关闭。2MSL超时设置在linux中设置为30s。</span><br><span class=\"line\">理由：1.确保server有足够的时间收到ACK。2.避免新旧连接混淆，部分路由器会缓存ip数据包，可能出现旧数据包发送到新连接中。</span><br><span class=\"line\"></span><br><span class=\"line\">CLOSE_WAIT 状态对应程序中不正确释放连接。过多CLOSE_WAIT 会造成too many files open </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">TCP/UDP</span><br><span class=\"line\"></span><br><span class=\"line\">1.面向连接/无连接</span><br><span class=\"line\">2.可靠/不可靠</span><br><span class=\"line\">3.有序/无序</span><br><span class=\"line\">4.速度较慢/较快</span><br><span class=\"line\">5.重量级/轻量级 (头部20字节/8字节头)</span><br><span class=\"line\"></span><br><span class=\"line\">TCP的滑动窗口(传输可靠性的原理)</span><br><span class=\"line\"></span><br><span class=\"line\">RTT: 发送包到ACK之间的时间</span><br><span class=\"line\">RTO：重传时间间隔</span><br><span class=\"line\"></span><br><span class=\"line\">TCP发送方会话中间状态：</span><br><span class=\"line\"></span><br><span class=\"line\">1.Sent and ack 已发送，已确认</span><br><span class=\"line\">2.Sent but not yet ACK 已发送，未确认</span><br><span class=\"line\">3.Not Sent Recipient Ready to Receive 未发送，但允许发送的</span><br><span class=\"line\">4.Not Sent Recipient Not Ready to Receive 未发送，达到窗口大小，不允许发送的</span><br><span class=\"line\"></span><br><span class=\"line\">接收方状态</span><br><span class=\"line\"></span><br><span class=\"line\">1.Rcd and ack 已接收完毕且发送ACK的窗口</span><br><span class=\"line\">2.Not yet rcvd 正在接收且还未接收完毕的窗口</span><br><span class=\"line\">3.Not yet rcvd 可能收到的数据且不会发送ack的窗口</span><br><span class=\"line\"></span><br><span class=\"line\">通过指定一个滑动窗口，发送方确定发送数据已发送，接收方确定接收数据已接收</span><br><span class=\"line\"></span><br><span class=\"line\">问题：java中怎么设置滑动窗口的大小？</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">HTTP</span><br><span class=\"line\"></span><br><span class=\"line\">client/server 模式、简单快速、灵活、无连接、无状态</span><br><span class=\"line\">1.1比1.0多了keep-alived模式</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"数据库\"><a href=\"#数据库\" class=\"headerlink\" title=\"数据库\"></a>数据库</h3><p>知识点：架构、索引、锁、语法、理论范式</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">1.如何设计一个关系型数据库？</span><br><span class=\"line\">&lt;1&gt;存储(文件系统)</span><br><span class=\"line\">&lt;2&gt;程序实例：存储管理、缓存机制(LRU等，利用内存减少硬盘IO)、SQL解析、日志管理、权限划分、容灾机制、【索引管理、锁管理】</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">索引优化</span><br><span class=\"line\"></span><br><span class=\"line\">核心思想：减少IO、降低时间复杂度</span><br><span class=\"line\"></span><br><span class=\"line\">B Tree</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;1&gt;根节点至少包括两个child</span><br><span class=\"line\">&lt;2&gt;树中每个节点最多含有m个child (m &gt;= 2)</span><br><span class=\"line\">&lt;3&gt;除根节点和叶节点外，其他每个节点至少有ceil(m/2)个child</span><br><span class=\"line\">&lt;4&gt;所有叶子节点都位于同一层</span><br><span class=\"line\">&lt;5&gt;假设每个非终端节点中包含有n个关键字信息，其中</span><br><span class=\"line\">a)Ki(i=1...n)为关键字，且关键字按顺序升序排列K(i-1) &lt; Ki</span><br><span class=\"line\">b)关键字的个数n必须满足：[ceil(m/2) - 1] &lt;= n &lt;= m - 1</span><br><span class=\"line\">c)非叶子节点的指针:P[1],P[2],...,P[M]；其中P[1]指向关键字小于K[1]的子树，P[M]指向关键字大于K[M-1]的子树，其他P[i]指向关键字属于(K[i-1],K[i])的子树</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">B+ Tree</span><br><span class=\"line\"></span><br><span class=\"line\">B树的变体</span><br><span class=\"line\"></span><br><span class=\"line\">和B树不同点：</span><br><span class=\"line\">a)非叶子节点的子树指针与关键字个数相同</span><br><span class=\"line\">b)非叶子节点的子树指针P[i]，指向关键字值[K[i],K[i+1])的子树</span><br><span class=\"line\">c)非叶子节点仅用来索引，数据都保存在叶子节点中  (减少IO，时间复杂度稳定为O(logn))</span><br><span class=\"line\">d)所有叶子节点均有一个链指针指向下一个叶子节点 (利于数据库的扫描)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">Hash索引</span><br><span class=\"line\"></span><br><span class=\"line\">缺点：</span><br><span class=\"line\">只能&quot;=&quot;,&quot;in&quot; 不能范围查询</span><br><span class=\"line\">无法避免数据的排序操作</span><br><span class=\"line\">不能利用部分索引键查询 (组合索引中部分索引无法利用)</span><br><span class=\"line\">不能避免表扫描 (Hash碰撞后实际仍然要访问数据)</span><br><span class=\"line\">遇到大量Hash值相等，性能不一定比B树高</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">BitMap索引</span><br><span class=\"line\"></span><br><span class=\"line\">适合统计值为固定的数据，由于是bit中具体位是否为1来表示是否是对应值，所以在做统计时几乎是cpu叠加操作，速度非常快</span><br><span class=\"line\"></span><br><span class=\"line\">缺点：锁的粒度非常大，因为具体一个值的某行进行变化时，出现逻辑顺序的变化。适用于并发低，查询少，统计多的OLAP系统，不适合OLTP系统</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">密集索引和稀疏索引</span><br><span class=\"line\"></span><br><span class=\"line\">InnoDB(主键和辅助主键)</span><br><span class=\"line\">主键作为唯一密集索引</span><br><span class=\"line\">没主键，唯一非空索引作为.</span><br><span class=\"line\">都不满足，隐藏主键</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">force index (primary)  强制走主键索引  mysql查询优化器决定使用什么索引(密集索引和稀疏索引)，但有时不一定是最优的，具体情况可以使用force index来使查询最优。 </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">联合索引的最左匹配原则成因</span><br><span class=\"line\"></span><br><span class=\"line\">1.mysql会一直向右匹配直到遇到范围查询(&gt;、&lt;、between、like)就停止匹配</span><br><span class=\"line\">2.=和in可以乱序，mysql查询优化器会帮助优化成索引可以识别的形式</span><br><span class=\"line\"></span><br><span class=\"line\">最左匹配原则会根据第一个索引进行B+树排序，之后的匹配会根据第一个索引匹配到的数据再检索第二个字段排列检索，依次类推</span><br><span class=\"line\"></span><br><span class=\"line\">lock tables</span><br><span class=\"line\">unlock tables</span><br><span class=\"line\">for update</span><br><span class=\"line\">lock in share mode</span><br><span class=\"line\"></span><br><span class=\"line\">InnoDB sql不走索引时，走的是表级锁</span><br><span class=\"line\"></span><br><span class=\"line\">事务特性 ACID</span><br><span class=\"line\">原子性Atomic</span><br><span class=\"line\">一致性Consistency</span><br><span class=\"line\">隔离性Isolation</span><br><span class=\"line\">持久性Durability</span><br><span class=\"line\"></span><br><span class=\"line\">start transaction / set autocommit = 0</span><br><span class=\"line\"></span><br><span class=\"line\">查询mysql事务隔离级别 select @@tx_isolation; </span><br><span class=\"line\">设置当前事务隔离级别 set session transaction isolation level &lt;具体级别&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">具体级别：</span><br><span class=\"line\">read uncommitted (允许读取未提交的数据)</span><br><span class=\"line\">read committed (只允许读取提交后的数据-避免脏读)</span><br><span class=\"line\">repeatable read (可重复读-避免不可重复读，即多个事务修改同一数据，没有按照前后顺序依次进行操作)</span><br><span class=\"line\">serializable (序列化-避免幻读，即有事务在做update时，更新到了其他事务插入的数据)</span><br><span class=\"line\"></span><br><span class=\"line\">InnoDB repeatable read模式下如何避免幻读</span><br><span class=\"line\"></span><br><span class=\"line\">当前读(lock in share mode，for update)和快照读</span><br><span class=\"line\"></span><br><span class=\"line\">事务首次调用快照读的时机非常重要，若在update操作之后再进行快照读，即可以拿到最新的数据</span><br><span class=\"line\"></span><br><span class=\"line\">RC、RR级别下的InnDB的非阻塞读如何实现</span><br><span class=\"line\">1.数据行里的DB_TRX_ID、DB_ROLL_PTR、DB_ROW_ID字段(mysql中的隐藏字段)</span><br><span class=\"line\">2.undo日志</span><br><span class=\"line\">X锁锁住修改行，拷贝一份修改之前的数据到undo log，再修改对应值，PTR指针指向undolog中的拷贝数据，多次操作时，就有多个版本依次指向。</span><br><span class=\"line\">快照时就获取到undo</span><br><span class=\"line\"></span><br><span class=\"line\">3.read view</span><br><span class=\"line\">遵循一个可见性算法，主要根据当前数据的DB_TRX_ID取出和当前系统中其他活跃事务的ID进行对比，若大于事务中的ID，则通过DB_ROLL_PTR去取出undolog中上一层的DB_TRX_ID，直到小于这些活跃事务ID为止。这样就能够保证当前事务获取到的数据时当前最稳定的版本。伪MVCC机制，因为没有实现真正的多版本共存，只是串行记录了多个版本的记录。</span><br><span class=\"line\"></span><br><span class=\"line\">具体算法涉及mysql源码，不做过多深究。</span><br><span class=\"line\"></span><br><span class=\"line\">其他可探究的内容：redolog undolog binlog</span><br></pre></td></tr></table></figure>\n\n"},{"title":"回蓉番茄钟记录","date":"2020-02-11T02:42:25.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n\n## 1.缘由\n\n从北京回到四川后，遇到新冠肺炎(NCP)，在家陪家人大概两周，然后回到成都，准备开始正式进入求职阶段，由于疫情影响，决定先在家中学习，需要约束下自己，不能再放飞自我了~\n\n## 2.目的\n\n总体把控:记录每天的时间都花在哪了，程序员日常学习，不断强化自己的番茄钟效率，改掉一坐就是几个小时的炒鸡坏毛病。\n\n具体目标(道行远，笃行之):\n\n1.熟练掌握hadoop生态，netty，docker\n\n2.看两本书(记录所耗番茄钟)\n\n3.练习吉他(熟练2首歌)\n\n4.英语BEC高级\n\n5.日语N1\n\n## 3.具体实施\n\n### 目前已经得出需要注意且没形成习惯的\n\n1. 调整睡眠时间，假期时7:00起床 10:30上床睡觉\n2. 找住处时需要考虑完成番茄的环境问题，目前主要是网络、隔音效果\n3. 训练自己对于安排好的任务更坚定的去做\n4. 避免自己在10分钟内同时想做两件事而犹豫，如果出现多选且暂时无法判断的情况，立刻选择能帮助他人的选项，如果和他人没太大关系，则随意选择一件事开始坚定的做完。\n5. 训练自己对于别人的话语第一时间采用善意去解读，解读完后再多想下有没有其他可能。\n\n## 3.1 每日记录\n\n```\n2020-02-11\n\n今天是回成都的第3天，正式开始进入学习节奏。\n起床时间9:00 (这个时间出大问题，必须整改)\n洗漱+吃早饭 9:50  (这个时间可以继续优化)\n\n第一个番茄钟是五禽戏，做完时间已经来到10:20。\n第二个番茄钟是总结今天要做的事儿，并且想清楚要做的重点和需要规避的问题。\n\n1.规定晚上10点睡觉，此个番茄钟完毕后为10:55，除去中午12:00-13:30的午饭午休，18:00-19:30的晚饭。今天还剩下7.5个小时，预留1个小时备用，还剩下6.5个小时，1小时 = 2个番茄钟。\n\n所以今天最大可能还有13个番茄钟可以用。\n-----------------------------------\n学习4个番茄钟(14:40完成) (和伟伟聊他工作的事情到15:52)\n吉他2个番茄钟\n学习4个番茄钟(17:00完成 2个番茄)\n总结1个番茄钟(21:38开始)\n看书2个番茄钟\n-----------------------------------\n\n今天可能遇到的干扰番茄钟的事儿：\n\n1.取快递(只能打断，不可能让快递小哥久等)，\n2.买菜(尽量商量下完成番茄钟后再去买)，\n3.和伟伟插科打诨(尽量控制在番茄钟休息5分钟内)\n4.其他未知因素(非必须尽量优先完成番茄)\n\n每日总结：\n今天上午到14:40是按照计划执行的，之后和伟伟聊工作花了一个多小时，少了两个番茄，然后由于伟伟要在家里远程上班，不能练习吉他，改成了学习2个番茄，吃完饭之后没到19:00，大家开始邀约王者农药，此时环境已不适合继续学习，加上出门拿快递，时间又少了，还真是不够花啊。\n今日计划完成番茄:15\n实际完成番茄：9\n未完成番茄：6\n主要原因分析：1.晚饭出门买菜做饭打扫战场，一共花了2小时，比预先多半小时，剩下2.5小时被用来打农药和插科打诨。\n解决方案：调整睡眠时间，如果7点起床就会多2小时可以安排，睡觉定在22:30可以多半小时，就能弥补这段时间差。暂时如此安排。疫情告一段落且求职成功之后找住时需要考虑完成番茄的环境问题。\n```\n\n\n```\n2020-02-12\n出大问题，起床已经8:30\n由于昨天忘记买面和饺子等速食品，今天早上只能乖乖做饭，洗漱完毕8:44,做饭吃饭打扫战场完毕10:00\n\n按照昨天的经验，今天不安排这么满的番茄，今天安排和昨日实际完成量相同的9个番茄。睡前估计又会一起打农药，所以看书提早。\n\n-------------------------------\n五禽戏：1 (完成)\n个人晨会: 1 (完成)\n学习：4 (完成)\n看书：1 (未完成)\n学习: 1 (完成)\n总结: 1 (完成)\n-------------------------------\n\n今天尽量完成数据库部分的复习，日常皇帝内经记得不能再落下了。\n\n今日特别注意：今天没有把时间安排的很满，那番茄的效率一定要保证！另外早睡！早睡！早睡！\n\n每日总结：\n\n今日计划完成番茄:9\n实际完成番茄：8\n未完成番茄: 1\n\n首先，睡眠时间还是没控制住，个人懒占主要作用，其次确实不是一个人住，会有所影响。\n其次，今天下午15:00出现懵逼状态，不想游戏也不想学习，这个确实是自己的问题，分析原因可能是迷茫吧，不够笃定，没有少年的纯净，但这个其实是可以笃定的，就像别人说一句话，你第一反应是可以选择善念来解读的，而不是第一反应就质疑，反对。这个也是需要改善的。毕竟男人一生都是少年！\n再次，晚上做饭没有及时行动，处于想去做饭又想继续学习的状态，两头拉扯，没有一边最后做了。\n\n\n```\n\n\n\n","source":"_posts/回蓉番茄钟记录.md","raw":"---\ntitle: 回蓉番茄钟记录\ncategories:\n  - 2020回蓉番茄钟执行记录\ntags:\n  - 番茄钟\ndate: 2020-02-11 10:42:25\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n\n## 1.缘由\n\n从北京回到四川后，遇到新冠肺炎(NCP)，在家陪家人大概两周，然后回到成都，准备开始正式进入求职阶段，由于疫情影响，决定先在家中学习，需要约束下自己，不能再放飞自我了~\n\n## 2.目的\n\n总体把控:记录每天的时间都花在哪了，程序员日常学习，不断强化自己的番茄钟效率，改掉一坐就是几个小时的炒鸡坏毛病。\n\n具体目标(道行远，笃行之):\n\n1.熟练掌握hadoop生态，netty，docker\n\n2.看两本书(记录所耗番茄钟)\n\n3.练习吉他(熟练2首歌)\n\n4.英语BEC高级\n\n5.日语N1\n\n## 3.具体实施\n\n### 目前已经得出需要注意且没形成习惯的\n\n1. 调整睡眠时间，假期时7:00起床 10:30上床睡觉\n2. 找住处时需要考虑完成番茄的环境问题，目前主要是网络、隔音效果\n3. 训练自己对于安排好的任务更坚定的去做\n4. 避免自己在10分钟内同时想做两件事而犹豫，如果出现多选且暂时无法判断的情况，立刻选择能帮助他人的选项，如果和他人没太大关系，则随意选择一件事开始坚定的做完。\n5. 训练自己对于别人的话语第一时间采用善意去解读，解读完后再多想下有没有其他可能。\n\n## 3.1 每日记录\n\n```\n2020-02-11\n\n今天是回成都的第3天，正式开始进入学习节奏。\n起床时间9:00 (这个时间出大问题，必须整改)\n洗漱+吃早饭 9:50  (这个时间可以继续优化)\n\n第一个番茄钟是五禽戏，做完时间已经来到10:20。\n第二个番茄钟是总结今天要做的事儿，并且想清楚要做的重点和需要规避的问题。\n\n1.规定晚上10点睡觉，此个番茄钟完毕后为10:55，除去中午12:00-13:30的午饭午休，18:00-19:30的晚饭。今天还剩下7.5个小时，预留1个小时备用，还剩下6.5个小时，1小时 = 2个番茄钟。\n\n所以今天最大可能还有13个番茄钟可以用。\n-----------------------------------\n学习4个番茄钟(14:40完成) (和伟伟聊他工作的事情到15:52)\n吉他2个番茄钟\n学习4个番茄钟(17:00完成 2个番茄)\n总结1个番茄钟(21:38开始)\n看书2个番茄钟\n-----------------------------------\n\n今天可能遇到的干扰番茄钟的事儿：\n\n1.取快递(只能打断，不可能让快递小哥久等)，\n2.买菜(尽量商量下完成番茄钟后再去买)，\n3.和伟伟插科打诨(尽量控制在番茄钟休息5分钟内)\n4.其他未知因素(非必须尽量优先完成番茄)\n\n每日总结：\n今天上午到14:40是按照计划执行的，之后和伟伟聊工作花了一个多小时，少了两个番茄，然后由于伟伟要在家里远程上班，不能练习吉他，改成了学习2个番茄，吃完饭之后没到19:00，大家开始邀约王者农药，此时环境已不适合继续学习，加上出门拿快递，时间又少了，还真是不够花啊。\n今日计划完成番茄:15\n实际完成番茄：9\n未完成番茄：6\n主要原因分析：1.晚饭出门买菜做饭打扫战场，一共花了2小时，比预先多半小时，剩下2.5小时被用来打农药和插科打诨。\n解决方案：调整睡眠时间，如果7点起床就会多2小时可以安排，睡觉定在22:30可以多半小时，就能弥补这段时间差。暂时如此安排。疫情告一段落且求职成功之后找住时需要考虑完成番茄的环境问题。\n```\n\n\n```\n2020-02-12\n出大问题，起床已经8:30\n由于昨天忘记买面和饺子等速食品，今天早上只能乖乖做饭，洗漱完毕8:44,做饭吃饭打扫战场完毕10:00\n\n按照昨天的经验，今天不安排这么满的番茄，今天安排和昨日实际完成量相同的9个番茄。睡前估计又会一起打农药，所以看书提早。\n\n-------------------------------\n五禽戏：1 (完成)\n个人晨会: 1 (完成)\n学习：4 (完成)\n看书：1 (未完成)\n学习: 1 (完成)\n总结: 1 (完成)\n-------------------------------\n\n今天尽量完成数据库部分的复习，日常皇帝内经记得不能再落下了。\n\n今日特别注意：今天没有把时间安排的很满，那番茄的效率一定要保证！另外早睡！早睡！早睡！\n\n每日总结：\n\n今日计划完成番茄:9\n实际完成番茄：8\n未完成番茄: 1\n\n首先，睡眠时间还是没控制住，个人懒占主要作用，其次确实不是一个人住，会有所影响。\n其次，今天下午15:00出现懵逼状态，不想游戏也不想学习，这个确实是自己的问题，分析原因可能是迷茫吧，不够笃定，没有少年的纯净，但这个其实是可以笃定的，就像别人说一句话，你第一反应是可以选择善念来解读的，而不是第一反应就质疑，反对。这个也是需要改善的。毕竟男人一生都是少年！\n再次，晚上做饭没有及时行动，处于想去做饭又想继续学习的状态，两头拉扯，没有一边最后做了。\n\n\n```\n\n\n\n","slug":"回蓉番茄钟记录","published":1,"updated":"2020-02-12T14:30:27.212Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55gg000oogvkfm9ud0m6","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>从北京回到四川后，遇到新冠肺炎(NCP)，在家陪家人大概两周，然后回到成都，准备开始正式进入求职阶段，由于疫情影响，决定先在家中学习，需要约束下自己，不能再放飞自我了~</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>总体把控:记录每天的时间都花在哪了，程序员日常学习，不断强化自己的番茄钟效率，改掉一坐就是几个小时的炒鸡坏毛病。</p>\n<p>具体目标(道行远，笃行之):</p>\n<p>1.熟练掌握hadoop生态，netty，docker</p>\n<p>2.看两本书(记录所耗番茄钟)</p>\n<p>3.练习吉他(熟练2首歌)</p>\n<p>4.英语BEC高级</p>\n<p>5.日语N1</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><h3 id=\"目前已经得出需要注意且没形成习惯的\"><a href=\"#目前已经得出需要注意且没形成习惯的\" class=\"headerlink\" title=\"目前已经得出需要注意且没形成习惯的\"></a>目前已经得出需要注意且没形成习惯的</h3><ol>\n<li>调整睡眠时间，假期时7:00起床 10:30上床睡觉</li>\n<li>找住处时需要考虑完成番茄的环境问题，目前主要是网络、隔音效果</li>\n<li>训练自己对于安排好的任务更坚定的去做</li>\n<li>避免自己在10分钟内同时想做两件事而犹豫，如果出现多选且暂时无法判断的情况，立刻选择能帮助他人的选项，如果和他人没太大关系，则随意选择一件事开始坚定的做完。</li>\n<li>训练自己对于别人的话语第一时间采用善意去解读，解读完后再多想下有没有其他可能。</li>\n</ol>\n<h2 id=\"3-1-每日记录\"><a href=\"#3-1-每日记录\" class=\"headerlink\" title=\"3.1 每日记录\"></a>3.1 每日记录</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2020-02-11</span><br><span class=\"line\"></span><br><span class=\"line\">今天是回成都的第3天，正式开始进入学习节奏。</span><br><span class=\"line\">起床时间9:00 (这个时间出大问题，必须整改)</span><br><span class=\"line\">洗漱+吃早饭 9:50  (这个时间可以继续优化)</span><br><span class=\"line\"></span><br><span class=\"line\">第一个番茄钟是五禽戏，做完时间已经来到10:20。</span><br><span class=\"line\">第二个番茄钟是总结今天要做的事儿，并且想清楚要做的重点和需要规避的问题。</span><br><span class=\"line\"></span><br><span class=\"line\">1.规定晚上10点睡觉，此个番茄钟完毕后为10:55，除去中午12:00-13:30的午饭午休，18:00-19:30的晚饭。今天还剩下7.5个小时，预留1个小时备用，还剩下6.5个小时，1小时 = 2个番茄钟。</span><br><span class=\"line\"></span><br><span class=\"line\">所以今天最大可能还有13个番茄钟可以用。</span><br><span class=\"line\">-----------------------------------</span><br><span class=\"line\">学习4个番茄钟(14:40完成) (和伟伟聊他工作的事情到15:52)</span><br><span class=\"line\">吉他2个番茄钟</span><br><span class=\"line\">学习4个番茄钟(17:00完成 2个番茄)</span><br><span class=\"line\">总结1个番茄钟(21:38开始)</span><br><span class=\"line\">看书2个番茄钟</span><br><span class=\"line\">-----------------------------------</span><br><span class=\"line\"></span><br><span class=\"line\">今天可能遇到的干扰番茄钟的事儿：</span><br><span class=\"line\"></span><br><span class=\"line\">1.取快递(只能打断，不可能让快递小哥久等)，</span><br><span class=\"line\">2.买菜(尽量商量下完成番茄钟后再去买)，</span><br><span class=\"line\">3.和伟伟插科打诨(尽量控制在番茄钟休息5分钟内)</span><br><span class=\"line\">4.其他未知因素(非必须尽量优先完成番茄)</span><br><span class=\"line\"></span><br><span class=\"line\">每日总结：</span><br><span class=\"line\">今天上午到14:40是按照计划执行的，之后和伟伟聊工作花了一个多小时，少了两个番茄，然后由于伟伟要在家里远程上班，不能练习吉他，改成了学习2个番茄，吃完饭之后没到19:00，大家开始邀约王者农药，此时环境已不适合继续学习，加上出门拿快递，时间又少了，还真是不够花啊。</span><br><span class=\"line\">今日计划完成番茄:15</span><br><span class=\"line\">实际完成番茄：9</span><br><span class=\"line\">未完成番茄：6</span><br><span class=\"line\">主要原因分析：1.晚饭出门买菜做饭打扫战场，一共花了2小时，比预先多半小时，剩下2.5小时被用来打农药和插科打诨。</span><br><span class=\"line\">解决方案：调整睡眠时间，如果7点起床就会多2小时可以安排，睡觉定在22:30可以多半小时，就能弥补这段时间差。暂时如此安排。疫情告一段落且求职成功之后找住时需要考虑完成番茄的环境问题。</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2020-02-12</span><br><span class=\"line\">出大问题，起床已经8:30</span><br><span class=\"line\">由于昨天忘记买面和饺子等速食品，今天早上只能乖乖做饭，洗漱完毕8:44,做饭吃饭打扫战场完毕10:00</span><br><span class=\"line\"></span><br><span class=\"line\">按照昨天的经验，今天不安排这么满的番茄，今天安排和昨日实际完成量相同的9个番茄。睡前估计又会一起打农药，所以看书提早。</span><br><span class=\"line\"></span><br><span class=\"line\">-------------------------------</span><br><span class=\"line\">五禽戏：1 (完成)</span><br><span class=\"line\">个人晨会: 1 (完成)</span><br><span class=\"line\">学习：4 (完成)</span><br><span class=\"line\">看书：1 (未完成)</span><br><span class=\"line\">学习: 1 (完成)</span><br><span class=\"line\">总结: 1 (完成)</span><br><span class=\"line\">-------------------------------</span><br><span class=\"line\"></span><br><span class=\"line\">今天尽量完成数据库部分的复习，日常皇帝内经记得不能再落下了。</span><br><span class=\"line\"></span><br><span class=\"line\">今日特别注意：今天没有把时间安排的很满，那番茄的效率一定要保证！另外早睡！早睡！早睡！</span><br><span class=\"line\"></span><br><span class=\"line\">每日总结：</span><br><span class=\"line\"></span><br><span class=\"line\">今日计划完成番茄:9</span><br><span class=\"line\">实际完成番茄：8</span><br><span class=\"line\">未完成番茄: 1</span><br><span class=\"line\"></span><br><span class=\"line\">首先，睡眠时间还是没控制住，个人懒占主要作用，其次确实不是一个人住，会有所影响。</span><br><span class=\"line\">其次，今天下午15:00出现懵逼状态，不想游戏也不想学习，这个确实是自己的问题，分析原因可能是迷茫吧，不够笃定，没有少年的纯净，但这个其实是可以笃定的，就像别人说一句话，你第一反应是可以选择善念来解读的，而不是第一反应就质疑，反对。这个也是需要改善的。毕竟男人一生都是少年！</span><br><span class=\"line\">再次，晚上做饭没有及时行动，处于想去做饭又想继续学习的状态，两头拉扯，没有一边最后做了。</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>从北京回到四川后，遇到新冠肺炎(NCP)，在家陪家人大概两周，然后回到成都，准备开始正式进入求职阶段，由于疫情影响，决定先在家中学习，需要约束下自己，不能再放飞自我了~</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>总体把控:记录每天的时间都花在哪了，程序员日常学习，不断强化自己的番茄钟效率，改掉一坐就是几个小时的炒鸡坏毛病。</p>\n<p>具体目标(道行远，笃行之):</p>\n<p>1.熟练掌握hadoop生态，netty，docker</p>\n<p>2.看两本书(记录所耗番茄钟)</p>\n<p>3.练习吉他(熟练2首歌)</p>\n<p>4.英语BEC高级</p>\n<p>5.日语N1</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><h3 id=\"目前已经得出需要注意且没形成习惯的\"><a href=\"#目前已经得出需要注意且没形成习惯的\" class=\"headerlink\" title=\"目前已经得出需要注意且没形成习惯的\"></a>目前已经得出需要注意且没形成习惯的</h3><ol>\n<li>调整睡眠时间，假期时7:00起床 10:30上床睡觉</li>\n<li>找住处时需要考虑完成番茄的环境问题，目前主要是网络、隔音效果</li>\n<li>训练自己对于安排好的任务更坚定的去做</li>\n<li>避免自己在10分钟内同时想做两件事而犹豫，如果出现多选且暂时无法判断的情况，立刻选择能帮助他人的选项，如果和他人没太大关系，则随意选择一件事开始坚定的做完。</li>\n<li>训练自己对于别人的话语第一时间采用善意去解读，解读完后再多想下有没有其他可能。</li>\n</ol>\n<h2 id=\"3-1-每日记录\"><a href=\"#3-1-每日记录\" class=\"headerlink\" title=\"3.1 每日记录\"></a>3.1 每日记录</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2020-02-11</span><br><span class=\"line\"></span><br><span class=\"line\">今天是回成都的第3天，正式开始进入学习节奏。</span><br><span class=\"line\">起床时间9:00 (这个时间出大问题，必须整改)</span><br><span class=\"line\">洗漱+吃早饭 9:50  (这个时间可以继续优化)</span><br><span class=\"line\"></span><br><span class=\"line\">第一个番茄钟是五禽戏，做完时间已经来到10:20。</span><br><span class=\"line\">第二个番茄钟是总结今天要做的事儿，并且想清楚要做的重点和需要规避的问题。</span><br><span class=\"line\"></span><br><span class=\"line\">1.规定晚上10点睡觉，此个番茄钟完毕后为10:55，除去中午12:00-13:30的午饭午休，18:00-19:30的晚饭。今天还剩下7.5个小时，预留1个小时备用，还剩下6.5个小时，1小时 = 2个番茄钟。</span><br><span class=\"line\"></span><br><span class=\"line\">所以今天最大可能还有13个番茄钟可以用。</span><br><span class=\"line\">-----------------------------------</span><br><span class=\"line\">学习4个番茄钟(14:40完成) (和伟伟聊他工作的事情到15:52)</span><br><span class=\"line\">吉他2个番茄钟</span><br><span class=\"line\">学习4个番茄钟(17:00完成 2个番茄)</span><br><span class=\"line\">总结1个番茄钟(21:38开始)</span><br><span class=\"line\">看书2个番茄钟</span><br><span class=\"line\">-----------------------------------</span><br><span class=\"line\"></span><br><span class=\"line\">今天可能遇到的干扰番茄钟的事儿：</span><br><span class=\"line\"></span><br><span class=\"line\">1.取快递(只能打断，不可能让快递小哥久等)，</span><br><span class=\"line\">2.买菜(尽量商量下完成番茄钟后再去买)，</span><br><span class=\"line\">3.和伟伟插科打诨(尽量控制在番茄钟休息5分钟内)</span><br><span class=\"line\">4.其他未知因素(非必须尽量优先完成番茄)</span><br><span class=\"line\"></span><br><span class=\"line\">每日总结：</span><br><span class=\"line\">今天上午到14:40是按照计划执行的，之后和伟伟聊工作花了一个多小时，少了两个番茄，然后由于伟伟要在家里远程上班，不能练习吉他，改成了学习2个番茄，吃完饭之后没到19:00，大家开始邀约王者农药，此时环境已不适合继续学习，加上出门拿快递，时间又少了，还真是不够花啊。</span><br><span class=\"line\">今日计划完成番茄:15</span><br><span class=\"line\">实际完成番茄：9</span><br><span class=\"line\">未完成番茄：6</span><br><span class=\"line\">主要原因分析：1.晚饭出门买菜做饭打扫战场，一共花了2小时，比预先多半小时，剩下2.5小时被用来打农药和插科打诨。</span><br><span class=\"line\">解决方案：调整睡眠时间，如果7点起床就会多2小时可以安排，睡觉定在22:30可以多半小时，就能弥补这段时间差。暂时如此安排。疫情告一段落且求职成功之后找住时需要考虑完成番茄的环境问题。</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">2020-02-12</span><br><span class=\"line\">出大问题，起床已经8:30</span><br><span class=\"line\">由于昨天忘记买面和饺子等速食品，今天早上只能乖乖做饭，洗漱完毕8:44,做饭吃饭打扫战场完毕10:00</span><br><span class=\"line\"></span><br><span class=\"line\">按照昨天的经验，今天不安排这么满的番茄，今天安排和昨日实际完成量相同的9个番茄。睡前估计又会一起打农药，所以看书提早。</span><br><span class=\"line\"></span><br><span class=\"line\">-------------------------------</span><br><span class=\"line\">五禽戏：1 (完成)</span><br><span class=\"line\">个人晨会: 1 (完成)</span><br><span class=\"line\">学习：4 (完成)</span><br><span class=\"line\">看书：1 (未完成)</span><br><span class=\"line\">学习: 1 (完成)</span><br><span class=\"line\">总结: 1 (完成)</span><br><span class=\"line\">-------------------------------</span><br><span class=\"line\"></span><br><span class=\"line\">今天尽量完成数据库部分的复习，日常皇帝内经记得不能再落下了。</span><br><span class=\"line\"></span><br><span class=\"line\">今日特别注意：今天没有把时间安排的很满，那番茄的效率一定要保证！另外早睡！早睡！早睡！</span><br><span class=\"line\"></span><br><span class=\"line\">每日总结：</span><br><span class=\"line\"></span><br><span class=\"line\">今日计划完成番茄:9</span><br><span class=\"line\">实际完成番茄：8</span><br><span class=\"line\">未完成番茄: 1</span><br><span class=\"line\"></span><br><span class=\"line\">首先，睡眠时间还是没控制住，个人懒占主要作用，其次确实不是一个人住，会有所影响。</span><br><span class=\"line\">其次，今天下午15:00出现懵逼状态，不想游戏也不想学习，这个确实是自己的问题，分析原因可能是迷茫吧，不够笃定，没有少年的纯净，但这个其实是可以笃定的，就像别人说一句话，你第一反应是可以选择善念来解读的，而不是第一反应就质疑，反对。这个也是需要改善的。毕竟男人一生都是少年！</span><br><span class=\"line\">再次，晚上做饭没有及时行动，处于想去做饭又想继续学习的状态，两头拉扯，没有一边最后做了。</span><br></pre></td></tr></table></figure>\n\n"},{"title":"大文本文件处理-Tar命令压缩_解压缩","date":"2019-10-13T03:37:34.000Z","_content":"\n\n### 目录\n* [1.缘由](#缘由)\n* [2.目的](#目的)\n* [3.具体实施](#目的)\n    * [3.1 准备工具](#准备工具)\n    * [3.2 实施并验证](#实施并验证)\n* [4.为什么采用以上方式](#为什么采用以上方式)\n\n## 缘由\n\n近期接到一个需求，需要从内网提取数据，数据是文本格式的，由于内网速度受限，\n首先想到的就是压缩文件，于是研究了一下压缩文本传输的方式。\n\n## 目的\n\n在Linux中对大本文文件进行压缩，并加密解密\n\n## 具体实施\n\n## 准备工具\n\n* 系统：centos7\n* 工具包: tar,openssl\n* 待处理的文件: test.txt (本文准备的文件大小在4G左右)\n\n## 实施并验证\n\ntar指令核心参数：\n\n|参数  | 说明 |\n| :----------:| :-----------:| \n|-j   |以bzip2方式压缩      |\n|-z   |以gzip方式压缩      |\n|-c   |建立新的备份文件      |\n|-f   |指定备份文件      |\n|-v   |显示指令执行过程      |\n|-x   |从备份文件中还原文件      |\n\n\n\n**1.使用tar进行压缩和解压**\n\n```\n压缩： tar -jcvf ./test.tar.bz2 ./test.txt\n\n解压： tar -jxf ./test.tar.bz2\n```\n\n**2.使用tar + openssl进行压缩和解压**\n\n```\n压缩： tar -jcvf ./test.txt | openssl des3 -salt -k <password> -out ./test.tar.bz2\n\n解压： openssl des3 -d -k <password> -salt -in /test.tar.bz2 | tar jxf -\n```\n\n## 为什么采用以上方式\n\n**采用bzip2**\n\n相对于gzip压缩速度慢，但压缩效果好\n\n**采用gzip**\n\n相对bzip2压缩速度快，但压缩效果差\n\n**对比实例**\n\n压缩981M的text.txt\n\n**gzip：**\n\ntime tar  -zcvf ./test.tar.gz ./test.txt\n\nreal    0m22.177s\nuser    0m21.874s\nsys     0m1.006s\n\n131M test.tar.gz\n\n**bzip2：**\n\ntime tar -jcvf test.tar.bz2 ./test.txt\n\nreal    3m1.416s\nuser    3m0.875s\nsys     0m1.638s\n\n99M test.tar.bz2","source":"_posts/大文本文件处理-Tar命令压缩-解压缩.md","raw":"---\ntitle: 大文本文件处理-Tar命令压缩_解压缩\ndate: 2019-10-13 11:37:34\ncategories:\n- 工具\ntags:\n- Linux\n- Tar\n- 压缩解压缩\n- 加密解密\n- 大文本\n---\n\n\n### 目录\n* [1.缘由](#缘由)\n* [2.目的](#目的)\n* [3.具体实施](#目的)\n    * [3.1 准备工具](#准备工具)\n    * [3.2 实施并验证](#实施并验证)\n* [4.为什么采用以上方式](#为什么采用以上方式)\n\n## 缘由\n\n近期接到一个需求，需要从内网提取数据，数据是文本格式的，由于内网速度受限，\n首先想到的就是压缩文件，于是研究了一下压缩文本传输的方式。\n\n## 目的\n\n在Linux中对大本文文件进行压缩，并加密解密\n\n## 具体实施\n\n## 准备工具\n\n* 系统：centos7\n* 工具包: tar,openssl\n* 待处理的文件: test.txt (本文准备的文件大小在4G左右)\n\n## 实施并验证\n\ntar指令核心参数：\n\n|参数  | 说明 |\n| :----------:| :-----------:| \n|-j   |以bzip2方式压缩      |\n|-z   |以gzip方式压缩      |\n|-c   |建立新的备份文件      |\n|-f   |指定备份文件      |\n|-v   |显示指令执行过程      |\n|-x   |从备份文件中还原文件      |\n\n\n\n**1.使用tar进行压缩和解压**\n\n```\n压缩： tar -jcvf ./test.tar.bz2 ./test.txt\n\n解压： tar -jxf ./test.tar.bz2\n```\n\n**2.使用tar + openssl进行压缩和解压**\n\n```\n压缩： tar -jcvf ./test.txt | openssl des3 -salt -k <password> -out ./test.tar.bz2\n\n解压： openssl des3 -d -k <password> -salt -in /test.tar.bz2 | tar jxf -\n```\n\n## 为什么采用以上方式\n\n**采用bzip2**\n\n相对于gzip压缩速度慢，但压缩效果好\n\n**采用gzip**\n\n相对bzip2压缩速度快，但压缩效果差\n\n**对比实例**\n\n压缩981M的text.txt\n\n**gzip：**\n\ntime tar  -zcvf ./test.tar.gz ./test.txt\n\nreal    0m22.177s\nuser    0m21.874s\nsys     0m1.006s\n\n131M test.tar.gz\n\n**bzip2：**\n\ntime tar -jcvf test.tar.bz2 ./test.txt\n\nreal    3m1.416s\nuser    3m0.875s\nsys     0m1.638s\n\n99M test.tar.bz2","slug":"大文本文件处理-Tar命令压缩-解压缩","published":1,"updated":"2020-02-10T07:35:40.269Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55gh000sogvkpiom5mh3","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#缘由\">1.缘由</a></li>\n<li><a href=\"#目的\">2.目的</a></li>\n<li><a href=\"#目的\">3.具体实施</a><ul>\n<li><a href=\"#准备工具\">3.1 准备工具</a></li>\n<li><a href=\"#实施并验证\">3.2 实施并验证</a></li>\n</ul>\n</li>\n<li><a href=\"#为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"缘由\"><a href=\"#缘由\" class=\"headerlink\" title=\"缘由\"></a>缘由</h2><p>近期接到一个需求，需要从内网提取数据，数据是文本格式的，由于内网速度受限，<br>首先想到的就是压缩文件，于是研究了一下压缩文本传输的方式。</p>\n<h2 id=\"目的\"><a href=\"#目的\" class=\"headerlink\" title=\"目的\"></a>目的</h2><p>在Linux中对大本文文件进行压缩，并加密解密</p>\n<h2 id=\"具体实施\"><a href=\"#具体实施\" class=\"headerlink\" title=\"具体实施\"></a>具体实施</h2><h2 id=\"准备工具\"><a href=\"#准备工具\" class=\"headerlink\" title=\"准备工具\"></a>准备工具</h2><ul>\n<li>系统：centos7</li>\n<li>工具包: tar,openssl</li>\n<li>待处理的文件: test.txt (本文准备的文件大小在4G左右)</li>\n</ul>\n<h2 id=\"实施并验证\"><a href=\"#实施并验证\" class=\"headerlink\" title=\"实施并验证\"></a>实施并验证</h2><p>tar指令核心参数：</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">参数</th>\n<th align=\"center\">说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-j</td>\n<td align=\"center\">以bzip2方式压缩</td>\n</tr>\n<tr>\n<td align=\"center\">-z</td>\n<td align=\"center\">以gzip方式压缩</td>\n</tr>\n<tr>\n<td align=\"center\">-c</td>\n<td align=\"center\">建立新的备份文件</td>\n</tr>\n<tr>\n<td align=\"center\">-f</td>\n<td align=\"center\">指定备份文件</td>\n</tr>\n<tr>\n<td align=\"center\">-v</td>\n<td align=\"center\">显示指令执行过程</td>\n</tr>\n<tr>\n<td align=\"center\">-x</td>\n<td align=\"center\">从备份文件中还原文件</td>\n</tr>\n</tbody></table>\n<p><strong>1.使用tar进行压缩和解压</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">压缩： tar -jcvf ./test.tar.bz2 ./test.txt</span><br><span class=\"line\"></span><br><span class=\"line\">解压： tar -jxf ./test.tar.bz2</span><br></pre></td></tr></table></figure>\n\n<p><strong>2.使用tar + openssl进行压缩和解压</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">压缩： tar -jcvf ./test.txt | openssl des3 -salt -k &lt;password&gt; -out ./test.tar.bz2</span><br><span class=\"line\"></span><br><span class=\"line\">解压： openssl des3 -d -k &lt;password&gt; -salt -in /test.tar.bz2 | tar jxf -</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"为什么采用以上方式\"><a href=\"#为什么采用以上方式\" class=\"headerlink\" title=\"为什么采用以上方式\"></a>为什么采用以上方式</h2><p><strong>采用bzip2</strong></p>\n<p>相对于gzip压缩速度慢，但压缩效果好</p>\n<p><strong>采用gzip</strong></p>\n<p>相对bzip2压缩速度快，但压缩效果差</p>\n<p><strong>对比实例</strong></p>\n<p>压缩981M的text.txt</p>\n<p><strong>gzip：</strong></p>\n<p>time tar  -zcvf ./test.tar.gz ./test.txt</p>\n<p>real    0m22.177s<br>user    0m21.874s<br>sys     0m1.006s</p>\n<p>131M test.tar.gz</p>\n<p><strong>bzip2：</strong></p>\n<p>time tar -jcvf test.tar.bz2 ./test.txt</p>\n<p>real    3m1.416s<br>user    3m0.875s<br>sys     0m1.638s</p>\n<p>99M test.tar.bz2</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#缘由\">1.缘由</a></li>\n<li><a href=\"#目的\">2.目的</a></li>\n<li><a href=\"#目的\">3.具体实施</a><ul>\n<li><a href=\"#准备工具\">3.1 准备工具</a></li>\n<li><a href=\"#实施并验证\">3.2 实施并验证</a></li>\n</ul>\n</li>\n<li><a href=\"#为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"缘由\"><a href=\"#缘由\" class=\"headerlink\" title=\"缘由\"></a>缘由</h2><p>近期接到一个需求，需要从内网提取数据，数据是文本格式的，由于内网速度受限，<br>首先想到的就是压缩文件，于是研究了一下压缩文本传输的方式。</p>\n<h2 id=\"目的\"><a href=\"#目的\" class=\"headerlink\" title=\"目的\"></a>目的</h2><p>在Linux中对大本文文件进行压缩，并加密解密</p>\n<h2 id=\"具体实施\"><a href=\"#具体实施\" class=\"headerlink\" title=\"具体实施\"></a>具体实施</h2><h2 id=\"准备工具\"><a href=\"#准备工具\" class=\"headerlink\" title=\"准备工具\"></a>准备工具</h2><ul>\n<li>系统：centos7</li>\n<li>工具包: tar,openssl</li>\n<li>待处理的文件: test.txt (本文准备的文件大小在4G左右)</li>\n</ul>\n<h2 id=\"实施并验证\"><a href=\"#实施并验证\" class=\"headerlink\" title=\"实施并验证\"></a>实施并验证</h2><p>tar指令核心参数：</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\">参数</th>\n<th align=\"center\">说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">-j</td>\n<td align=\"center\">以bzip2方式压缩</td>\n</tr>\n<tr>\n<td align=\"center\">-z</td>\n<td align=\"center\">以gzip方式压缩</td>\n</tr>\n<tr>\n<td align=\"center\">-c</td>\n<td align=\"center\">建立新的备份文件</td>\n</tr>\n<tr>\n<td align=\"center\">-f</td>\n<td align=\"center\">指定备份文件</td>\n</tr>\n<tr>\n<td align=\"center\">-v</td>\n<td align=\"center\">显示指令执行过程</td>\n</tr>\n<tr>\n<td align=\"center\">-x</td>\n<td align=\"center\">从备份文件中还原文件</td>\n</tr>\n</tbody></table>\n<p><strong>1.使用tar进行压缩和解压</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">压缩： tar -jcvf ./test.tar.bz2 ./test.txt</span><br><span class=\"line\"></span><br><span class=\"line\">解压： tar -jxf ./test.tar.bz2</span><br></pre></td></tr></table></figure>\n\n<p><strong>2.使用tar + openssl进行压缩和解压</strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">压缩： tar -jcvf ./test.txt | openssl des3 -salt -k &lt;password&gt; -out ./test.tar.bz2</span><br><span class=\"line\"></span><br><span class=\"line\">解压： openssl des3 -d -k &lt;password&gt; -salt -in /test.tar.bz2 | tar jxf -</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"为什么采用以上方式\"><a href=\"#为什么采用以上方式\" class=\"headerlink\" title=\"为什么采用以上方式\"></a>为什么采用以上方式</h2><p><strong>采用bzip2</strong></p>\n<p>相对于gzip压缩速度慢，但压缩效果好</p>\n<p><strong>采用gzip</strong></p>\n<p>相对bzip2压缩速度快，但压缩效果差</p>\n<p><strong>对比实例</strong></p>\n<p>压缩981M的text.txt</p>\n<p><strong>gzip：</strong></p>\n<p>time tar  -zcvf ./test.tar.gz ./test.txt</p>\n<p>real    0m22.177s<br>user    0m21.874s<br>sys     0m1.006s</p>\n<p>131M test.tar.gz</p>\n<p><strong>bzip2：</strong></p>\n<p>time tar -jcvf test.tar.bz2 ./test.txt</p>\n<p>real    3m1.416s<br>user    3m0.875s<br>sys     0m1.638s</p>\n<p>99M test.tar.bz2</p>\n"},{"title":"小组分享记录(持续更新)","date":"2019-10-16T11:51:57.000Z","_content":"\n### 目录\n\n* [1.记录](#记录)\n* [2.缘由](#缘由)\n* [3.目的](#目的)\n* [4.具体实施](#具体实施)\n\n## 记录\n\n### Todo需求记录\n* jsp-->>html √\n* spring-cloud √ spring-cloud-02(springboot2) √\n* Vue √ Vue-02(组件化)\n* Mysql锁机制-01 √ mysql-锁机制-02 事务隔离级别不同时锁的变化 \n* NIO √ NIO-02\n* NodeJs\n* Dubbo\n* Kafka\n\n\n\n### 2019-12-25\n\n小秀同学2019-12-25分享“Vue-02组件化”\n\n确定小F同学2020-1-4分享“大文件对比”\n\n### 2019-12-18\n\n小H同学2019-12-18分享\"WebService服务调用\"\n\n### 2019-12-11\n\n小S同学12-11分享 \"Mysql锁机制\"\n\n小F同学提出需求“mysql-锁机制-02 事务隔离级别不同时锁的变化”\n\n确定小秀同学2019-12-25分享“Vue-02组件化”\n\n### 2019-12-04\n\n小F同学12-04分享\"spring-cloud-02(springboot2) skywalking简单使用\"\n\n小H同学提出需求\"Kafka\"\n\n确认小H同学2019-12-18分享\"WebService服务调用\"\n\n### 2019-11-27\n\n小生同学和小广同学11-27分享\"NIO,Netty基础\"\n\n小F同学提出需求 \"NIO - 02\"\n\n确认小S同学12-11分享 \"Mysql锁机制\"\n\n### 2019-11-20\n\n小秀同学分享\"vue项目创建过程\"\n\n小F同学提出需求 \"Vue-02(组件化)\"\n\n小S同学提出需求 \"Mysql锁机制\"\n\n小广同学提出需求 \"spring-cloud-02(springboot2)\"\n\n确定小F同学12-04分享\"spring-cloud-02(springboot2)\"\n\n### 2019-11-13\n\n小F同学分享\"Spring-Cloud基础微服务快速搭建(springboot1)\"\n\n确定小生同学和小广同学11-27分享\"NIO,Netty基础\"\n\n### 2019-11-06\n\n小F同学分享\"JSP转HTML，EL表达式替换方式\"\n\n小J同学提出需求 \"Spring-cloud基础应用\"\n\n确定小秀同学11-20分享\"vue方式实现基础表格页面\"\n\n### 2019-10-30\n\n小Q和小H同学分享\"VoLTE告警派单整体流程\"\n\n确定11-13小F同学分享\"Spring-cloud基础应用\"\n\n### 2019-10-23\n\n确定11-6 由小F同学分享\"jsp和html相关知识\"\n\n小S同学分享\"redis基础知识以及单节点/集群部署\"\n\n小X同学提出需求 \"想了解下jsp-->>html\"\n\n小L同学提出需求 \"想了解下NIO\"\n\n小秀同学提出需求 \"NodeJs\"\n\n小S同学提出需求 \"Dubbo\"\n\n### 2019-10-16\n\n讨论分享会执行方式\n\n确定10-23 由小S同学分享\"redis基础知识以及单节点/集群部署\"\n\n确定10-30 由小Q和小H同学分享\"VoLTE告警派单整体流程\"\n\n### 2019-10-9\n\n确定每周三进行分享会\n\n## 缘由\n\n19年为了响应大家的学习渴求，公司成立了技术小组，让各个小组自行组织学习，北京学习小组应运而生。\n\n## 目的\n\n创造公司个人双赢的局面，为公司留下更可靠的文档，为个人成为更好的自己。\n\n## 具体实施\n\n**时间**\n\n6:00 去吃饭\n\n6:30 - 7:00 开始分享会\n\n结束时间 <= 8:00\n\n**流程**\n\n讲师：每周1-2位同学讲自己总结的业务或技术问题。时间控制在1小时以内，分为40分钟讲解，10分钟答疑，10分钟提问\n\n学员：40分钟讲解过程中，记录自己的相关问题，在10分钟答疑环节尽量能简介的提问。\n\n奖励制度：//todo\n\n惩罚制度：//todo\n","source":"_posts/小组分享记录.md","raw":"---\ntitle: 小组分享记录(持续更新)\ndate: 2019-10-16 19:51:57\ncategories:\n- sendi趣味\ntags:\n- sendi\n---\n\n### 目录\n\n* [1.记录](#记录)\n* [2.缘由](#缘由)\n* [3.目的](#目的)\n* [4.具体实施](#具体实施)\n\n## 记录\n\n### Todo需求记录\n* jsp-->>html √\n* spring-cloud √ spring-cloud-02(springboot2) √\n* Vue √ Vue-02(组件化)\n* Mysql锁机制-01 √ mysql-锁机制-02 事务隔离级别不同时锁的变化 \n* NIO √ NIO-02\n* NodeJs\n* Dubbo\n* Kafka\n\n\n\n### 2019-12-25\n\n小秀同学2019-12-25分享“Vue-02组件化”\n\n确定小F同学2020-1-4分享“大文件对比”\n\n### 2019-12-18\n\n小H同学2019-12-18分享\"WebService服务调用\"\n\n### 2019-12-11\n\n小S同学12-11分享 \"Mysql锁机制\"\n\n小F同学提出需求“mysql-锁机制-02 事务隔离级别不同时锁的变化”\n\n确定小秀同学2019-12-25分享“Vue-02组件化”\n\n### 2019-12-04\n\n小F同学12-04分享\"spring-cloud-02(springboot2) skywalking简单使用\"\n\n小H同学提出需求\"Kafka\"\n\n确认小H同学2019-12-18分享\"WebService服务调用\"\n\n### 2019-11-27\n\n小生同学和小广同学11-27分享\"NIO,Netty基础\"\n\n小F同学提出需求 \"NIO - 02\"\n\n确认小S同学12-11分享 \"Mysql锁机制\"\n\n### 2019-11-20\n\n小秀同学分享\"vue项目创建过程\"\n\n小F同学提出需求 \"Vue-02(组件化)\"\n\n小S同学提出需求 \"Mysql锁机制\"\n\n小广同学提出需求 \"spring-cloud-02(springboot2)\"\n\n确定小F同学12-04分享\"spring-cloud-02(springboot2)\"\n\n### 2019-11-13\n\n小F同学分享\"Spring-Cloud基础微服务快速搭建(springboot1)\"\n\n确定小生同学和小广同学11-27分享\"NIO,Netty基础\"\n\n### 2019-11-06\n\n小F同学分享\"JSP转HTML，EL表达式替换方式\"\n\n小J同学提出需求 \"Spring-cloud基础应用\"\n\n确定小秀同学11-20分享\"vue方式实现基础表格页面\"\n\n### 2019-10-30\n\n小Q和小H同学分享\"VoLTE告警派单整体流程\"\n\n确定11-13小F同学分享\"Spring-cloud基础应用\"\n\n### 2019-10-23\n\n确定11-6 由小F同学分享\"jsp和html相关知识\"\n\n小S同学分享\"redis基础知识以及单节点/集群部署\"\n\n小X同学提出需求 \"想了解下jsp-->>html\"\n\n小L同学提出需求 \"想了解下NIO\"\n\n小秀同学提出需求 \"NodeJs\"\n\n小S同学提出需求 \"Dubbo\"\n\n### 2019-10-16\n\n讨论分享会执行方式\n\n确定10-23 由小S同学分享\"redis基础知识以及单节点/集群部署\"\n\n确定10-30 由小Q和小H同学分享\"VoLTE告警派单整体流程\"\n\n### 2019-10-9\n\n确定每周三进行分享会\n\n## 缘由\n\n19年为了响应大家的学习渴求，公司成立了技术小组，让各个小组自行组织学习，北京学习小组应运而生。\n\n## 目的\n\n创造公司个人双赢的局面，为公司留下更可靠的文档，为个人成为更好的自己。\n\n## 具体实施\n\n**时间**\n\n6:00 去吃饭\n\n6:30 - 7:00 开始分享会\n\n结束时间 <= 8:00\n\n**流程**\n\n讲师：每周1-2位同学讲自己总结的业务或技术问题。时间控制在1小时以内，分为40分钟讲解，10分钟答疑，10分钟提问\n\n学员：40分钟讲解过程中，记录自己的相关问题，在10分钟答疑环节尽量能简介的提问。\n\n奖励制度：//todo\n\n惩罚制度：//todo\n","slug":"小组分享记录","published":1,"updated":"2020-02-10T07:35:40.269Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55gi000vogvkurcuqnxa","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#记录\">1.记录</a></li>\n<li><a href=\"#缘由\">2.缘由</a></li>\n<li><a href=\"#目的\">3.目的</a></li>\n<li><a href=\"#具体实施\">4.具体实施</a></li>\n</ul>\n<h2 id=\"记录\"><a href=\"#记录\" class=\"headerlink\" title=\"记录\"></a>记录</h2><h3 id=\"Todo需求记录\"><a href=\"#Todo需求记录\" class=\"headerlink\" title=\"Todo需求记录\"></a>Todo需求记录</h3><ul>\n<li>jsp–&gt;&gt;html √</li>\n<li>spring-cloud √ spring-cloud-02(springboot2) √</li>\n<li>Vue √ Vue-02(组件化)</li>\n<li>Mysql锁机制-01 √ mysql-锁机制-02 事务隔离级别不同时锁的变化 </li>\n<li>NIO √ NIO-02</li>\n<li>NodeJs</li>\n<li>Dubbo</li>\n<li>Kafka</li>\n</ul>\n<h3 id=\"2019-12-25\"><a href=\"#2019-12-25\" class=\"headerlink\" title=\"2019-12-25\"></a>2019-12-25</h3><p>小秀同学2019-12-25分享“Vue-02组件化”</p>\n<p>确定小F同学2020-1-4分享“大文件对比”</p>\n<h3 id=\"2019-12-18\"><a href=\"#2019-12-18\" class=\"headerlink\" title=\"2019-12-18\"></a>2019-12-18</h3><p>小H同学2019-12-18分享”WebService服务调用”</p>\n<h3 id=\"2019-12-11\"><a href=\"#2019-12-11\" class=\"headerlink\" title=\"2019-12-11\"></a>2019-12-11</h3><p>小S同学12-11分享 “Mysql锁机制”</p>\n<p>小F同学提出需求“mysql-锁机制-02 事务隔离级别不同时锁的变化”</p>\n<p>确定小秀同学2019-12-25分享“Vue-02组件化”</p>\n<h3 id=\"2019-12-04\"><a href=\"#2019-12-04\" class=\"headerlink\" title=\"2019-12-04\"></a>2019-12-04</h3><p>小F同学12-04分享”spring-cloud-02(springboot2) skywalking简单使用”</p>\n<p>小H同学提出需求”Kafka”</p>\n<p>确认小H同学2019-12-18分享”WebService服务调用”</p>\n<h3 id=\"2019-11-27\"><a href=\"#2019-11-27\" class=\"headerlink\" title=\"2019-11-27\"></a>2019-11-27</h3><p>小生同学和小广同学11-27分享”NIO,Netty基础”</p>\n<p>小F同学提出需求 “NIO - 02”</p>\n<p>确认小S同学12-11分享 “Mysql锁机制”</p>\n<h3 id=\"2019-11-20\"><a href=\"#2019-11-20\" class=\"headerlink\" title=\"2019-11-20\"></a>2019-11-20</h3><p>小秀同学分享”vue项目创建过程”</p>\n<p>小F同学提出需求 “Vue-02(组件化)”</p>\n<p>小S同学提出需求 “Mysql锁机制”</p>\n<p>小广同学提出需求 “spring-cloud-02(springboot2)”</p>\n<p>确定小F同学12-04分享”spring-cloud-02(springboot2)”</p>\n<h3 id=\"2019-11-13\"><a href=\"#2019-11-13\" class=\"headerlink\" title=\"2019-11-13\"></a>2019-11-13</h3><p>小F同学分享”Spring-Cloud基础微服务快速搭建(springboot1)”</p>\n<p>确定小生同学和小广同学11-27分享”NIO,Netty基础”</p>\n<h3 id=\"2019-11-06\"><a href=\"#2019-11-06\" class=\"headerlink\" title=\"2019-11-06\"></a>2019-11-06</h3><p>小F同学分享”JSP转HTML，EL表达式替换方式”</p>\n<p>小J同学提出需求 “Spring-cloud基础应用”</p>\n<p>确定小秀同学11-20分享”vue方式实现基础表格页面”</p>\n<h3 id=\"2019-10-30\"><a href=\"#2019-10-30\" class=\"headerlink\" title=\"2019-10-30\"></a>2019-10-30</h3><p>小Q和小H同学分享”VoLTE告警派单整体流程”</p>\n<p>确定11-13小F同学分享”Spring-cloud基础应用”</p>\n<h3 id=\"2019-10-23\"><a href=\"#2019-10-23\" class=\"headerlink\" title=\"2019-10-23\"></a>2019-10-23</h3><p>确定11-6 由小F同学分享”jsp和html相关知识”</p>\n<p>小S同学分享”redis基础知识以及单节点/集群部署”</p>\n<p>小X同学提出需求 “想了解下jsp–&gt;&gt;html”</p>\n<p>小L同学提出需求 “想了解下NIO”</p>\n<p>小秀同学提出需求 “NodeJs”</p>\n<p>小S同学提出需求 “Dubbo”</p>\n<h3 id=\"2019-10-16\"><a href=\"#2019-10-16\" class=\"headerlink\" title=\"2019-10-16\"></a>2019-10-16</h3><p>讨论分享会执行方式</p>\n<p>确定10-23 由小S同学分享”redis基础知识以及单节点/集群部署”</p>\n<p>确定10-30 由小Q和小H同学分享”VoLTE告警派单整体流程”</p>\n<h3 id=\"2019-10-9\"><a href=\"#2019-10-9\" class=\"headerlink\" title=\"2019-10-9\"></a>2019-10-9</h3><p>确定每周三进行分享会</p>\n<h2 id=\"缘由\"><a href=\"#缘由\" class=\"headerlink\" title=\"缘由\"></a>缘由</h2><p>19年为了响应大家的学习渴求，公司成立了技术小组，让各个小组自行组织学习，北京学习小组应运而生。</p>\n<h2 id=\"目的\"><a href=\"#目的\" class=\"headerlink\" title=\"目的\"></a>目的</h2><p>创造公司个人双赢的局面，为公司留下更可靠的文档，为个人成为更好的自己。</p>\n<h2 id=\"具体实施\"><a href=\"#具体实施\" class=\"headerlink\" title=\"具体实施\"></a>具体实施</h2><p><strong>时间</strong></p>\n<p>6:00 去吃饭</p>\n<p>6:30 - 7:00 开始分享会</p>\n<p>结束时间 &lt;= 8:00</p>\n<p><strong>流程</strong></p>\n<p>讲师：每周1-2位同学讲自己总结的业务或技术问题。时间控制在1小时以内，分为40分钟讲解，10分钟答疑，10分钟提问</p>\n<p>学员：40分钟讲解过程中，记录自己的相关问题，在10分钟答疑环节尽量能简介的提问。</p>\n<p>奖励制度：//todo</p>\n<p>惩罚制度：//todo</p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#记录\">1.记录</a></li>\n<li><a href=\"#缘由\">2.缘由</a></li>\n<li><a href=\"#目的\">3.目的</a></li>\n<li><a href=\"#具体实施\">4.具体实施</a></li>\n</ul>\n<h2 id=\"记录\"><a href=\"#记录\" class=\"headerlink\" title=\"记录\"></a>记录</h2><h3 id=\"Todo需求记录\"><a href=\"#Todo需求记录\" class=\"headerlink\" title=\"Todo需求记录\"></a>Todo需求记录</h3><ul>\n<li>jsp–&gt;&gt;html √</li>\n<li>spring-cloud √ spring-cloud-02(springboot2) √</li>\n<li>Vue √ Vue-02(组件化)</li>\n<li>Mysql锁机制-01 √ mysql-锁机制-02 事务隔离级别不同时锁的变化 </li>\n<li>NIO √ NIO-02</li>\n<li>NodeJs</li>\n<li>Dubbo</li>\n<li>Kafka</li>\n</ul>\n<h3 id=\"2019-12-25\"><a href=\"#2019-12-25\" class=\"headerlink\" title=\"2019-12-25\"></a>2019-12-25</h3><p>小秀同学2019-12-25分享“Vue-02组件化”</p>\n<p>确定小F同学2020-1-4分享“大文件对比”</p>\n<h3 id=\"2019-12-18\"><a href=\"#2019-12-18\" class=\"headerlink\" title=\"2019-12-18\"></a>2019-12-18</h3><p>小H同学2019-12-18分享”WebService服务调用”</p>\n<h3 id=\"2019-12-11\"><a href=\"#2019-12-11\" class=\"headerlink\" title=\"2019-12-11\"></a>2019-12-11</h3><p>小S同学12-11分享 “Mysql锁机制”</p>\n<p>小F同学提出需求“mysql-锁机制-02 事务隔离级别不同时锁的变化”</p>\n<p>确定小秀同学2019-12-25分享“Vue-02组件化”</p>\n<h3 id=\"2019-12-04\"><a href=\"#2019-12-04\" class=\"headerlink\" title=\"2019-12-04\"></a>2019-12-04</h3><p>小F同学12-04分享”spring-cloud-02(springboot2) skywalking简单使用”</p>\n<p>小H同学提出需求”Kafka”</p>\n<p>确认小H同学2019-12-18分享”WebService服务调用”</p>\n<h3 id=\"2019-11-27\"><a href=\"#2019-11-27\" class=\"headerlink\" title=\"2019-11-27\"></a>2019-11-27</h3><p>小生同学和小广同学11-27分享”NIO,Netty基础”</p>\n<p>小F同学提出需求 “NIO - 02”</p>\n<p>确认小S同学12-11分享 “Mysql锁机制”</p>\n<h3 id=\"2019-11-20\"><a href=\"#2019-11-20\" class=\"headerlink\" title=\"2019-11-20\"></a>2019-11-20</h3><p>小秀同学分享”vue项目创建过程”</p>\n<p>小F同学提出需求 “Vue-02(组件化)”</p>\n<p>小S同学提出需求 “Mysql锁机制”</p>\n<p>小广同学提出需求 “spring-cloud-02(springboot2)”</p>\n<p>确定小F同学12-04分享”spring-cloud-02(springboot2)”</p>\n<h3 id=\"2019-11-13\"><a href=\"#2019-11-13\" class=\"headerlink\" title=\"2019-11-13\"></a>2019-11-13</h3><p>小F同学分享”Spring-Cloud基础微服务快速搭建(springboot1)”</p>\n<p>确定小生同学和小广同学11-27分享”NIO,Netty基础”</p>\n<h3 id=\"2019-11-06\"><a href=\"#2019-11-06\" class=\"headerlink\" title=\"2019-11-06\"></a>2019-11-06</h3><p>小F同学分享”JSP转HTML，EL表达式替换方式”</p>\n<p>小J同学提出需求 “Spring-cloud基础应用”</p>\n<p>确定小秀同学11-20分享”vue方式实现基础表格页面”</p>\n<h3 id=\"2019-10-30\"><a href=\"#2019-10-30\" class=\"headerlink\" title=\"2019-10-30\"></a>2019-10-30</h3><p>小Q和小H同学分享”VoLTE告警派单整体流程”</p>\n<p>确定11-13小F同学分享”Spring-cloud基础应用”</p>\n<h3 id=\"2019-10-23\"><a href=\"#2019-10-23\" class=\"headerlink\" title=\"2019-10-23\"></a>2019-10-23</h3><p>确定11-6 由小F同学分享”jsp和html相关知识”</p>\n<p>小S同学分享”redis基础知识以及单节点/集群部署”</p>\n<p>小X同学提出需求 “想了解下jsp–&gt;&gt;html”</p>\n<p>小L同学提出需求 “想了解下NIO”</p>\n<p>小秀同学提出需求 “NodeJs”</p>\n<p>小S同学提出需求 “Dubbo”</p>\n<h3 id=\"2019-10-16\"><a href=\"#2019-10-16\" class=\"headerlink\" title=\"2019-10-16\"></a>2019-10-16</h3><p>讨论分享会执行方式</p>\n<p>确定10-23 由小S同学分享”redis基础知识以及单节点/集群部署”</p>\n<p>确定10-30 由小Q和小H同学分享”VoLTE告警派单整体流程”</p>\n<h3 id=\"2019-10-9\"><a href=\"#2019-10-9\" class=\"headerlink\" title=\"2019-10-9\"></a>2019-10-9</h3><p>确定每周三进行分享会</p>\n<h2 id=\"缘由\"><a href=\"#缘由\" class=\"headerlink\" title=\"缘由\"></a>缘由</h2><p>19年为了响应大家的学习渴求，公司成立了技术小组，让各个小组自行组织学习，北京学习小组应运而生。</p>\n<h2 id=\"目的\"><a href=\"#目的\" class=\"headerlink\" title=\"目的\"></a>目的</h2><p>创造公司个人双赢的局面，为公司留下更可靠的文档，为个人成为更好的自己。</p>\n<h2 id=\"具体实施\"><a href=\"#具体实施\" class=\"headerlink\" title=\"具体实施\"></a>具体实施</h2><p><strong>时间</strong></p>\n<p>6:00 去吃饭</p>\n<p>6:30 - 7:00 开始分享会</p>\n<p>结束时间 &lt;= 8:00</p>\n<p><strong>流程</strong></p>\n<p>讲师：每周1-2位同学讲自己总结的业务或技术问题。时间控制在1小时以内，分为40分钟讲解，10分钟答疑，10分钟提问</p>\n<p>学员：40分钟讲解过程中，记录自己的相关问题，在10分钟答疑环节尽量能简介的提问。</p>\n<p>奖励制度：//todo</p>\n<p>惩罚制度：//todo</p>\n"},{"title":"搭建自己的linux工作环境","date":"2019-09-30T10:07:02.000Z","_content":"\n## 缘由\n由于进公司之后长期使用win10操作系统，在win10操作系统不停强制更新之后，终于在2019年8月电脑开始频繁蓝屏，几乎每天一次！\n痛定思痛，决定放弃win10系统，采用win7作为主要操作系统，使用虚机的方式多系统联合作战。\n\n\n\nintel wifi linux驱动包\nhttps://www.intel.com/content/www/us/en/support/articles/000005511/network-and-io/wireless-networking.html\n\n升级内核\n1.自行下载内核，然后采用yum localinstall进行安装\n4.15内核\nhttp://mirror.host.ag/elrepo/kernel/el7/x86_64/RPMS/kernel-ml-4.15.14-1.el7.elrepo.x86_64.rpm\n\n2.联网后配置yum源进行安装\n导入key\nrpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\n安装yum源\nrpm -Uvh http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm\n查看系统可以使用的内核\nsudo awk -F\\' '$1==\"menuentry \" {print i++ \" : \" $2}' /etc/grub2.cfg\n\n\n删除不必要的内核\nyum remove kernel-3.10.0-327.el7.x86_64\n\n\noffice常用办公软件\nyum install libreoffice\n\ncentos7.1没有wifi-GUI GUI联网得用wap_suplication\n\n切换到centos7.6\n\n安装vmware player\n\n............ 经过了断断续续，三天打鱼两天晒网的摸索，还是决定平时出门所用笔记本仍然采用windows，不过可以保留一台centos作为虚机和centos操作训练使用。主要有以下几点特别影响使用，以后如果能够解决再进行一试：\n\n1.vmware没有找到centos中运行的破解版，买不起正版- -||\n\n2.翻墙梯子在centos下，采用privoxy+ssl的形式使用后，还需要在chrome里下载代理插件设置代理才能够访问，不方便。另外采用privoxy之后yum源也被设定为通过privoxy访问，很依赖梯子的稳定访问，而我采用的vultr的vps地址经常会被GFW给禁掉。\n\n3.图片处理，centos上并没有一款非常好用的图片处理软件，仍然是需要搭建C的环境来处理。\n\n4.社交工具，原来windows上使用微信、钉钉、QQ、邮箱。没有在centos上找到好用的对应方案。","source":"_posts/搭建自己的linux工作环境.md","raw":"---\ntitle: 搭建自己的linux工作环境\ndate: 2019-09-30 18:07:02\ncategories:\n- 工具\ntags:\n- linux\n- 工作环境\n\n---\n\n## 缘由\n由于进公司之后长期使用win10操作系统，在win10操作系统不停强制更新之后，终于在2019年8月电脑开始频繁蓝屏，几乎每天一次！\n痛定思痛，决定放弃win10系统，采用win7作为主要操作系统，使用虚机的方式多系统联合作战。\n\n\n\nintel wifi linux驱动包\nhttps://www.intel.com/content/www/us/en/support/articles/000005511/network-and-io/wireless-networking.html\n\n升级内核\n1.自行下载内核，然后采用yum localinstall进行安装\n4.15内核\nhttp://mirror.host.ag/elrepo/kernel/el7/x86_64/RPMS/kernel-ml-4.15.14-1.el7.elrepo.x86_64.rpm\n\n2.联网后配置yum源进行安装\n导入key\nrpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\n安装yum源\nrpm -Uvh http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm\n查看系统可以使用的内核\nsudo awk -F\\' '$1==\"menuentry \" {print i++ \" : \" $2}' /etc/grub2.cfg\n\n\n删除不必要的内核\nyum remove kernel-3.10.0-327.el7.x86_64\n\n\noffice常用办公软件\nyum install libreoffice\n\ncentos7.1没有wifi-GUI GUI联网得用wap_suplication\n\n切换到centos7.6\n\n安装vmware player\n\n............ 经过了断断续续，三天打鱼两天晒网的摸索，还是决定平时出门所用笔记本仍然采用windows，不过可以保留一台centos作为虚机和centos操作训练使用。主要有以下几点特别影响使用，以后如果能够解决再进行一试：\n\n1.vmware没有找到centos中运行的破解版，买不起正版- -||\n\n2.翻墙梯子在centos下，采用privoxy+ssl的形式使用后，还需要在chrome里下载代理插件设置代理才能够访问，不方便。另外采用privoxy之后yum源也被设定为通过privoxy访问，很依赖梯子的稳定访问，而我采用的vultr的vps地址经常会被GFW给禁掉。\n\n3.图片处理，centos上并没有一款非常好用的图片处理软件，仍然是需要搭建C的环境来处理。\n\n4.社交工具，原来windows上使用微信、钉钉、QQ、邮箱。没有在centos上找到好用的对应方案。","slug":"搭建自己的linux工作环境","published":1,"updated":"2020-02-10T07:35:40.270Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55gk000yogvkuj1bif1j","content":"<h2 id=\"缘由\"><a href=\"#缘由\" class=\"headerlink\" title=\"缘由\"></a>缘由</h2><p>由于进公司之后长期使用win10操作系统，在win10操作系统不停强制更新之后，终于在2019年8月电脑开始频繁蓝屏，几乎每天一次！<br>痛定思痛，决定放弃win10系统，采用win7作为主要操作系统，使用虚机的方式多系统联合作战。</p>\n<p>intel wifi linux驱动包<br><a href=\"https://www.intel.com/content/www/us/en/support/articles/000005511/network-and-io/wireless-networking.html\" target=\"_blank\" rel=\"noopener\">https://www.intel.com/content/www/us/en/support/articles/000005511/network-and-io/wireless-networking.html</a></p>\n<p>升级内核<br>1.自行下载内核，然后采用yum localinstall进行安装<br>4.15内核<br><a href=\"http://mirror.host.ag/elrepo/kernel/el7/x86_64/RPMS/kernel-ml-4.15.14-1.el7.elrepo.x86_64.rpm\" target=\"_blank\" rel=\"noopener\">http://mirror.host.ag/elrepo/kernel/el7/x86_64/RPMS/kernel-ml-4.15.14-1.el7.elrepo.x86_64.rpm</a></p>\n<p>2.联网后配置yum源进行安装<br>导入key<br>rpm –import <a href=\"https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\" target=\"_blank\" rel=\"noopener\">https://www.elrepo.org/RPM-GPG-KEY-elrepo.org</a><br>安装yum源<br>rpm -Uvh <a href=\"http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm\" target=\"_blank\" rel=\"noopener\">http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm</a><br>查看系统可以使用的内核<br>sudo awk -F&#39; ‘$1==”menuentry “ {print i++ “ : “ $2}’ /etc/grub2.cfg</p>\n<p>删除不必要的内核<br>yum remove kernel-3.10.0-327.el7.x86_64</p>\n<p>office常用办公软件<br>yum install libreoffice</p>\n<p>centos7.1没有wifi-GUI GUI联网得用wap_suplication</p>\n<p>切换到centos7.6</p>\n<p>安装vmware player</p>\n<p>………… 经过了断断续续，三天打鱼两天晒网的摸索，还是决定平时出门所用笔记本仍然采用windows，不过可以保留一台centos作为虚机和centos操作训练使用。主要有以下几点特别影响使用，以后如果能够解决再进行一试：</p>\n<p>1.vmware没有找到centos中运行的破解版，买不起正版- -||</p>\n<p>2.翻墙梯子在centos下，采用privoxy+ssl的形式使用后，还需要在chrome里下载代理插件设置代理才能够访问，不方便。另外采用privoxy之后yum源也被设定为通过privoxy访问，很依赖梯子的稳定访问，而我采用的vultr的vps地址经常会被GFW给禁掉。</p>\n<p>3.图片处理，centos上并没有一款非常好用的图片处理软件，仍然是需要搭建C的环境来处理。</p>\n<p>4.社交工具，原来windows上使用微信、钉钉、QQ、邮箱。没有在centos上找到好用的对应方案。</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"缘由\"><a href=\"#缘由\" class=\"headerlink\" title=\"缘由\"></a>缘由</h2><p>由于进公司之后长期使用win10操作系统，在win10操作系统不停强制更新之后，终于在2019年8月电脑开始频繁蓝屏，几乎每天一次！<br>痛定思痛，决定放弃win10系统，采用win7作为主要操作系统，使用虚机的方式多系统联合作战。</p>\n<p>intel wifi linux驱动包<br><a href=\"https://www.intel.com/content/www/us/en/support/articles/000005511/network-and-io/wireless-networking.html\" target=\"_blank\" rel=\"noopener\">https://www.intel.com/content/www/us/en/support/articles/000005511/network-and-io/wireless-networking.html</a></p>\n<p>升级内核<br>1.自行下载内核，然后采用yum localinstall进行安装<br>4.15内核<br><a href=\"http://mirror.host.ag/elrepo/kernel/el7/x86_64/RPMS/kernel-ml-4.15.14-1.el7.elrepo.x86_64.rpm\" target=\"_blank\" rel=\"noopener\">http://mirror.host.ag/elrepo/kernel/el7/x86_64/RPMS/kernel-ml-4.15.14-1.el7.elrepo.x86_64.rpm</a></p>\n<p>2.联网后配置yum源进行安装<br>导入key<br>rpm –import <a href=\"https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\" target=\"_blank\" rel=\"noopener\">https://www.elrepo.org/RPM-GPG-KEY-elrepo.org</a><br>安装yum源<br>rpm -Uvh <a href=\"http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm\" target=\"_blank\" rel=\"noopener\">http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm</a><br>查看系统可以使用的内核<br>sudo awk -F&#39; ‘$1==”menuentry “ {print i++ “ : “ $2}’ /etc/grub2.cfg</p>\n<p>删除不必要的内核<br>yum remove kernel-3.10.0-327.el7.x86_64</p>\n<p>office常用办公软件<br>yum install libreoffice</p>\n<p>centos7.1没有wifi-GUI GUI联网得用wap_suplication</p>\n<p>切换到centos7.6</p>\n<p>安装vmware player</p>\n<p>………… 经过了断断续续，三天打鱼两天晒网的摸索，还是决定平时出门所用笔记本仍然采用windows，不过可以保留一台centos作为虚机和centos操作训练使用。主要有以下几点特别影响使用，以后如果能够解决再进行一试：</p>\n<p>1.vmware没有找到centos中运行的破解版，买不起正版- -||</p>\n<p>2.翻墙梯子在centos下，采用privoxy+ssl的形式使用后，还需要在chrome里下载代理插件设置代理才能够访问，不方便。另外采用privoxy之后yum源也被设定为通过privoxy访问，很依赖梯子的稳定访问，而我采用的vultr的vps地址经常会被GFW给禁掉。</p>\n<p>3.图片处理，centos上并没有一款非常好用的图片处理软件，仍然是需要搭建C的环境来处理。</p>\n<p>4.社交工具，原来windows上使用微信、钉钉、QQ、邮箱。没有在centos上找到好用的对应方案。</p>\n"},{"title":"面试记录汇总","date":"2020-02-10T08:32:40.000Z","_content":"\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n* [4.为什么采用以上方式](#4-为什么采用以上方式)\n\n## 1.缘由\n\n之前工作时没做任何准备，裸面阿里被虐惨，为了防止再次被虐的体无完肤，开始全面复习\n\n## 2.目的\n\n加强基础细节把控，明确多种技术的常见应用场景\n\n## 3.具体实施\n\n\n\n//todo\nAOP底层具体实现\nSpring注入讲的重点不突出（启动时注入，动态注入）\n100E的字典匹配--布隆过滤器，优缺点，具体实现\n缓存击穿\n问java版本，聊到jdk8新特性，聊到新特性与之前的区别。\n\n### 3.1事前准备\n\n\n\n### 3.2实施并验证\n\n\n\n## 4.为什么采用以上方式\n\n\n\n","source":"_posts/面试记录.md","raw":"---\ntitle: 面试记录汇总\ncategories:\n  - 面试\ntags:\n  - 面试\ndate: 2020-02-10 16:32:40\n---\n\n### 目录\n* [1.缘由](#1-缘由)\n* [2.目的](#2-目的)\n* [3.具体实施](#3-具体实施)\n    * [3.1 事前准备](#3-1事前准备)\n    * [3.2 实施并验证](#3-2实施并验证)\n* [4.为什么采用以上方式](#4-为什么采用以上方式)\n\n## 1.缘由\n\n之前工作时没做任何准备，裸面阿里被虐惨，为了防止再次被虐的体无完肤，开始全面复习\n\n## 2.目的\n\n加强基础细节把控，明确多种技术的常见应用场景\n\n## 3.具体实施\n\n\n\n//todo\nAOP底层具体实现\nSpring注入讲的重点不突出（启动时注入，动态注入）\n100E的字典匹配--布隆过滤器，优缺点，具体实现\n缓存击穿\n问java版本，聊到jdk8新特性，聊到新特性与之前的区别。\n\n### 3.1事前准备\n\n\n\n### 3.2实施并验证\n\n\n\n## 4.为什么采用以上方式\n\n\n\n","slug":"面试记录","published":1,"updated":"2020-02-10T08:42:25.649Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck6jh55gl0012ogvkvb53kb9y","content":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a></li>\n</ul>\n</li>\n<li><a href=\"#4-为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>之前工作时没做任何准备，裸面阿里被虐惨，为了防止再次被虐的体无完肤，开始全面复习</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>加强基础细节把控，明确多种技术的常见应用场景</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><p>//todo<br>AOP底层具体实现<br>Spring注入讲的重点不突出（启动时注入，动态注入）<br>100E的字典匹配–布隆过滤器，优缺点，具体实现<br>缓存击穿<br>问java版本，聊到jdk8新特性，聊到新特性与之前的区别。</p>\n<h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><h3 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h3><h2 id=\"4-为什么采用以上方式\"><a href=\"#4-为什么采用以上方式\" class=\"headerlink\" title=\"4.为什么采用以上方式\"></a>4.为什么采用以上方式</h2>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h3><ul>\n<li><a href=\"#1-缘由\">1.缘由</a></li>\n<li><a href=\"#2-目的\">2.目的</a></li>\n<li><a href=\"#3-具体实施\">3.具体实施</a><ul>\n<li><a href=\"#3-1事前准备\">3.1 事前准备</a></li>\n<li><a href=\"#3-2实施并验证\">3.2 实施并验证</a></li>\n</ul>\n</li>\n<li><a href=\"#4-为什么采用以上方式\">4.为什么采用以上方式</a></li>\n</ul>\n<h2 id=\"1-缘由\"><a href=\"#1-缘由\" class=\"headerlink\" title=\"1.缘由\"></a>1.缘由</h2><p>之前工作时没做任何准备，裸面阿里被虐惨，为了防止再次被虐的体无完肤，开始全面复习</p>\n<h2 id=\"2-目的\"><a href=\"#2-目的\" class=\"headerlink\" title=\"2.目的\"></a>2.目的</h2><p>加强基础细节把控，明确多种技术的常见应用场景</p>\n<h2 id=\"3-具体实施\"><a href=\"#3-具体实施\" class=\"headerlink\" title=\"3.具体实施\"></a>3.具体实施</h2><p>//todo<br>AOP底层具体实现<br>Spring注入讲的重点不突出（启动时注入，动态注入）<br>100E的字典匹配–布隆过滤器，优缺点，具体实现<br>缓存击穿<br>问java版本，聊到jdk8新特性，聊到新特性与之前的区别。</p>\n<h3 id=\"3-1事前准备\"><a href=\"#3-1事前准备\" class=\"headerlink\" title=\"3.1事前准备\"></a>3.1事前准备</h3><h3 id=\"3-2实施并验证\"><a href=\"#3-2实施并验证\" class=\"headerlink\" title=\"3.2实施并验证\"></a>3.2实施并验证</h3><h2 id=\"4-为什么采用以上方式\"><a href=\"#4-为什么采用以上方式\" class=\"headerlink\" title=\"4.为什么采用以上方式\"></a>4.为什么采用以上方式</h2>"}],"PostAsset":[],"PostCategory":[{"post_id":"ck6jh55fv0000ogvkchefzxnp","category_id":"ck6jh55g00003ogvklnzvk2kx","_id":"ck6jh55g7000cogvkkgxugy56"},{"post_id":"ck6jh55fz0002ogvkt3znglcy","category_id":"ck6jh55g50008ogvkhj4ne7t9","_id":"ck6jh55gd000jogvkfo0zpc60"},{"post_id":"ck6jh55g8000fogvkq11veh2l","category_id":"ck6jh55g8000dogvkg0s7q1xn","_id":"ck6jh55gg000pogvkza4hjnu2"},{"post_id":"ck6jh55g20005ogvkcef64tg3","category_id":"ck6jh55g8000dogvkg0s7q1xn","_id":"ck6jh55gi000togvkk59x3lb5"},{"post_id":"ck6jh55ga000hogvkxho7edqv","category_id":"ck6jh55g50008ogvkhj4ne7t9","_id":"ck6jh55gj000wogvk1uw7c7ih"},{"post_id":"ck6jh55g30006ogvk04pvl4oo","category_id":"ck6jh55g8000dogvkg0s7q1xn","_id":"ck6jh55gk000zogvkj6o56mxx"},{"post_id":"ck6jh55g40007ogvkfks5q4bb","category_id":"ck6jh55gh000qogvkcw09697g","_id":"ck6jh55gm0014ogvkj6qvqs58"},{"post_id":"ck6jh55g5000aogvkncfc1dda","category_id":"ck6jh55g8000dogvkg0s7q1xn","_id":"ck6jh55gn0018ogvkgafwth4r"},{"post_id":"ck6jh55g6000bogvkk5yneh37","category_id":"ck6jh55g8000dogvkg0s7q1xn","_id":"ck6jh55go001aogvku6jwg3bu"},{"post_id":"ck6jh55ge000mogvktzwm36r8","category_id":"ck6jh55gn0017ogvkatcmnrbv","_id":"ck6jh55gp001dogvk1ue94ue9"},{"post_id":"ck6jh55gg000oogvkfm9ud0m6","category_id":"ck6jh55go001bogvkz69dpujy","_id":"ck6jh55gq001hogvk1mu9hxzo"},{"post_id":"ck6jh55gh000sogvkpiom5mh3","category_id":"ck6jh55gp001eogvkixl4ghhq","_id":"ck6jh55gr001mogvkbvrwyw1f"},{"post_id":"ck6jh55gi000vogvkurcuqnxa","category_id":"ck6jh55gq001iogvkxy17k2x1","_id":"ck6jh55gs001qogvk9nmlb4rf"},{"post_id":"ck6jh55gk000yogvkuj1bif1j","category_id":"ck6jh55gp001eogvkixl4ghhq","_id":"ck6jh55gt001togvktre0bvsu"},{"post_id":"ck6jh55gl0012ogvkvb53kb9y","category_id":"ck6jh55gs001pogvkm3e6cxsd","_id":"ck6jh55gt001xogvked3ii9qa"}],"PostTag":[{"post_id":"ck6jh55fv0000ogvkchefzxnp","tag_id":"ck6jh55g10004ogvkdw64ifc5","_id":"ck6jh55g9000gogvkfqjgzozd"},{"post_id":"ck6jh55fv0000ogvkchefzxnp","tag_id":"ck6jh55g50009ogvklsxctz48","_id":"ck6jh55gc000iogvk9d6mb2hk"},{"post_id":"ck6jh55fz0002ogvkt3znglcy","tag_id":"ck6jh55g8000eogvkukb3w37l","_id":"ck6jh55gf000nogvkjy72mgf1"},{"post_id":"ck6jh55g20005ogvkcef64tg3","tag_id":"ck6jh55gd000logvk0pyguwty","_id":"ck6jh55gi000uogvk5yaa39z5"},{"post_id":"ck6jh55g30006ogvk04pvl4oo","tag_id":"ck6jh55gh000rogvk2ldpqage","_id":"ck6jh55gl0011ogvkd08u45vl"},{"post_id":"ck6jh55g40007ogvkfks5q4bb","tag_id":"ck6jh55gl0010ogvkjptaz3c1","_id":"ck6jh55gn0016ogvk8r5q9spw"},{"post_id":"ck6jh55g5000aogvkncfc1dda","tag_id":"ck6jh55gn0015ogvk6ccqlrxj","_id":"ck6jh55gp001gogvk1qeu7a54"},{"post_id":"ck6jh55g5000aogvkncfc1dda","tag_id":"ck6jh55go0019ogvknt2s90yq","_id":"ck6jh55gq001jogvk9yasdh2y"},{"post_id":"ck6jh55g5000aogvkncfc1dda","tag_id":"ck6jh55go001cogvkp54kfkk6","_id":"ck6jh55gr001logvkirgnjx17"},{"post_id":"ck6jh55g6000bogvkk5yneh37","tag_id":"ck6jh55gn0015ogvk6ccqlrxj","_id":"ck6jh55gt001sogvk1mf211m4"},{"post_id":"ck6jh55g6000bogvkk5yneh37","tag_id":"ck6jh55go0019ogvknt2s90yq","_id":"ck6jh55gt001uogvk4o907wki"},{"post_id":"ck6jh55g6000bogvkk5yneh37","tag_id":"ck6jh55go001cogvkp54kfkk6","_id":"ck6jh55gt001wogvkigg1214x"},{"post_id":"ck6jh55g8000fogvkq11veh2l","tag_id":"ck6jh55gs001rogvkwhrmrln6","_id":"ck6jh55gu0020ogvk61a2iyua"},{"post_id":"ck6jh55g8000fogvkq11veh2l","tag_id":"ck6jh55gt001vogvkr11elsbr","_id":"ck6jh55gu0021ogvknkyvideq"},{"post_id":"ck6jh55g8000fogvkq11veh2l","tag_id":"ck6jh55gu001yogvk7jmklv72","_id":"ck6jh55gv0023ogvkyiclqujz"},{"post_id":"ck6jh55ga000hogvkxho7edqv","tag_id":"ck6jh55gu001zogvkhlwnu5ij","_id":"ck6jh55gv0025ogvkcdyc8hsw"},{"post_id":"ck6jh55ga000hogvkxho7edqv","tag_id":"ck6jh55gu0022ogvkp4qsat11","_id":"ck6jh55gv0026ogvkn4ayhy9w"},{"post_id":"ck6jh55ge000mogvktzwm36r8","tag_id":"ck6jh55gv0024ogvkcf56vigc","_id":"ck6jh55gw0028ogvku8588ano"},{"post_id":"ck6jh55gg000oogvkfm9ud0m6","tag_id":"ck6jh55gv0027ogvky2nacu4a","_id":"ck6jh55gw002aogvk4g3833d5"},{"post_id":"ck6jh55gh000sogvkpiom5mh3","tag_id":"ck6jh55gw0029ogvkdaoyzku5","_id":"ck6jh55gy002gogvkv3kml89s"},{"post_id":"ck6jh55gh000sogvkpiom5mh3","tag_id":"ck6jh55gw002bogvkwbk64tpi","_id":"ck6jh55gy002hogvkp8qkg3c9"},{"post_id":"ck6jh55gh000sogvkpiom5mh3","tag_id":"ck6jh55gx002cogvksrz2cffi","_id":"ck6jh55gy002jogvk2eth13s5"},{"post_id":"ck6jh55gh000sogvkpiom5mh3","tag_id":"ck6jh55gx002dogvkv5b3pr3i","_id":"ck6jh55gz002kogvk0bfgyp8m"},{"post_id":"ck6jh55gh000sogvkpiom5mh3","tag_id":"ck6jh55gx002eogvkilhqb3zd","_id":"ck6jh55gz002mogvkw0if0jec"},{"post_id":"ck6jh55gi000vogvkurcuqnxa","tag_id":"ck6jh55gx002fogvkhbbk9yry","_id":"ck6jh55gz002nogvk1fykwh6r"},{"post_id":"ck6jh55gk000yogvkuj1bif1j","tag_id":"ck6jh55gy002iogvkik587w8v","_id":"ck6jh55h0002pogvkrotto0kd"},{"post_id":"ck6jh55gk000yogvkuj1bif1j","tag_id":"ck6jh55gz002logvkm2dq1cos","_id":"ck6jh55h0002qogvkj4p974fk"},{"post_id":"ck6jh55gl0012ogvkvb53kb9y","tag_id":"ck6jh55gz002oogvkb3p2u9t6","_id":"ck6jh55h0002rogvkmpyx2hgh"}],"Tag":[{"name":"JSP","_id":"ck6jh55g10004ogvkdw64ifc5"},{"name":"EL表达式","_id":"ck6jh55g50009ogvklsxctz48"},{"name":"配置","_id":"ck6jh55g8000eogvkukb3w37l"},{"name":"内存区域","_id":"ck6jh55gd000logvk0pyguwty"},{"name":"内存模型","_id":"ck6jh55gh000rogvk2ldpqage"},{"name":"Shell","_id":"ck6jh55gl0010ogvkjptaz3c1"},{"name":"spring-cloud","_id":"ck6jh55gn0015ogvk6ccqlrxj"},{"name":"微服务","_id":"ck6jh55go0019ogvknt2s90yq"},{"name":"框架搭建","_id":"ck6jh55go001cogvkp54kfkk6"},{"name":"CompletableFuture","_id":"ck6jh55gs001rogvkwhrmrln6"},{"name":"jdk8","_id":"ck6jh55gt001vogvkr11elsbr"},{"name":"并发编程","_id":"ck6jh55gu001yogvk7jmklv72"},{"name":"Mysql","_id":"ck6jh55gu001zogvkhlwnu5ij"},{"name":"死锁","_id":"ck6jh55gu0022ogvkp4qsat11"},{"name":"学习记录","_id":"ck6jh55gv0024ogvkcf56vigc"},{"name":"番茄钟","_id":"ck6jh55gv0027ogvky2nacu4a"},{"name":"Linux","_id":"ck6jh55gw0029ogvkdaoyzku5"},{"name":"Tar","_id":"ck6jh55gw002bogvkwbk64tpi"},{"name":"压缩解压缩","_id":"ck6jh55gx002cogvksrz2cffi"},{"name":"加密解密","_id":"ck6jh55gx002dogvkv5b3pr3i"},{"name":"大文本","_id":"ck6jh55gx002eogvkilhqb3zd"},{"name":"sendi","_id":"ck6jh55gx002fogvkhbbk9yry"},{"name":"linux","_id":"ck6jh55gy002iogvkik587w8v"},{"name":"工作环境","_id":"ck6jh55gz002logvkm2dq1cos"},{"name":"面试","_id":"ck6jh55gz002oogvkb3p2u9t6"}]}}